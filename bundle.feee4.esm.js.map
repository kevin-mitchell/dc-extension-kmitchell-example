{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../src/lib/extensions/Extension.ts","webpack:///../src/lib/extensions/ExtensionFactory.ts","webpack:///../src/lib/extensions/content-field/ContentFieldContextObject.ts","webpack:///../src/lib/extensions/dashboard/DashboardContextObject.ts","webpack:///../src/lib/init.ts","webpack:///../node_modules/message-event-channel/node_modules/url-polyfill/url-polyfill.js","webpack:///../node_modules/message-event-channel/src/Connection.ts","webpack:///../node_modules/message-event-channel/src/ServerConnection.ts","webpack:///../node_modules/message-event-channel/src/ClientConnection.ts","webpack:///../src/lib/constants/Errors.ts","webpack:///../src/lib/constants/Events.ts","webpack:///../src/lib/components/HttpClient.ts","webpack:///../src/lib/constants/LocationHref.ts","webpack:///../src/lib/components/Users.ts","webpack:///../src/lib/constants/Users.ts","webpack:///../src/lib/components/ContentItem.ts","webpack:///../src/lib/components/ContentLink.ts","webpack:///../src/lib/components/ContentReference.ts","webpack:///../src/lib/components/Field.ts","webpack:///../src/lib/components/Form.ts","webpack:///../src/lib/components/Frame.ts","webpack:///../src/lib/components/MediaLink.ts","webpack:///../src/lib/extensions/content-field/ContentFieldExtension.ts","webpack:///../src/lib/components/ApplicationNavigator.ts","webpack:///../src/lib/extensions/dashboard/DashboardExtension.ts","webpack:///../node_modules/reflect-metadata/Reflect.js","webpack:///../src/util.js","webpack:///../src/create-element.js","webpack:///../src/component.js","webpack:///../src/diff/children.js","webpack:///../src/diff/props.js","webpack:///../src/diff/index.js","webpack:///../src/render.js","webpack:///../src/clone-element.js","webpack:///../src/create-context.js","webpack:///../src/constants.js","webpack:///../src/options.js","webpack:///../src/diff/catch-error.js","webpack:///../node_modules/preact-cli/lib/lib/entry.js","webpack:///../node_modules/webpack/buildin/global.js","webpack:///../node_modules/inversify/es/utils/id.js","webpack:///../node_modules/inversify/es/utils/exceptions.js","webpack:///../node_modules/inversify/es/constants/error_msgs.js","webpack:///../node_modules/inversify/es/utils/serialization.js","webpack:///../node_modules/inversify/es/planning/reflection_utils.js","webpack:///../node_modules/inversify/es/planning/planner.js","webpack:///../node_modules/inversify/es/resolution/instantiation.js","webpack:///../node_modules/inversify/es/resolution/resolver.js","webpack:///../node_modules/inversify-inject-decorators/es/decorators.js","webpack:///../node_modules/inversify/es/constants/metadata_keys.js","webpack:///../node_modules/inversify/es/constants/literal_types.js","webpack:///../node_modules/inversify/es/bindings/binding.js","webpack:///../node_modules/inversify/es/planning/metadata_reader.js","webpack:///../node_modules/inversify/es/bindings/binding_count.js","webpack:///../node_modules/inversify/es/planning/context.js","webpack:///../node_modules/inversify/es/planning/metadata.js","webpack:///../node_modules/inversify/es/planning/plan.js","webpack:///../node_modules/inversify/es/annotation/inject.js","webpack:///../node_modules/inversify/es/planning/queryable_string.js","webpack:///../node_modules/inversify/es/planning/target.js","webpack:///../node_modules/inversify/es/planning/request.js","webpack:///../node_modules/inversify/es/syntax/constraint_helpers.js","webpack:///../node_modules/inversify/es/syntax/binding_when_syntax.js","webpack:///../node_modules/inversify/es/syntax/binding_on_syntax.js","webpack:///../node_modules/inversify/es/syntax/binding_when_on_syntax.js","webpack:///../node_modules/inversify/es/syntax/binding_in_syntax.js","webpack:///../node_modules/inversify/es/syntax/binding_in_when_on_syntax.js","webpack:///../node_modules/inversify/es/syntax/binding_to_syntax.js","webpack:///../node_modules/inversify/es/container/container_snapshot.js","webpack:///../node_modules/inversify/es/container/lookup.js","webpack:///../node_modules/inversify/es/container/container.js","webpack:///../node_modules/inversify-inject-decorators/es/index.js","webpack:///./data/storage.service.ts","webpack:///../node_modules/inversify/es/annotation/injectable.js","webpack:///./di/services.container.ts","webpack:///./components/app.tsx","webpack:///./index.ts"],"names":["__webpack_require__","moduleId","installedModules","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","isContextObject","context","undefined","params","installation","extensionFactory","options","extension","category","instance","contentItemId","fieldSchema","locales","readOnly","stagingEnvironment","visualisation","isContentFieldContextObject","ContentFieldExtension","setupContext","hubId","locationHref","isDashboardContextObject","DashboardExtension","Error","EXTENSION","UNSUPPORTED_EXTENSION","init","mergedOptions","defaultOptions","connection","ClientConnection","Promise","resolve","reject","on","MC_EVENTS","CONNECTED","request","CONTEXT","GET","timeout","ERRORS_INIT","e","CONNECTION_TIMEOUT","global","iteratorSupported","iterator","error","checkIfIteratorIsSupported","createIterator","items","next","shift","done","serializeParam","encodeURIComponent","replace","deserializeParam","decodeURIComponent","String","URLSearchParams","toString","set","checkIfURLSearchParamsSupported","searchString","this","writable","typeofSearchString","_fromString","_this","forEach","append","TypeError","length","entry","proto","_entries","push","delete","getAll","slice","has","callback","thisArg","entries","keys","values","searchArray","join","polyfillURLSearchParams","sort","a","b","configurable","attribute","attributes","split","window","self","u","URL","pathname","href","searchParams","checkIfURLIsSupported","_URL","url","base","baseElement","doc","document","location","implementation","createHTMLDocument","createElement","head","appendChild","indexOf","err","anchorElement","body","protocol","test","search","enableSearchUpdate","enableSearchParamsUpdate","methodName","method","apply","arguments","attributeName","_anchorElement","linkURLWithAnchorAttribute","_updateSearchParams","defineProperties","hostname","port","createObjectURL","blob","revokeObjectURL","polyfillURL","getOrigin","setInterval","origin","MESSAGE_TYPE","CONNECTION_STEPS","connected","backlog","promises","emitters","connectionStep","connectionTimeout","debug","onload","clientInitiates","targetOrigin","emit","event","payload","message","type","EMIT","Array","isArray","ct","uuid","uuidv4","getRequestTimeout","setTimeout","resolvedData","clearTimeout","REQUEST","id","close","messageListener","removeEventListener","setConnectionTimeout","handleMessage","Number","crypt","crypto","msCrypto","getRandomValues","Uint8Array","clearConnectionTimeout","initPortEvents","onmessage","data","onmessageerror","handleError","finishInit","console","log","isClient","completeBacklog","portMessage","cb","RESOLVE","REJECT","force","HANDSHAKE","DISCONNECTED","postMessage","frame","CONNECTION","setupLoadInit","setupClientInit","clientInitiation","IFRAME_LOADING","addEventListener","INITIATION_FROM_CLIENT","src","contentWindow","setupChannel","listenForHandshake","sendPortToClient","client","channel","port2","MessageChannel","port1","Connection","ERRORS_CONTENT_ITEM","ERRORS_FRAME","FORM","APPLICATION_NAVIGATOR","CONTENT_ITEM","MEDIA_LINK","CONTENT_LINK","CONTENT_REFERENCE","FIELD","FRAME","HttpMethod","messageHandler","parent","ports","then","addBeforeUnloadEvent","catch","LOCATION_HREF","DEFAULT_ERROR","status","errors","code","level","config","headers","response","HttpClient","list","map","user","transformUser","authUser","firstName","lastName","email","users","Users","getCurrent","getMultiple","contentTypeIds","max","fetchLinks","NO_IDS","CONTENT_GET","fetchReferences","CONTENT_REF_GET","schema","getValue","MODEL_GET","setValue","MODEL_SET","isValid","MODEL_IS_VALID","validate","MODEL_VALIDATE","reset","MODEL_RESET","onChangeStack","READ_ONLY","readonly","onReadOnlyChange","GET_FORM_MODEL","ERRORS","NO_MODEL","win","isAutoResizing","observer","MutationObserver","updateHeight","frameLoaded","readyState","HEIGHT_GET","_payload","getHeight","updateHeightHandler","documentElement","getBoundingClientRect","setHeight","height","SET_HEIGHT_NUMBER","h","previousHeight","HEIGHT_SET","startAutoResizer","observe","childList","subtree","characterData","stopAutoResizer","disconnect","getImage","IMAGE_GET","getImages","getVideo","VIDEO_GET","getVideos","mediaLink","MediaLink","contentLink","ContentLink","contentReference","ContentReference","Frame","contentItem","ContentItem","field","Field","form","Form","Extension","openEventsCalendar","processHref","getBaseHref","openEventsTimeline","openEventsList","openEvent","openEdition","edition","eventId","openContentLibrary","openContentItem","returnHref","HASH_BANG","MUST_INCLUDE_HASH_BANG","baseUrl","hubName","applicationNavigator","ApplicationNavigator","Reflect","makeExporter","target","previous","root","Function","exporter","GetOrCreateMetadataMap","O","P","Create","targetMetadata","Metadata","IsUndefined","_Map","metadataMap","OrdinaryHasOwnMetadata","MetadataKey","OrdinaryGetOwnMetadata","OrdinaryDefineOwnMetadata","MetadataValue","OrdinaryOwnMetadataKeys","obj","GetMethod","iteratorSymbol","IsCallable","IsObject","GetIterator","k","IteratorStep","nextValue","IteratorClose","Type","x","IsNull","ToPrimitive","input","PreferredType","hint","exoticToPrim","toPrimitiveSymbol","result","toString_1","valueOf","toString_2","OrdinaryToPrimitive","ToPropertyKey","argument","ToString","IsArray","IsConstructor","V","func","f","OrdinaryGetPrototypeOf","getPrototypeOf","functionPrototype","prototypeProto","constructor","MakeDictionary","__","hasOwn","supportsSymbol","toPrimitive","supportsCreate","supportsProto","__proto__","downLevel","HashMap","usePolyfill","process","env","Map","getKey","_","getEntry","cacheSentinel","arraySentinel","MapIterator","selector","_index","_keys","_values","_selector","index","throw","return","_cacheKey","_cacheIndex","_find","size","clear","insert","CreateMapPolyfill","_Set","Set","_map","add","WeakMap","CreateUniqueKey","CreateUUID","GetOrCreateWeakMapTable","rootKey","FillRandomBytes","buffer","Math","random","offset","byte","toLowerCase","_key","table","CreateWeakMapPolyfill","decorators","propertyKey","decorated","decorator","DecorateConstructor","descriptor","DecorateProperty","metadataKey","metadataValue","IsPropertyKey","OrdinaryHasMetadata","OrdinaryGetMetadata","OrdinaryMetadataKeys","ownKeys","parentKeys","_i","ownKeys_1","_a","parentKeys_1","factory","assign","props","removeNode","node","parentNode","removeChild","children","ref","normalizedProps","defaultProps","createVNode","original","vnode","createRef","current","Fragment","Component","getDomSibling","childIndex","sibling","updateParentDomPointers","child","enqueueRender","rerenderQueue","prevDebounce","debounceRendering","defer","queue","some","component","commitQueue","oldVNode","oldDom","parentDom","diff","ownerSVGElement","commitRoot","diffChildren","renderResult","newParentVNode","oldParentVNode","globalContext","isSvg","excessDomChildren","isHydrating","j","childVNode","newDom","firstChildDom","refs","oldChildren","EMPTY_ARR","oldChildrenLength","EMPTY_OBJ","reorderChildren","placeChild","unmount","applyRef","tmp","toChildArray","out","nextDom","sibDom","outer","nextSibling","insertBefore","setStyle","style","setProperty","IS_NON_DIMENSIONAL","dom","oldValue","useCapture","cssText","_listeners","eventProxyCapture","eventProxy","setAttribute","removeAttribute","newVNode","isNew","oldProps","oldState","snapshot","clearProcessingException","newProps","provider","componentContext","newType","contextType","render","doRender","sub","state","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","getChildContext","getSnapshotBeforeUpdate","diffElementNodes","diffed","oldHtml","newHtml","nodeType","localName","createTextNode","createElementNS","is","childNodes","dangerouslySetInnerHTML","innerHTML","hydrate","diffProps","firstChild","checked","parentVNode","skipRemove","componentWillUnmount","replaceNode","cloneElement","createContext","defaultValue","contextId","Consumer","contextValue","Provider","subs","ctx","_props","old","splice","isValidElement","ctor","handled","getDerivedStateFromError","setState","componentDidCatch","update","forceUpdate","Preact","interopDefault","default","navigator","serviceWorker","register","__webpack_public_path__","require","getElementById","firstElementChild","app","preRenderData","inlineDataElement","querySelector","JSON","parse","decodeURI","CLI_DATA","g","idCounter","isStackOverflowExeption","RangeError","getServiceIdentifierAsString","serviceIdentifier","listRegisteredBindingsForServiceIdentifier","container","getBindings","registeredBindingsList","registeredBindings","binding","implementationType","getFunctionName","constraint","metaData","circularDependencyToException","childRequests","childRequest","alreadyDependencyChain","parentRequest","services","_createStringArr","req","reverse","dependencyChainToString","ERROR_MSGS","v","name_1","match","getTargets","metadataReader","constructorName","isBaseClass","metadata","getConstructorMetadata","serviceIdentifiers","compilerGeneratedMetadata","constructorArgsMetadata","userGeneratedMetadata","constructorTargets","iterations","targets","getConstructorArgsAsTarget","getConstructorArgsAsTargets","propertyTargets","getClassPropsAsTargets","constructorFunc","classPropsMetadata","getPropertiesMetadata","keys_1","formatTargetMetadata","Target","TargetTypeEnum","targetName","inject","multiInject","baseConstructor","baseTargets","__spreadArrays","isManaged","unmanaged","injectIdentifier","LazyServiceIdentifer","unwrap","targetMetadataMap","METADATA_KEY","getBindingDictionary","cntnr","_bindingDictionary","_getActiveBindings","avoidConstraints","bindings","activeBindings","BindingCount","autoBindInjectable","toSelf","filter","Request","isOptional","serviceIdentifierString","msg","isTagged","isNamed","m_1","namedTag","getNamedTag","otherTags","getCustomTags","tag","listMetadataForTarget","_validateActiveBindingCount","_createSubRequests","thePlan","Plan","addPlan","addChildRequest","subChildRequest","cache","BindingTypeEnum","dependencies","getDependencies","skipBaseClassChecks","baseClassDependencyCount","getBaseClassDependencyCount","unmanagedCount","concat","dependencyCount","dependency","bindingDictionary","hasKey","plan","isMultiInject","targetType","Context","injectMetadata","tagMetadata","_createTarget","rootRequest","resolveInstance","constr","resolveRequest","Func","constructorInjections","propertyInjectionsRequests","propertyInjections","propertyName","_injectProperties","hasMetadata","getMetadata","POST_CONSTRUCT_ERROR","_postConstruct","_resolveRequest","requestScope","parentContext","setCurrentRequest","targetIsAnArray","targetParentIsNotAnArray","matchesArray","_f","binding_1","isSingleton","scope","BindingScopeEnum","isRequestSingleton","activated","dynamicValue","invokeFactory","onActivation","_proxyGetter","doCache","INJECTION","defineMetadata","newVal","NAMED_TAG","NAME_TAG","UNMANAGED_TAG","OPTIONAL_TAG","INJECT_TAG","MULTI_INJECT_TAG","TAGGED","TAGGED_PROP","PARAM_TYPES","DESIGN_PARAM_TYPES","POST_CONSTRUCT","Binding","clone","MetadataReader","currentRequest","_cb","QueryableString","str","startsWith","endsWith","reverseString","reverseSearchString","contains","equals","compareString","namedOrTagged","metadataItem","hasTag","matchesTag","matchesNamedTag","il","jl","factoryType","fn","traverseAncerstors","taggedConstraint","namedConstraint","typeConstraint","BindingWhenSyntax","_binding","when","BindingOnSyntax","whenTargetNamed","whenTargetIsDefault","whenTargetTagged","whenInjectedInto","whenParentNamed","whenParentTagged","whenAnyAncestorIs","ancestor","whenNoAncestorIs","whenAnyAncestorNamed","whenNoAncestorNamed","whenAnyAncestorTagged","whenNoAncestorTagged","whenAnyAncestorMatches","whenNoAncestorMatches","handler","BindingWhenOnSyntax","_bindingWhenSyntax","_bindingOnSyntax","BindingInSyntax","inRequestScope","inSingletonScope","inTransientScope","BindingInWhenOnSyntax","_bindingInSyntax","BindingToSyntax","to","toConstantValue","toDynamicValue","toConstructor","toFactory","toFunction","bindingWhenOnSyntax","toAutoFactory","toProvider","toService","service","ContainerSnapshot","of","middleware","Lookup","getMap","remove","removeByCondition","condition","updatedEntries","copy","traverse","__awaiter","_arguments","generator","fulfilled","step","rejected","__generator","verb","op","y","label","ops","pop","trys","sent","Container","containerOptions","defaultScope","_snapshots","_middleware","_metadataReader","merge","container1","container2","copyDictionary","destination","bindingDictionary1","bindingDictionary2","load","getHelpers","_getContainerModuleHelpersFactory","modules_1","currentModule","containerModuleHelpers","registry","bindFunction","unbindFunction","isboundFunction","rebindFunction","loadAsync","modules_2","_b","unload","conditionFactory","expected","item","rebind","unbind","unbindAll","isBound","bound","isBoundNamed","named","isBoundTagged","request_1","createMockRequest","restore","createChild","applyMiddleware","middlewares","initial","_planAndResolve","reduce","prev","curr","applyCustomMetadataReader","_get","getTagged","getNamed","getAllTagged","getAllNamed","constructorFunction","tempContainer","setModuleId","bindingToSyntax","getRebindFunction","_rebind","mId","_bind","_isBound","_unbind","defaultArgs","contextInterceptor","args","for","getDecorators","lazyInject","makePropertyInjectDecorator","lazyInjectNamed","makePropertyInjectNamedDecorator","lazyInjectTagged","makePropertyInjectTaggedDecorator","lazyMultiInject","makePropertyMultiInjectDecorator","StorageService","hasOwnMetadata","types","_inMemoryStorage","store","getLocalStorage","setItem","stringify","getAsJSON","storedData","getItem","globalThis","localStorage","getInMemoryStorage","originalLazyInject","decoratorArgs","getOwnPropertyDescriptor","App","super","useOptional","amplienceSDK","sdk","exception"],"mappings":"aAIE,SAASA,EAAoBC,GAG5B,GAAGC,EAAiBD,GACnB,OAAOC,EAAiBD,GAAUE,QAGnC,IAAIC,EAASF,EAAiBD,GAAY,CACzCI,EAAGJ,EACHK,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQN,GAAUO,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASH,GAG/DI,EAAOE,GAAI,EAGJF,EAAOD,QAvBf,IAAID,EAAmB,GA4BvBF,EAAoBS,EAAIF,EAGxBP,EAAoBU,EAAIR,EAGxBF,EAAoBW,EAAI,SAASR,EAASS,EAAMC,GAC3Cb,EAAoBc,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEb,EAAoBmB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDtB,EAAoBuB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQtB,EAAoBsB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA3B,EAAoBmB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOtB,EAAoBW,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIR1B,EAAoB8B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAJ,EAAoBW,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRb,EAAoBc,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzGhC,EAAoBmC,EAAI,mCAIjBnC,EAAoBA,EAAoBoC,EAAI,Q,8nDCnErCC,EAAgBC,G,QAC9B,YAA4DC,KAAnB,QAAlC,EAA0B,QAA1B,EAACD,SAAyB,eAAEE,cAAM,eAAEC,c,SCT7BC,EACdJ,EACAK,GAEA,IAAIC,EAUJ,G,SCJAN,G,QAEA,OACED,EAAgBC,IACoC,kBAAnDA,EAAsCO,eACsBN,KAAf,QAA9C,EAAsC,QAAtC,EAACD,SAAqC,eAAEE,cAAM,eAAEM,gBACSP,IAAxDD,EAAsCS,oBACgBR,IAAtDD,EAAsCU,kBACYT,IAAlDD,EAAsCW,cACaV,IAAnDD,EAAsCY,eACuBX,IAA7DD,EAAsCa,yBACkBZ,IAAxDD,EAAsCc,cDfrCC,CAA4Bf,KAC9BM,EAAY,IAAIU,EAAsBX,IAC5BY,aAAajB,G,SELzBA,GAEA,OACED,EAAgBC,IACiC,cAAhDA,EAAmCO,eACUN,IAA7CD,EAAmCkB,YACiBjB,IAApDD,EAAmCmB,aFClCC,CAAyBpB,KAC3BM,EAAY,IAAIe,EAAmBhB,IACzBY,aAAajB,IAEpBM,EACH,MAAM,IAAIgB,MAAMC,EAAUC,uBAG5B,OAAQlB,E,SGcYmB,EACpBpB,G,YAAA,IAAAA,MAAA,I,0EAIA,OAFMqB,EAAa,OAAqBC,GAAmBtB,GACrDuB,EAAa,IAAIC,EAAiBH,GACxC,GAAO,IAAII,SAAuB,SAAOC,EAASC,GAAM,qC,4CACtDJ,EAAWH,OACXG,EAAWK,GAAGC,EAAUC,WAAW,gD,0DAGrB,O,sBAAA,GAAMP,EAAWQ,QAAQC,EAAQC,IAAK,KAAM,CAAEC,SAAS,K,cAAjEvC,EAAU,S,6BAEVgC,EAAO,IAAIV,MAAMkB,EAAYH,U,aAE/B,IACQ/B,EAA2BF,EAAiBJ,EAAO,GACvD4B,WAAU,GACPF,IAELK,EAAQzB,GACR,MAAOmC,GACPT,EAAOS,G,oBAGXb,EAAWK,GAAGC,EAAUQ,oBAAoB,WAC1CV,EAAO,IAAIV,MAAMkB,EAAYE,wB,glBChEnC,SAAUC,GAOR,IASIC,EAT6B,WAC/B,IACE,QAAS9D,OAAO+D,SAChB,MAAOC,GACP,OAAO,GAKaC,GAEpBC,EAAiB,SAASC,GAC5B,IAAIJ,EAAW,CACbK,KAAM,WACJ,IAAIlE,EAAQiE,EAAME,QAClB,MAAO,CAAEC,UAAgB,IAAVpE,EAAkBA,MAAOA,KAU5C,OANI4D,IACFC,EAAS/D,OAAO+D,UAAY,WAC1B,OAAOA,IAIJA,GAOLQ,EAAiB,SAASrE,GAC5B,OAAOsE,mBAAmBtE,GAAOuE,QAAQ,OAAQ,MAG/CC,EAAmB,SAASxE,GAC9B,OAAOyE,mBAAmBC,OAAO1E,GAAOuE,QAAQ,MAAO,QA4HnB,WACpC,IACE,IAAII,EAAkBhB,EAAOgB,gBAE7B,MAAmD,QAA3C,IAAIA,EAAgB,QAAQC,YAAmE,mBAAlCD,EAAgBhE,UAAUkE,IAC/F,MAAOpB,GACP,OAAO,IAINqB,IAnIyB,WAE5B,IAAIH,EAAkB,SAAlBA,EAA2BI,GAC7BtF,OAAOC,eAAesF,KAAM,WAAY,CAAEC,UAAU,EAAMjF,MAAO,KACjE,IAAIkF,SAA4BH,EAEhC,GAA2B,cAAvBG,QAEG,GAA2B,WAAvBA,EACY,KAAjBH,GACFC,KAAKG,YAAYJ,QAEd,GAAIA,aAAwBJ,EAAiB,CAClD,IAAIS,EAAQJ,KACZD,EAAaM,SAAQ,SAASrF,EAAOV,GACnC8F,EAAME,OAAOhG,EAAMU,UAEhB,IAAsB,OAAjB+E,GAAkD,WAAvBG,EAkBrC,MAAM,IAAIK,UAAU,gDAjBpB,GAAqD,mBAAjD9F,OAAOkB,UAAUiE,SAAS1F,KAAK6F,GACjC,IAAK,IAAIhG,EAAI,EAAGA,EAAIgG,EAAaS,OAAQzG,IAAK,CAC5C,IAAI0G,EAAQV,EAAahG,GACzB,GAA+C,mBAA1CU,OAAOkB,UAAUiE,SAAS1F,KAAKuG,IAAkD,IAAjBA,EAAMD,OAGzE,MAAM,IAAID,UAAU,4CAA8CxG,EAAI,+BAFtEiG,KAAKM,OAAOG,EAAM,GAAIA,EAAM,SAMhC,IAAK,IAAInF,KAAOyE,EACVA,EAAanE,eAAeN,IAC9B0E,KAAKM,OAAOhF,EAAKyE,EAAazE,MASpCoF,EAAQf,EAAgBhE,UAE5B+E,EAAMJ,OAAS,SAAShG,EAAMU,GACxBV,KAAQ0F,KAAKW,SACfX,KAAKW,SAASrG,GAAMsG,KAAKlB,OAAO1E,IAEhCgF,KAAKW,SAASrG,GAAQ,CAACoF,OAAO1E,KAIlC0F,EAAMG,OAAS,SAASvG,UACf0F,KAAKW,SAASrG,IAGvBoG,EAAM9F,IAAM,SAASN,GACnB,OAAQA,KAAQ0F,KAAKW,SAAYX,KAAKW,SAASrG,GAAM,GAAK,MAG5DoG,EAAMI,OAAS,SAASxG,GACtB,OAAQA,KAAQ0F,KAAKW,SAAYX,KAAKW,SAASrG,GAAMyG,MAAM,GAAK,IAGlEL,EAAMM,IAAM,SAAS1G,GACnB,OAAQA,KAAQ0F,KAAKW,UAGvBD,EAAMb,IAAM,SAASvF,EAAMU,GACzBgF,KAAKW,SAASrG,GAAQ,CAACoF,OAAO1E,KAGhC0F,EAAML,QAAU,SAASY,EAAUC,GACjC,IAAIC,EACJ,IAAK,IAAI7G,KAAQ0F,KAAKW,SACpB,GAAIX,KAAKW,SAAS/E,eAAetB,GAAO,CACtC6G,EAAUnB,KAAKW,SAASrG,GACxB,IAAK,IAAIP,EAAI,EAAGA,EAAIoH,EAAQX,OAAQzG,IAClCkH,EAAS/G,KAAKgH,EAASC,EAAQpH,GAAIO,EAAM0F,QAMjDU,EAAMU,KAAO,WACX,IAAInC,EAAQ,GAIZ,OAHAe,KAAKK,SAAQ,SAASrF,EAAOV,GAC3B2E,EAAM2B,KAAKtG,MAEN0E,EAAeC,IAGxByB,EAAMW,OAAS,WACb,IAAIpC,EAAQ,GAIZ,OAHAe,KAAKK,SAAQ,SAASrF,GACpBiE,EAAM2B,KAAK5F,MAENgE,EAAeC,IAGxByB,EAAMS,QAAU,WACd,IAAIlC,EAAQ,GAIZ,OAHAe,KAAKK,SAAQ,SAASrF,EAAOV,GAC3B2E,EAAM2B,KAAK,CAACtG,EAAMU,OAEbgE,EAAeC,IAGpBL,IACF8B,EAAM5F,OAAO+D,UAAY6B,EAAMS,SAGjCT,EAAMd,SAAW,WACf,IAAI0B,EAAc,GAIlB,OAHAtB,KAAKK,SAAQ,SAASrF,EAAOV,GAC3BgH,EAAYV,KAAKvB,EAAe/E,GAAQ,IAAM+E,EAAerE,OAExDsG,EAAYC,KAAK,MAI1B5C,EAAOgB,gBAAkBA,EAczB6B,GAGF,IAAId,EAAQ/B,EAAOgB,gBAAgBhE,UAET,mBAAf+E,EAAMe,OACff,EAAMe,KAAO,WACX,IAAIrB,EAAQJ,KACRf,EAAQ,GACZe,KAAKK,SAAQ,SAASrF,EAAOV,GAC3B2E,EAAM2B,KAAK,CAACtG,EAAMU,IACboF,EAAMO,UACTP,EAAMS,OAAOvG,MAGjB2E,EAAMwC,MAAK,SAASC,EAAGC,GACrB,OAAID,EAAE,GAAKC,EAAE,IACH,EACCD,EAAE,GAAKC,EAAE,GACX,EAEA,KAGPvB,EAAMO,WACRP,EAAMO,SAAW,IAEnB,IAAK,IAAI5G,EAAI,EAAGA,EAAIkF,EAAMuB,OAAQzG,IAChCiG,KAAKM,OAAOrB,EAAMlF,GAAG,GAAIkF,EAAMlF,GAAG,MAKP,mBAAtB2G,EAAMP,aACf1F,OAAOC,eAAegG,EAAO,cAAe,CAC1C/F,YAAY,EACZiH,cAAc,EACd3B,UAAU,EACVjF,MAAO,SAAS+E,GACd,GAAIC,KAAKW,SACPX,KAAKW,SAAW,OACX,CACL,IAAIS,EAAO,GACXpB,KAAKK,SAAQ,SAASrF,EAAOV,GAC3B8G,EAAKR,KAAKtG,MAEZ,IAAK,IAAIP,EAAI,EAAGA,EAAIqH,EAAKZ,OAAQzG,IAC/BiG,KAAKa,OAAOO,EAAKrH,IAKrB,IACI8H,EADAC,GADJ/B,EAAeA,EAAaR,QAAQ,MAAO,KACbwC,MAAM,KAEpC,IAAShI,EAAI,EAAGA,EAAI+H,EAAWtB,OAAQzG,IACrC8H,EAAYC,EAAW/H,GAAGgI,MAAM,KAChC/B,KAAKM,OACHd,EAAiBqC,EAAU,IAC1BA,EAAUrB,OAAS,EAAKhB,EAAiBqC,EAAU,IAAM,OA7OtE,MAuPqB,IAAXlD,EAA0BA,EACV,oBAAXqD,OAA0BA,OACjB,oBAATC,KAAwBA,KAAOjC,GAG9C,SAAUrB,GAiNR,GA1M4B,WAC1B,IACE,IAAIuD,EAAI,IAAIvD,EAAOwD,IAAI,IAAK,YAE5B,OADAD,EAAEE,SAAW,QACM,mBAAXF,EAAEG,MAA8BH,EAAEI,aAC1C,MAAO7D,GACP,OAAO,GAgMN8D,IA3La,WAChB,IAAIC,EAAO7D,EAAOwD,IAEdA,EAAM,SAASM,EAAKC,GACH,iBAARD,IAAkBA,EAAM/C,OAAO+C,IAG1C,IAAoBE,EAAhBC,EAAMC,SACV,GAAIH,SAA6B,IAApB/D,EAAOmE,UAAuBJ,IAAS/D,EAAOmE,SAAST,MAAO,EAEzEM,GADAC,EAAMC,SAASE,eAAeC,mBAAmB,KAC/BC,cAAc,SACpBZ,KAAOK,EACnBE,EAAIM,KAAKC,YAAYR,GACrB,IACE,GAAuC,IAAnCA,EAAYN,KAAKe,QAAQV,GAAa,MAAM,IAAIpF,MAAMqF,EAAYN,MACtE,MAAOgB,GACP,MAAM,IAAI/F,MAAM,0BAA4BoF,EAAO,WAAaW,IAIpE,IAAIC,EAAgBV,EAAIK,cAAc,KAOtC,GANAK,EAAcjB,KAAOI,EACjBE,IACFC,EAAIW,KAAKJ,YAAYG,GACrBA,EAAcjB,KAAOiB,EAAcjB,MAGN,MAA3BiB,EAAcE,WAAqB,IAAIC,KAAKH,EAAcjB,MAC5D,MAAM,IAAI9B,UAAU,eAGtB9F,OAAOC,eAAesF,KAAM,iBAAkB,CAC5ChF,MAAOsI,IAKT,IAAIhB,EAAe,IAAI3D,EAAOgB,gBAAgBK,KAAK0D,QAC/CC,GAAqB,EACrBC,GAA2B,EAC3BxD,EAAQJ,KACZ,CAAC,SAAU,SAAU,OAAOK,SAAQ,SAASwD,GAC3C,IAAIC,EAASxB,EAAauB,GAC1BvB,EAAauB,GAAc,WACzBC,EAAOC,MAAMzB,EAAc0B,WACvBL,IACFC,GAA2B,EAC3BxD,EAAMsD,OAASpB,EAAa1C,WAC5BgE,GAA2B,OAKjCnJ,OAAOC,eAAesF,KAAM,eAAgB,CAC1ChF,MAAOsH,EACP3H,YAAY,IAGd,IAAI+I,OAAS,EACbjJ,OAAOC,eAAesF,KAAM,sBAAuB,CACjDrF,YAAY,EACZiH,cAAc,EACd3B,UAAU,EACVjF,MAAO,WACDgF,KAAK0D,SAAWA,IAClBA,EAAS1D,KAAK0D,OACVE,IACFD,GAAqB,EACrB3D,KAAKsC,aAAanC,YAAYH,KAAK0D,QACnCC,GAAqB,QAO3BjD,EAAQyB,EAAIxG,UAchB,CAAC,OAAQ,OAAQ,WAAY,OAAQ,YAClC0E,SAAQ,SAAS4D,IAba,SAASA,GACxCxJ,OAAOC,eAAegG,EAAOuD,EAAe,CAC1CrJ,IAAK,WACH,OAAOoF,KAAKkE,eAAeD,IAE7BpE,IAAK,SAAS7E,GACZgF,KAAKkE,eAAeD,GAAiBjJ,GAEvCL,YAAY,IAMZwJ,CAA2BF,MAG/BxJ,OAAOC,eAAegG,EAAO,SAAU,CACrC9F,IAAK,WACH,OAAOoF,KAAKkE,eAAL,QAETrE,IAAK,SAAS7E,GACZgF,KAAKkE,eAAL,OAAgClJ,EAChCgF,KAAKoE,uBAEPzJ,YAAY,IAGdF,OAAO4J,iBAAiB3D,EAAO,CAE7B,SAAY,CACV9F,IAAK,WACH,IAAIwF,EAAQJ,KACZ,OAAO,WACL,OAAOI,EAAMiC,QAKnB,KAAQ,CACNzH,IAAK,WACH,OAAOoF,KAAKkE,eAAe7B,KAAK9C,QAAQ,MAAO,KAEjDM,IAAK,SAAS7E,GACZgF,KAAKkE,eAAe7B,KAAOrH,EAC3BgF,KAAKoE,uBAEPzJ,YAAY,GAGd,SAAY,CACVC,IAAK,WACH,OAAOoF,KAAKkE,eAAe9B,SAAS7C,QAAQ,SAAU,MAExDM,IAAK,SAAS7E,GACZgF,KAAKkE,eAAe9B,SAAWpH,GAEjCL,YAAY,GAGd,OAAU,CACRC,IAAK,WASH,OAAOoF,KAAKkE,eAAeV,SACzB,KACAxD,KAAKkE,eAAeI,UALAtE,KAAKkE,eAAeK,MAJvB,CAAE,QAAS,GAAI,SAAU,IAAK,OAAQ,IAAKvE,KAAKkE,eAAeV,WAKnD,KAA7BxD,KAAKkE,eAAeK,KAKA,IAAMvE,KAAKkE,eAAeK,KAAQ,KAE1D5J,YAAY,GAGd,SAAY,CACVC,IAAK,WACH,MAAO,IAETiF,IAAK,aAELlF,YAAY,GAGd,SAAY,CACVC,IAAK,WACH,MAAO,IAETiF,IAAK,aAELlF,YAAY,KAIhBwH,EAAIqC,gBAAkB,SAASC,GAC7B,OAAOjC,EAAKgC,gBAAgBT,MAAMvB,EAAMwB,YAG1C7B,EAAIuC,gBAAkB,SAASjC,GAC7B,OAAOD,EAAKkC,gBAAgBX,MAAMvB,EAAMwB,YAG1CrF,EAAOwD,IAAMA,EAKbwC,QAGuB,IAApBhG,EAAOmE,YAA0B,WAAYnE,EAAOmE,UAAW,CAClE,IAAI8B,EAAY,WACd,OAAOjG,EAAOmE,SAASU,SAAW,KAAO7E,EAAOmE,SAASwB,UAAY3F,EAAOmE,SAASyB,KAAQ,IAAM5F,EAAOmE,SAASyB,KAAQ,KAG7H,IACE9J,OAAOC,eAAeiE,EAAOmE,SAAU,SAAU,CAC/ClI,IAAKgK,EACLjK,YAAY,IAEd,MAAO8D,GACPoG,aAAY,WACVlG,EAAOmE,SAASgC,OAASF,MACxB,OA9NT,MAmOqB,IAAXjG,EAA0BA,EACV,oBAAXqD,OAA0BA,OACjB,oBAATC,KAAwBA,KAAOjC,G,ICpZlC+E,EAWA7G,E,oYAXZ,SAAY6G,GACV,wBACA,cACA,oBACA,oBACA,kBALF,CAAYA,MAAY,KAWxB,SAAY7G,GACV,2BACA,2BACA,iCACA,6CAJF,CAAYA,MAAS,KAYrB,IClGK8G,EDkGL,aAkCE,WAAY3I,QAAA,IAAAA,MAAA,IA9BL,KAAA4I,WAAqB,EAGpB,KAAAC,QAA0B,GACxB,KAAAC,SAAqB,GACvB,KAAAC,SAAkB,GAGhB,KAAAC,eAAyB,GAEhB,KAAA1H,eAAqC,CACtDqE,OAAQA,OACRsD,kBAAmB,IACnB/G,QAAS,IACTgH,OAAO,EACPC,QAAQ,EACRC,iBAAiB,EACjBC,aAAc,KAcd1F,KAAK3D,QAAO,KAAQ2D,KAAKrC,eAAmBtB,GAwPhD,OA/OS,YAAAsJ,KAAP,SAAYC,EAAeC,GAMzB,OALA7F,KAAK8F,QAAQ,CACXC,KAAMhB,EAAaiB,KACnBJ,MAAK,EACLC,QAAO,IAEF7F,MASF,YAAA/B,GAAP,SAAU2H,EAAe3E,GAMvB,OALIjB,KAAKoF,SAASQ,IAAUK,MAAMC,QAAQlG,KAAKoF,SAASQ,IACtD5F,KAAKoF,SAASQ,GAAOhF,KAAKK,GAE1BjB,KAAKoF,SAASQ,GAAS,CAAC3E,GAEnBjB,MAWF,YAAA5B,QAAP,SAAwBwH,EAAeC,EAAexJ,GAAtD,WACE,YADoD,IAAAA,MAAA,IAC7C,IAAIyB,SAAa,SAACC,EAASC,GAChC,IAEImI,EAFEC,EAAe,EAAKC,SACpB9H,EAAU,EAAK+H,kBAAkBjK,EAAQkC,UAE/B,IAAZA,GAAwC,iBAAZA,IAC9B4H,EAAKnE,OAAOuE,YAAW,WAAM,OAAAvI,EAAO,aAAYO,IAElD,EAAK4G,SAASiB,GAAQ,CACpBrI,QAAS,SAACyI,GACRzI,EAAQyI,GACJL,GACFM,aAAaN,IAGjBnI,OAAQ,SAACc,GACPd,EAAOc,GACHqH,GACFM,aAAaN,KAInB,EAAKL,QAAQ,CACXC,KAAMhB,EAAa2B,QACnBd,MAAOA,EACPe,GAAIP,EACJP,QAAO,QAQN,YAAAe,MAAP,WACM5G,KAAKiF,YACPjF,KAAKuE,KAAKqC,QACV5G,KAAKiF,WAAY,GAEfjF,KAAK6G,iBACP7G,KAAK3D,QAAQ2F,OAAO8E,oBAAoB,UAAW9G,KAAK6G,iBAAiB,IAInE,YAAAE,qBAAV,sBACEN,aAAazG,KAAKsF,oBACqB,IAAnCtF,KAAK3D,QAAQiJ,oBACftF,KAAKsF,kBAAoBtD,OAAOuE,YAAW,WACrC,EAAKM,iBACP,EAAKxK,QAAQ2F,OAAO8E,oBAAoB,UAAW,EAAKD,iBAAiB,GAE3E,EAAKG,cAAc,CACjBjB,KAAMhB,EAAaiB,KACnBJ,MAAO1H,EAAUQ,mBACjBmH,QAAS,CAAEC,QAAS,8BAAgC,EAAKT,oBAE1D4B,OAAOjH,KAAK3D,QAAQiJ,sBAIjB,YAAAe,OAAV,WACE,IAAMa,EAAQlF,OAAOmF,QAAUnF,OAAOoF,SACtC,OAAS,CAAC,MAAgB,KAAO,KAAO,KAAO,MAAM7H,QAAQ,UAAU,SAACnF,GACtE,OAACA,EAAK8M,EAAMG,gBAAgB,IAAIC,WAAW,IAAI,GAAM,IAAOlN,EAAI,GAAMwF,SAAS,QAIzE,YAAA2H,uBAAV,WACEd,aAAazG,KAAKsF,oBAGV,YAAAkC,eAAV,sBACExH,KAAKuE,KAAKkD,UAAY,SAAA3B,GACpB,EAAKkB,cAAclB,EAAQ4B,OAE7B1H,KAAKuE,KAAKoD,eAAiB,SAAA7I,GACzB,EAAK8I,YAAY9I,KAIX,YAAA+I,WAAV,WACE7H,KAAKiF,WAAY,EACjBjF,KAAKuH,yBACDvH,KAAK3D,QAAQkJ,OACfuC,QAAQC,IAAI,2BAA0B/H,KAAKgI,WAAa,SAAW,WAErEhI,KAAK2F,KAAKzH,EAAUC,WACpB6B,KAAKiI,mBAGG,YAAAA,gBAAV,sBACEjI,KAAKkF,QAAQ7E,SAAQ,SAACyF,GACpB,EAAKoC,YAAYpC,MAEnB9F,KAAKkF,QAAU,IAGP,YAAA0C,YAAV,SAAsB9I,GAChBkB,KAAK3D,QAAQkJ,OACfuC,QAAQhJ,MAAMA,IAIR,YAAAkI,cAAV,SAAwBlB,GAAxB,WASE,OARI9F,KAAK3D,QAAQkJ,OACfuC,QAAQC,IACN,cAAa/H,KAAKgI,WAAa,SAAW,UAAQ,OAAOlC,EAAQC,KAAI,MACnED,EAAQF,MAAK,eAEfE,EAAQD,SAGJC,EAAQC,MACd,KAAKhB,EAAaiB,KAChB,IAAKhG,KAAKoF,SAASU,EAAQF,SAAWK,MAAMC,QAAQlG,KAAKoF,SAASU,EAAQF,QACxE,OAEF5F,KAAKoF,SAASU,EAAQF,OAAOvF,SAAQ,SAAC8H,GAAiB,OAAAA,EAAGrC,EAAQD,YAClE,MACF,KAAKd,EAAa2B,QAChB,IAAK1G,KAAKoF,SAASU,EAAQF,SAAWK,MAAMC,QAAQlG,KAAKoF,SAASU,EAAQF,QACxE,OAEF5F,KAAKoF,SAASU,EAAQF,OAAOvF,SAAQ,SAAC8H,GACpC,OAAAA,EACErC,EAAQD,SACR,SAACA,GACC,EAAKC,QAAQ,CACXa,GAAIb,EAAQa,GACZZ,KAAMhB,EAAaqD,QACnBxC,MAAOE,EAAQF,MACfC,QAAO,OAGX,SAACA,GACC,EAAKC,QAAQ,CACXa,GAAIb,EAAQa,GACZZ,KAAMhB,EAAasD,OACnBzC,MAAOE,EAAQF,MACfC,QAAO,UAKf,MACF,KAAKd,EAAaqD,QAChB,IAAKpI,KAAKmF,SAASW,EAAQa,IACzB,OAEF3G,KAAKmF,SAASW,EAAQa,IAAI5I,QAAQ+H,EAAQD,gBACnC7F,KAAKmF,SAASW,EAAQa,IAC7B,MACF,KAAK5B,EAAasD,OAChB,IAAKrI,KAAKmF,SAASW,EAAQa,IACzB,OAEF3G,KAAKmF,SAASW,EAAQa,IAAI3I,OAAO8H,EAAQD,gBAClC7F,KAAKmF,SAASW,EAAQa,MAKzB,YAAAL,kBAAV,SAA4B/H,GAC1B,MAAuB,iBAAZA,GAAwBA,GAAW,EACrCA,EACqB,iBAAZA,EACT,IACc,IAAZA,IAEY,IAAZA,IADFyB,KAAK3D,QAAQkC,SAQd,YAAAyJ,SAAV,WACE,OAAO,GAGC,YAAAlC,QAAV,SAAkBA,GAChB,IAAIwC,GAAQ,EAEVxC,EAAQF,QAAU1H,EAAUqK,WAC5BzC,EAAQF,QAAU1H,EAAUC,WAC5B2H,EAAQF,QAAU1H,EAAUsK,eAE5BF,GAAQ,GAELtI,KAAKiF,WAAcqD,EAEbtI,KAAKuE,MACdvE,KAAKkI,YAAYpC,GAFjB9F,KAAKkF,QAAQtE,KAAKkF,IAMd,YAAAoC,YAAR,SAAoBpC,GACd9F,KAAK3D,QAAQkJ,OACfuC,QAAQC,IACN,cAAa/H,KAAKgI,WAAa,SAAW,UAAQ,OAAOlC,EAAQC,KAAI,MACnED,EAAQF,MAAK,eAEfE,EAAQD,SAGZ7F,KAAKuE,KAAKkE,YAAY3C,IAE1B,EA3RA,IClGA,SAAKd,GACH,uCACA,+CACA,+DAHF,CAAKA,MAAgB,KASrB,ICTKA,GDSL,YAeE,WAAsB0D,EAA0BrM,QAAA,IAAAA,MAAA,IAAhD,MACE,YAAMA,IAAQ,K,OADM,EAAAqM,QAbZ,EAAArD,eAAmCL,EAAiB2D,WAexD,EAAKtM,QAAQmJ,QACf,EAAKoD,gBAEH,EAAKvM,QAAQoJ,iBACf,EAAKoD,kBAEP,EAAK9B,uBACL,EAAK9I,GAAGC,EAAUsK,cAAc,WAAM,SAAK5B,W,EAxBT,OA2B5B,YAAAkC,iBAAR,SAAyBrK,GACnBA,EAAEiJ,OAAS1H,KAAK2G,KAClB3G,KAAKqF,eAAiBL,EAAiB2D,WACvC3I,KAAK+G,uBACL/G,KAAK3D,QAAQ2F,OAAO8E,oBAAoB,UAAW9G,KAAK6G,iBAAiB,GACrE7G,KAAK3D,QAAQkJ,OACfuC,QAAQC,IAAI,uCAEd/H,KAAKvC,SAID,YAAAmL,cAAR,sBACE5I,KAAKqF,eAAiBL,EAAiB+D,eACvC/I,KAAK0I,MAAMM,iBAAiB,QAAQ,WAClC,EAAK3D,eAAiB,EAAKhJ,QAAQoJ,gBAC/BT,EAAiBiE,uBACjBjE,EAAiB2D,WACrB,EAAK5B,uBACL,EAAKtJ,WAID,YAAAoL,gBAAR,sBACE7I,KAAKqF,eAAiBL,EAAiBiE,uBACvCjJ,KAAK2G,GAAK3G,KAAKqG,SACf,IAAM5D,EAAM,IAAIN,IAAInC,KAAK0I,MAAMQ,KAC/BzG,EAAIH,aAAazC,IAAI,UAAWG,KAAK2G,IACrC3G,KAAK0I,MAAMQ,IAAMzG,EAAI7C,WACrBI,KAAK6G,gBAAkB,SAACpI,GAAoB,SAAKqK,iBAAiBrK,IAClEuB,KAAK3D,QAAQ2F,OAAOgH,iBAAiB,UAAWhJ,KAAK6G,kBAMhD,YAAApJ,KAAP,WACE,IAAKuC,KAAK0I,MAAMS,gBAAkBnJ,KAAK0I,MAAMQ,KAAOlJ,KAAKiF,UACvD,OAAO,EAETjF,KAAKoJ,eACLpJ,KAAKwH,iBACLxH,KAAKqJ,qBACLrJ,KAAKsJ,iBAAiBtJ,KAAK0I,MAAMS,gBAG3B,YAAAG,iBAAR,SAAyBC,GACvBA,EAAOd,YAAY,KAAMzI,KAAK3D,QAAQqJ,aAAe1F,KAAK3D,QAAQqJ,aAAe,IAAK,CACpF1F,KAAKwJ,QAAQC,SAIT,YAAAJ,mBAAR,sBACErJ,KAAK/B,GAAGC,EAAUqK,WAAW,SAAC1C,EAAc9H,GAC1CA,EAAQ8H,GACR,EAAKgC,iBAID,YAAAuB,aAAR,WACEpJ,KAAKwJ,QAAU,IAAIE,eACnB1J,KAAKuE,KAAOvE,KAAKwJ,QAAQG,OAxF7B,CAAsCC,ICTtC,SAAK5E,GACH,uCACA,qCAFF,CAAKA,MAAgB,KAOrB,ICTYxG,EAWAqL,EAOAC,EAOAC,EAOAxM,EAOAyM,ECvCA3L,EAIA4L,EAIAC,EAKAC,EAIAC,EAIAC,EASAN,EAKAO,ECtBAC,EHJZ,cAEE,WAAYlO,QAAA,IAAAA,MAAA,IAAZ,MACE,YAAMA,IAAQ,K,OACd,EAAKwK,gBAAkB,SAACpI,GAAoB,SAAK+L,eAAe/L,IAChE,EAAKpC,QAAQ2F,OAAOgH,iBAAiB,UAAW,EAAKnC,kBACd,IAAnC,EAAKxK,QAAQiJ,oBACf,EAAKD,eAAiBL,EAAiB2D,WACvC,EAAK5B,wB,EA+CX,OAvDsC,OAY7B,YAAAtJ,KAAP,WACE,IAAMgF,EAAM,IAAIN,IAAInC,KAAK3D,QAAQ2F,OAAOc,SAASlD,YACjDI,KAAK2G,GAAKlE,EAAIH,aAAa1H,IAAI,WAC3BoF,KAAK3D,QAAQkJ,OACfuC,QAAQC,IAAI,kCAAmC/H,KAAK2G,IAEtD3G,KAAK3D,QAAQ2F,OAAOyI,OAAOhC,YAAYzI,KAAK2G,GAAI3G,KAAK3D,QAAQqJ,eAGvD,YAAA8E,eAAR,SAAuB/L,GACjBA,EAAEiM,MAAM,KACV1K,KAAKuE,KAAO9F,EAAEiM,MAAM,GACpB1K,KAAKwH,iBACLxH,KAAKqJ,qBACLrJ,KAAK3D,QAAQ2F,OAAO8E,oBAAoB,UAAW9G,KAAK6G,mBAIlD,YAAAwC,mBAAV,uBACyC,IAAnCrJ,KAAK3D,QAAQiJ,oBACftF,KAAKqF,eAAiBL,EAAiBuD,UACvCvI,KAAK+G,wBAEP/G,KAAK5B,QAAQF,EAAUqK,UAAW,KAAM,CAAEhK,SAAS,IAChDoM,MAAK,WACJ,EAAKC,uBACL,EAAK/C,gBAENgD,OAAM,SAACpM,GACN,EAAKmJ,YAAYnJ,OAIb,YAAAmM,qBAAV,sBACE5K,KAAK3D,QAAQ2F,OAAOgH,iBAAiB,gBAAgB,WACnD,EAAKrD,KAAKzH,EAAUsK,cACpB,EAAK5B,YAIC,YAAAoB,SAAV,WACE,OAAO,GAEX,EAvDA,CAAsC4B,ICTtC,SAAYpL,GAIV,qDAIA,wEARF,CAAYA,MAAW,KAWvB,SAAYqL,GAIV,2CAJF,CAAYA,MAAmB,KAO/B,SAAYC,GAIV,2EAJF,CAAYA,MAAY,KAOxB,SAAYC,GAIV,0FAJF,CAAYA,MAAI,KAOhB,SAAYxM,GAIV,gDAJF,CAAYA,MAAS,KAOrB,SAAYyM,GAIV,sEAJF,CAAYA,MAAqB,KCvCjC,SAAY3L,GACV,oBADF,CAAYA,MAAO,KAInB,SAAY4L,GACV,yBADF,CAAYA,MAAY,KAIxB,SAAYC,GACV,8BACA,8BAFF,CAAYA,MAAU,KAKtB,SAAYC,GACV,iCADF,CAAYA,MAAY,KAIxB,SAAYC,GACV,0CADF,CAAYA,MAAiB,KAI7B,SAAYC,GACV,8BACA,8BACA,kCACA,wCACA,wCACA,gCANF,CAAYA,MAAK,KASjB,SAAYN,GACV,oCACA,kCAFF,CAAYA,MAAI,KAKhB,SAAYO,GACV,0BACA,0BAFF,CAAYA,MAAK,KCtBjB,SAAYC,GACV,YACA,cACA,YACA,gBACA,kBALF,CAAYA,MAAU,KAqCtB,IClDYO,EDkDZ,aAcE,WAAoBlN,GAAA,KAAAA,aAbZ,KAAAmN,cAAgB,CACtBC,OAAQ,IACRtD,KAAM,CACJuD,OAAQ,CACN,CACEC,KAAM,UACNC,MAAO,QACPrF,QAAS,oBAgCnB,OAxBe,YAAA1H,QAAb,SAAqBgN,G,kGAEA,O,sBAAA,GAAMpL,KAAKpC,WAAWQ,QAAsB,+BAAgC,CAC3FsJ,KAAM0D,EAAO1D,KACb5D,OAAQsH,EAAOtH,OACfuH,QAASD,EAAOC,QAChB5I,IAAK2I,EAAO3I,O,OAGd,SAAO,CACLiF,MARI4D,EAAW,UAQA5D,KACfsD,OAAQM,EAASN,S,OAGnB,O,YACE,GAAO,CACLtD,KAAM,EAAMA,KACZsD,OAAQ,EAAMA,SAIlB,GAAOhL,KAAK+K,e,yBAGlB,EAxCA,GE1BA,aAGE,WAAoBnN,GAAA,KAAAA,aAClBoC,KAAKuJ,OAAS,IAAIgC,EAAW3N,GAoCjC,OAjCQ,YAAA4N,KAAN,W,iHAEmC,O,sBAAA,GAAMxL,KAAKuJ,OAAOnL,QAAQ,CACvDqE,IClCiB,mCDmCjBqB,OAAQyG,EAAWjM,O,OAGrB,GAAwB,OALlBgN,EAAyB,UAKlBN,OACX,MAAM,IAAI1N,MACR,qDACEgO,EAAS5D,MAAQ,eAAe4D,EAASN,SAK/C,UACyD,QAArD,EAA+C,QAAjD,EAAEM,aAAQ,EAARA,EAAU5D,YAAqC,eAAEA,YAAI,eAAE+D,KAAI,SAACC,GAC5D,SAAKC,cAAcD,QAChB,I,OAGP,M,WAAM,IAAIpO,MAAM,wBAAwB,EAAMwI,S,yBAI1C,YAAA6F,cAAR,SAAsBC,GACpB,MAAO,CACLjF,GAAIiF,EAASjF,GACbkF,UAAWD,EAAS9J,WAAW,cAC/BgK,SAAUF,EAAS9J,WAAW,aAC9BiK,MAAOH,EAAS9J,WAAWiK,QAGjC,EAxCA,GbLA,EAgBE,SAA+B1P,GAAA,KAAAA,UAC7B2D,KAAKpC,WAAaoC,KAAK3D,QAAQuB,WAC/BoC,KAAKuJ,OAAS,IAAIgC,EAAWvL,KAAKpC,YAClCoC,KAAKgM,MAAQ,IAAIC,EAAMjM,KAAKpC,aelChC,aAME,WAAoBA,GAAA,KAAAA,aAuBtB,OAJQ,YAAAsO,WAAN,W,0FACsB,SAAMlM,KAAKpC,WAAWQ,QAAQ6L,EAAa3L,M,OAC/D,SADoB,kBAGxB,EA7BA,GCUA,aAME,WAAoBV,GAAA,KAAAA,aAuDtB,OAxCE,YAAAuO,YAAA,SACEC,EACA/P,GAKA,YALA,IAAAA,MAAA,CAAgCgQ,IAAK,YAEjBpQ,IAAhBI,EAAQgQ,MACVhQ,EAAQgQ,IAAM,MAETrM,KAAKsM,WAAWF,EAAgB/P,EAAQgQ,MAe3C,YAAAzR,IAAN,SAAUwR,G,kEACR,SAAOpM,KAAKsM,WAAWF,WAGnB,YAAAE,WAAN,SAAiBF,EAA+BC,G,wEAC9C,IAAKD,IAAmBnG,MAAMC,QAAQkG,KAAoBA,EAAe5L,OACvE,MAAM,IAAIlD,MAAMuM,EAAoB0C,QAQtC,OALMjB,EAAW,EAAH,CACZc,eAAc,QACDnQ,IAARoQ,GAAqB,CAAEA,IAAG,IAAO,IAGxC,GAAOrM,KAAKpC,WAAWQ,QAAQ+L,EAAaqC,YAAalB,EAAU,CACjE/M,SAAS,YAGf,EA7DA,GCEA,aAME,WAAoBX,GAAA,KAAAA,aAqDtB,OArCE,YAAAuO,YAAA,SACEC,EACA/P,GAEA,YAFA,IAAAA,MAAA,CAAqCgQ,IAAK,OAEnCrM,KAAKyM,gBAAgBL,EAAgB/P,EAAQgQ,MAehD,YAAAzR,IAAN,SAAUwR,G,kEACR,SAAOpM,KAAKyM,gBAAgBL,WAGtB,YAAAK,gBAAR,SAAwBL,EAA+BC,GACrD,IAAKD,IAAmBnG,MAAMC,QAAQkG,KAAoBA,EAAe5L,OACvE,MAAM,IAAIlD,MAAMuM,EAAoB0C,QAGtC,IAAMjB,EAAW,EAAH,CACZc,eAAc,QACDnQ,IAARoQ,GAAqB,CAAEA,IAAG,IAAO,IAGxC,OAAOrM,KAAKpC,WAAWQ,QAAQgM,EAAkBsC,gBAAiBpB,EAAU,CAC1E/M,SAAS,KAGf,EA3DA,GCIA,aAOE,WAAoBX,EAAqC+O,GAArC,KAAA/O,aAAqC,KAAA+O,SAmG3D,OAvFE,YAAAC,SAAA,WACE,OAAO5M,KAAKpC,WAAWQ,QAAQiM,EAAMwC,YAmBjC,YAAAC,SAAN,SAAe9R,G,gGACE,SAAMgF,KAAKpC,WAAWQ,QAAuBiM,EAAM0C,UAAW/R,I,OAE7E,OAFMiQ,EAAS,WAEDA,EAAOzK,OACnB,GAAO1C,QAAQE,OAAOiN,IAGxB,YAgBI,YAAA+B,QAAN,SAAchS,G,0FACI,SAAMgF,KAAKpC,WAAWQ,QAAiBiM,EAAM4C,eAAgBjS,I,OAE7E,SAFgB,kBAwBZ,YAAAkS,SAAN,SAAelS,G,gGACE,SAAMgF,KAAKpC,WAAWQ,QAA8BiM,EAAM8C,eAAgBnS,I,OAEzF,UAFMiQ,EAAS,WAEEA,EAAOzK,OAASyK,OAAShP,WAa5C,YAAAmR,MAAA,WACE,OAAOpN,KAAKpC,WAAWQ,QAAQiM,EAAMgD,cAEzC,EA1GA,GCbA,aAGE,WAAoBzP,EAAqChB,GAAzD,WAAoB,KAAAgB,aAAqC,KAAAhB,WACvDoD,KAAKsN,cAAgB,GAErBtN,KAAKpC,WAAWK,GAAG8L,EAAKwD,WAAW,SAACC,GAClC,EAAK5Q,SAAW4Q,EAChB,EAAKF,cAAcjN,SAAQ,SAAC8H,GAAO,OAAAA,EAAG,EAAKvL,gBA8DjD,OA9BE,YAAA6Q,iBAAA,SAAiBtF,GAEf,OADAnI,KAAKsN,cAAc1M,KAAKuH,GACjBnI,MAmBH,YAAA4M,SAAN,W,0FAEkB,O,sBAAA,GAAM5M,KAAKpC,WAAWQ,QAAyB2L,EAAK2D,iB,OAElE,SAFc,U,OAId,M,SAAM,IAAIpQ,MAAMqQ,EAAOC,U,yBAG7B,EAtEA,GCHA,aAYE,WAAoBhQ,EAAsCiQ,GAA1D,gBAA0D,IAAAA,MAAA,QAAtC,KAAAjQ,aAAsC,KAAAiQ,MAXnD,KAAAC,gBAA0B,EAEzB,KAAAC,SAA6B,IAAIC,kBAAiB,WAAM,SAAKC,kBAUnE,IAAMC,EAAc,IAAIpQ,SAAQ,SAACC,GACC,aAA5B8P,EAAIhL,SAASsL,YACfpQ,GAAQ,GAEV8P,EAAI7E,iBAAiB,QAAQ,WAC3BjL,GAAQ,SAIZiC,KAAKpC,WAAWK,GAAGqM,EAAM8D,YAAY,SAAOC,EAAetQ,GAAiB,qC,kDAC1E,SAAMmQ,G,cAAN,SACAnQ,EAAQiC,KAAKsO,a,cAGftO,KAAKuO,oBAAsBvO,KAAKiO,aAAa1S,KAAKyE,MAsHtD,OAtGS,YAAAsO,UAAP,WACU,IAAAE,EAAoBxO,KAAK6N,IAAIhL,SAAd,gBAEvB,OAAI2L,EACiBA,EAAgBC,wBAArB,OAKT,GAmBF,YAAAC,UAAP,SAAiBC,GACf,QAAe1S,IAAX0S,GAAuD,iBAAvBA,EAClC,MAAM,IAAIpO,UAAUuJ,EAAa8E,mBAGnC,IAAMC,OAAe5S,IAAX0S,EAAuB3O,KAAKsO,YAAcK,EAEpD3O,KAAK8O,eAAiBH,EACtB3O,KAAKpC,WAAW+H,KAAK2E,EAAMyE,WAAYF,EAAI,EAAI,EAAIA,IAiB9C,YAAAG,iBAAP,WACMhP,KAAK8N,iBAIT9N,KAAK8N,gBAAiB,EAEtB9N,KAAK+N,SAASkB,QAAQjP,KAAK6N,IAAIhL,SAASU,KAAM,CAC5CzB,YAAY,EACZoN,WAAW,EACXC,SAAS,EACTC,eAAe,IAGjBpP,KAAK6N,IAAI7E,iBAAiB,SAAUhJ,KAAKuO,uBAgBpC,YAAAc,gBAAP,WACOrP,KAAK8N,iBAIV9N,KAAK8N,gBAAiB,EACtB9N,KAAK+N,SAASuB,aACdtP,KAAK6N,IAAI/G,oBAAoB,SAAU9G,KAAKuO,uBAGtC,YAAAN,aAAR,WACE,IAAMU,EAAS3O,KAAKsO,YAEhBK,IAAW3O,KAAK8O,gBAIpB9O,KAAK0O,UAAUC,IAEnB,EAjJA,GCgBA,aAME,WAAoB/Q,GAAA,KAAAA,aAqHtB,OAnEE,YAAA2R,SAAA,WACE,OAAOvP,KAAKpC,WAAWQ,QAAQ8L,EAAWsF,UAAW,KAAM,CACzDjR,SAAS,KAkBb,YAAAkR,UAAA,SAAU,GACR,OAAOzP,KAAKpC,WAAWQ,QAAQ8L,EAAWsF,UAAW,CAAEnD,UAD/C,MAAwB,CAAEA,IAAK,MAAM,GAAhC,KACiD,CAAE9N,SAAS,KAiB3E,YAAAmR,SAAA,WACE,OAAO1P,KAAKpC,WAAWQ,QAAQ8L,EAAWyF,UAAW,KAAM,CACzDpR,SAAS,KAkBb,YAAAqR,UAAA,SAAU,GACR,OAAO5P,KAAKpC,WAAWQ,QACrB8L,EAAWyF,UACX,CAAEtD,UAHI,MAAwB,CAAEA,IAAK,MAAM,GAAhC,KAIX,CACE9N,SAAS,KAIjB,EA3HA,G,cCyCE,WAAYlC,GAAZ,MACE,YAAMA,IAAQ,K,OAEd,EAAKwT,UAAY,IAAIC,EAAU,EAAKlS,YACpC,EAAKmS,YAAc,IAAIC,EAAY,EAAKpS,YACxC,EAAKqS,iBAAmB,IAAIC,EAAiB,EAAKtS,YAClD,EAAK8K,MAAQ,IAAIyH,EAAM,EAAKvS,WAAYvB,EAAQ2F,Q,EAcpD,OAlEU,OAuDR,YAAA/E,aAAA,SAAajB,GACH,IAAAU,EAA8EV,EAAnE,YAAEE,EAAiEF,EAA3D,OAAEW,EAAyDX,EAAlD,QAAEa,EAAgDb,EAA9B,mBAAEY,EAA4BZ,EAApB,SAAEc,EAAkBd,EAAL,cAEjFgE,KAAKoQ,YAAc,IAAIC,EAAYrQ,KAAKpC,YACxCoC,KAAKsQ,MAAQ,IAAIC,EAAMvQ,KAAKpC,WAAYlB,GACxCsD,KAAKwQ,KAAO,IAAIC,EAAKzQ,KAAKpC,WAAYhB,GACtCoD,KAAK9D,OAASA,EACd8D,KAAKrD,QAAUA,EACfqD,KAAKlD,cAAgBA,EACrBkD,KAAKnD,mBAAqBA,GAE9B,E,CAlEU6T,IVfV,SAAY5F,GACV,iBADF,CAAYA,MAAa,KWmBzB,iBACE,WAA6B3N,EAA8B6E,GAA9B,KAAA7E,eAA8B,KAAA6E,SAiD7D,OA/CE,YAAA2O,mBAAA,SAAmBtU,GACjB,YADiB,IAAAA,MAAA,IACV2D,KAAK4Q,YAAe5Q,KAAK6Q,cAAa,4BAA6BxU,IAG5E,YAAAyU,mBAAA,SAAmBzU,GACjB,YADiB,IAAAA,MAAA,IACV2D,KAAK4Q,YAAe5Q,KAAK6Q,cAAa,4BAA6BxU,IAG5E,YAAA0U,eAAA,SAAe1U,GACb,YADa,IAAAA,MAAA,IACN2D,KAAK4Q,YAAe5Q,KAAK6Q,cAAa,wBAAyBxU,IAGxE,YAAA2U,UAAA,SAAUpL,EAAcvJ,GACtB,YADsB,IAAAA,MAAA,IACf2D,KAAK4Q,YAAe5Q,KAAK6Q,cAAa,mBAAmBjL,EAAMe,GAAMtK,IAG9E,YAAA4U,YAAA,SAAYC,EAAkB7U,GAC5B,YAD4B,IAAAA,MAAA,IACrB2D,KAAK4Q,YACP5Q,KAAK6Q,cAAa,qBAAqBK,EAAQC,QAAO,IAAID,EAAQvK,GAAE,IACvEtK,IAIJ,YAAA+U,mBAAA,SAAmB/U,GACjB,YADiB,IAAAA,MAAA,IACV2D,KAAK4Q,YAAe5Q,KAAK6Q,cAAa,2BAA4BxU,IAG3E,YAAAgV,gBAAA,SAAgB1K,EAAiBtK,GAC/B,YAD+B,IAAAA,MAAA,IACxB2D,KAAK4Q,YAAe5Q,KAAK6Q,cAAa,gCAAgClK,EAAGA,GAAMtK,IAGhF,YAAAuU,YAAR,SAAoBvO,EAAchG,GAChC,GAAIA,EAAQiV,WACV,OAAOjP,EAETrC,KAAKgC,OAAOyI,OAAO3H,SAAST,KAAOA,GAG7B,YAAAwO,YAAR,WACE,IAA4D,IAAxD7Q,KAAK7C,aAAaiG,QAAQ0H,EAAcyG,WAC1C,MAAM,IAAIjU,MAAM0M,EAAsBwH,wBAGlC,MAAkBxR,KAAK7C,aAAa4E,MAAM+I,EAAcyG,WAAvDE,EAAO,KACRC,EADc,KACC3P,MAAM,KAAK,GAChC,MAAO,GAAG0P,EAAU3G,EAAcyG,UAAS,IAAIG,GAEnD,EAlDA,G,cCME,WAAYrV,G,OACV,YAAMA,IAAQ,KAWlB,OAhC2E,OAwBzE,YAAAY,aAAA,SAAajB,GACH,IAAOmB,EAAyBnB,EAAb,aAAEE,EAAWF,EAAL,OAEnCgE,KAAK9C,MAFmClB,EAA3B,MAGbgE,KAAK7C,aAAeA,EACpB6C,KAAK9D,OAASA,EACd8D,KAAK2R,qBAAuB,IAAIC,EAAqB5R,KAAK7C,aAAc6C,KAAK3D,QAAQ2F,SAEzF,E,CAhC2E0O,GpBQrE/S,EAA8B,CAClCqE,OAAQA,OACRsD,mBAAmB,EACnB/G,SAAS,EACTgH,OAAO,K,8DqBjBT,YAcA,IAAIsM,GACJ,SAAWA,IAGP,WAaI,SAASC,EAAaC,EAAQC,GAC1B,OAAO,SAAU1W,EAAKN,GACS,mBAAhB+W,EAAOzW,IACdb,OAAOC,eAAeqX,EAAQzW,EAAK,CAAEsG,cAAc,EAAM3B,UAAU,EAAMjF,MAAOA,IAEhFgX,GACAA,EAAS1W,EAAKN,IAlB1B,IAAIiX,EAAyB,iBAAXtT,EAAsBA,EACpB,iBAATsD,KAAoBA,KACP,iBAATjC,KAAoBA,KACvBkS,SAAS,eAATA,GACRC,EAAWL,EAAaD,QACA,IAAjBI,EAAKJ,QACZI,EAAKJ,QAAUA,EAGfM,EAAWL,EAAaG,EAAKJ,QAASM,GAY3C,SAAUA,GAygBT,SAASC,EAAuBC,EAAGC,EAAGC,GAClC,IAAIC,EAAiBC,EAAS7X,IAAIyX,GAClC,GAAIK,EAAYF,GAAiB,CAC7B,IAAKD,EACD,OACJC,EAAiB,IAAIG,EACrBF,EAAS5S,IAAIwS,EAAGG,GAEpB,IAAII,EAAcJ,EAAe5X,IAAI0X,GACrC,GAAII,EAAYE,GAAc,CAC1B,IAAKL,EACD,OACJK,EAAc,IAAID,EAClBH,EAAe3S,IAAIyS,EAAGM,GAE1B,OAAOA,EAeX,SAASC,EAAuBC,EAAaT,EAAGC,GAC5C,IAAIM,EAAcR,EAAuBC,EAAGC,GAAc,GAC1D,OAAII,EAAYE,MAECA,EAAY5R,IAAI8R,GAerC,SAASC,EAAuBD,EAAaT,EAAGC,GAC5C,IAAIM,EAAcR,EAAuBC,EAAGC,GAAc,GAC1D,IAAII,EAAYE,GAEhB,OAAOA,EAAYhY,IAAIkY,GAI3B,SAASE,EAA0BF,EAAaG,EAAeZ,EAAGC,GAC5CF,EAAuBC,EAAGC,GAAc,GAC9CzS,IAAIiT,EAAaG,GAoCjC,SAASC,EAAwBb,EAAGC,GAChC,IAAIlR,EAAO,GACPwR,EAAcR,EAAuBC,EAAGC,GAAc,GAC1D,GAAII,EAAYE,GACZ,OAAOxR,EAIX,IAHA,IACIvC,EAkLR,SAAqBsU,GACjB,IAAIrP,EAASsP,EAAUD,EAAKE,GAC5B,IAAKC,EAAWxP,GACZ,MAAM,IAAIvD,UACd,IAAI1B,EAAWiF,EAAO5J,KAAKiZ,GAC3B,IAAKI,EAAS1U,GACV,MAAM,IAAI0B,UACd,OAAO1B,EAzLQ2U,CADDZ,EAAYxR,QAEtBqS,EAAI,IACK,CACT,IAAIvU,EAAOwU,EAAa7U,GACxB,IAAKK,EAED,OADAkC,EAAKZ,OAASiT,EACPrS,EAEX,IAAIuS,EAA0BzU,EAsLhBlE,MArLd,IACIoG,EAAKqS,GAAKE,EAEd,MAAOlV,GACH,IACImV,EAAc/U,GADlB,QAII,MAAMJ,GAGdgV,KAKR,SAASI,EAAKC,GACV,GAAU,OAANA,EACA,OAAO,EACX,cAAeA,GACX,IAAK,YAAa,OAAO,EACzB,IAAK,UAAW,OAAO,EACvB,IAAK,SAAU,OAAO,EACtB,IAAK,SAAU,OAAO,EACtB,IAAK,SAAU,OAAO,EACtB,IAAK,SAAU,OAAa,OAANA,EAAa,EAAe,EAClD,QAAS,OAAO,GAKxB,SAASpB,EAAYoB,GACjB,YAAa7X,IAAN6X,EAIX,SAASC,EAAOD,GACZ,OAAa,OAANA,EASX,SAASP,EAASO,GACd,MAAoB,iBAANA,EAAuB,OAANA,EAA0B,mBAANA,EAMvD,SAASE,EAAYC,EAAOC,GACxB,OAAQL,EAAKI,IACT,KAAK,EACL,KAAK,EACL,KAAK,EACL,KAAK,EACL,KAAK,EACL,KAAK,EAAgB,OAAOA,EAEhC,IAAIE,EAAyB,IAAlBD,EAAmC,SAA6B,IAAlBA,EAAmC,SAAW,UACnGE,EAAehB,EAAUa,EAAOI,GACpC,QAAqBpY,IAAjBmY,EAA4B,CAC5B,IAAIE,EAASF,EAAala,KAAK+Z,EAAOE,GACtC,GAAIZ,EAASe,GACT,MAAM,IAAI/T,UACd,OAAO+T,EAEX,OAIJ,SAA6BjC,EAAG8B,GAC5B,GAAa,WAATA,EAAmB,CACnB,IAAII,EAAalC,EAAEzS,SACnB,GAAI0T,EAAWiB,GAEX,IAAKhB,EADDe,EAASC,EAAWra,KAAKmY,IAEzB,OAAOiC,EAGf,GAAIhB,EADAkB,EAAUnC,EAAEmC,SAGZ,IAAKjB,EADDe,EAASE,EAAQta,KAAKmY,IAEtB,OAAOiC,MAGd,CACD,IAAIE,EACJ,GAAIlB,EADAkB,EAAUnC,EAAEmC,SAGZ,IAAKjB,EADDe,EAASE,EAAQta,KAAKmY,IAEtB,OAAOiC,EAEf,IAEQA,EAFJG,EAAapC,EAAEzS,SACnB,GAAI0T,EAAWmB,GAEX,IAAKlB,EADDe,EAASG,EAAWva,KAAKmY,IAEzB,OAAOiC,EAGnB,MAAM,IAAI/T,UAjCHmU,CAAoBT,EAAgB,YAATE,EAAqB,SAAWA,GA+CtE,SAASQ,EAAcC,GACnB,IAAItZ,EAAM0Y,EAAYY,EAAU,GAChC,MA7EoB,iBA6EPtZ,EACFA,EARf,SAAkBsZ,GACd,MAAO,GAAKA,EAQLC,CAASvZ,GAMpB,SAASwZ,EAAQF,GACb,OAAO3O,MAAMC,QACPD,MAAMC,QAAQ0O,GACdA,aAAoBna,OAChBma,aAAoB3O,MACyB,mBAA7CxL,OAAOkB,UAAUiE,SAAS1F,KAAK0a,GAI7C,SAAStB,EAAWsB,GAEhB,MAA2B,mBAAbA,EAIlB,SAASG,EAAcH,GAEnB,MAA2B,mBAAbA,EAelB,SAASxB,EAAU4B,EAAG1C,GAClB,IAAI2C,EAAOD,EAAE1C,GACb,GAAI2C,QAAJ,CAEA,IAAK3B,EAAW2B,GACZ,MAAM,IAAI1U,UACd,OAAO0U,GAoBX,SAASvB,EAAa7U,GAClB,IAAIyV,EAASzV,EAASK,OACtB,OAAOoV,EAAOlV,MAAekV,EAIjC,SAASV,EAAc/U,GACnB,IAAIqW,EAAIrW,EAAQ,OACZqW,GACAA,EAAEhb,KAAK2E,GAMf,SAASsW,EAAuB9C,GAC5B,IAAI3R,EAAQjG,OAAO2a,eAAe/C,GAClC,GAAiB,mBAANA,GAAoBA,IAAMgD,EACjC,OAAO3U,EAQX,GAAIA,IAAU2U,EACV,OAAO3U,EAEX,IAAI/E,EAAY0W,EAAE1W,UACd2Z,EAAiB3Z,GAAalB,OAAO2a,eAAezZ,GACxD,GAAsB,MAAlB2Z,GAA0BA,IAAmB7a,OAAOkB,UACpD,OAAO+E,EAEX,IAAI6U,EAAcD,EAAeC,YACjC,MAA2B,mBAAhBA,GAGPA,IAAgBlD,EAFT3R,EAKJ6U,EAmOX,SAASC,EAAerC,GAGpB,OAFAA,EAAIsC,QAAKxZ,SACFkX,EAAIsC,GACJtC,EA9jCX,IAAIuC,EAASjb,OAAOkB,UAAUC,eAE1B+Z,EAAmC,mBAAX7a,OACxBuZ,EAAoBsB,QAAgD,IAAvB7a,OAAO8a,YAA8B9a,OAAO8a,YAAc,gBACvGvC,EAAiBsC,QAA6C,IAApB7a,OAAO+D,SAA2B/D,OAAO+D,SAAW,aAC9FgX,EAA0C,mBAAlBpb,OAAOY,OAC/Bya,EAAgB,CAAEC,UAAW,cAAgB9P,MAC7C+P,GAAaH,IAAmBC,EAChCG,EAAU,CAEV5a,OAAQwa,EACF,WAAc,OAAOL,EAAe/a,OAAOY,OAAO,QAClDya,EACI,WAAc,OAAON,EAAe,CAAEO,UAAW,QACjD,WAAc,OAAOP,EAAe,KAC9CxU,IAAKgV,EACC,SAAUvK,EAAKnQ,GAAO,OAAOoa,EAAOxb,KAAKuR,EAAKnQ,IAC9C,SAAUmQ,EAAKnQ,GAAO,OAAOA,KAAOmQ,GAC1C7Q,IAAKob,EACC,SAAUvK,EAAKnQ,GAAO,OAAOoa,EAAOxb,KAAKuR,EAAKnQ,GAAOmQ,EAAInQ,QAAOW,GAChE,SAAUwP,EAAKnQ,GAAO,OAAOmQ,EAAInQ,KAGvC+Z,EAAoB5a,OAAO2a,eAAelD,UAC1CgE,EAAiC,iBAAZC,SAAwBA,QAAQC,KAA4D,SAArDD,QAAQC,IAAR,kCAC5DzD,EAAQuD,GAA8B,mBAARG,KAAuD,mBAA1BA,IAAI1a,UAAUwF,QAk0B7E,WA8GI,SAASmV,EAAOhb,GACZ,OAAOA,EAEX,SAASsR,EAAS2J,EAAGvb,GACjB,OAAOA,EAEX,SAASwb,EAASlb,EAAKN,GACnB,MAAO,CAACM,EAAKN,GApHjB,IAAIyb,EAAgB,GAChBC,EAAgB,GAChBC,EAA6B,WAC7B,SAASA,EAAYvV,EAAMC,EAAQuV,GAC/B5W,KAAK6W,OAAS,EACd7W,KAAK8W,MAAQ1V,EACbpB,KAAK+W,QAAU1V,EACfrB,KAAKgX,UAAYJ,EAoCrB,OAlCAD,EAAYhb,UAAU,cAAgB,WAAc,OAAOqE,MAC3D2W,EAAYhb,UAAU0X,GAAkB,WAAc,OAAOrT,MAC7D2W,EAAYhb,UAAUuD,KAAO,WACzB,IAAI+X,EAAQjX,KAAK6W,OACjB,GAAII,GAAS,GAAKA,EAAQjX,KAAK8W,MAAMtW,OAAQ,CACzC,IAAI8T,EAAStU,KAAKgX,UAAUhX,KAAK8W,MAAMG,GAAQjX,KAAK+W,QAAQE,IAS5D,OARIA,EAAQ,GAAKjX,KAAK8W,MAAMtW,QACxBR,KAAK6W,QAAU,EACf7W,KAAK8W,MAAQJ,EACb1W,KAAK+W,QAAUL,GAGf1W,KAAK6W,SAEF,CAAE7b,MAAOsZ,EAAQlV,MAAM,GAElC,MAAO,CAAEpE,WAAOiB,EAAWmD,MAAM,IAErCuX,EAAYhb,UAAUub,MAAQ,SAAUpY,GAMpC,MALIkB,KAAK6W,QAAU,IACf7W,KAAK6W,QAAU,EACf7W,KAAK8W,MAAQJ,EACb1W,KAAK+W,QAAUL,GAEb5X,GAEV6X,EAAYhb,UAAUwb,OAAS,SAAUnc,GAMrC,OALIgF,KAAK6W,QAAU,IACf7W,KAAK6W,QAAU,EACf7W,KAAK8W,MAAQJ,EACb1W,KAAK+W,QAAUL,GAEZ,CAAE1b,MAAOA,EAAOoE,MAAM,IAE1BuX,EAzCsB,GA2CjC,OAAsB,WAClB,SAASN,IACLrW,KAAK8W,MAAQ,GACb9W,KAAK+W,QAAU,GACf/W,KAAKoX,UAAYX,EACjBzW,KAAKqX,aAAe,EAyDxB,OAvDA5c,OAAOC,eAAe2b,EAAI1a,UAAW,OAAQ,CACzCf,IAAK,WAAc,OAAOoF,KAAK8W,MAAMtW,QACrC7F,YAAY,EACZiH,cAAc,IAElByU,EAAI1a,UAAUqF,IAAM,SAAU1F,GAAO,OAAO0E,KAAKsX,MAAMhc,GAAgB,IAAU,GACjF+a,EAAI1a,UAAUf,IAAM,SAAUU,GAC1B,IAAI2b,EAAQjX,KAAKsX,MAAMhc,GAAgB,GACvC,OAAO2b,GAAS,EAAIjX,KAAK+W,QAAQE,QAAShb,GAE9Coa,EAAI1a,UAAUkE,IAAM,SAAUvE,EAAKN,GAC/B,IAAIic,EAAQjX,KAAKsX,MAAMhc,GAAgB,GAEvC,OADA0E,KAAK+W,QAAQE,GAASjc,EACfgF,MAEXqW,EAAI1a,UAAUkF,OAAS,SAAUvF,GAC7B,IAAI2b,EAAQjX,KAAKsX,MAAMhc,GAAgB,GACvC,GAAI2b,GAAS,EAAG,CAEZ,IADA,IAAIM,EAAOvX,KAAK8W,MAAMtW,OACbzG,EAAIkd,EAAQ,EAAGld,EAAIwd,EAAMxd,IAC9BiG,KAAK8W,MAAM/c,EAAI,GAAKiG,KAAK8W,MAAM/c,GAC/BiG,KAAK+W,QAAQhd,EAAI,GAAKiG,KAAK+W,QAAQhd,GAQvC,OANAiG,KAAK8W,MAAMtW,SACXR,KAAK+W,QAAQvW,SACTlF,IAAQ0E,KAAKoX,YACbpX,KAAKoX,UAAYX,EACjBzW,KAAKqX,aAAe,IAEjB,EAEX,OAAO,GAEXhB,EAAI1a,UAAU6b,MAAQ,WAClBxX,KAAK8W,MAAMtW,OAAS,EACpBR,KAAK+W,QAAQvW,OAAS,EACtBR,KAAKoX,UAAYX,EACjBzW,KAAKqX,aAAe,GAExBhB,EAAI1a,UAAUyF,KAAO,WAAc,OAAO,IAAIuV,EAAY3W,KAAK8W,MAAO9W,KAAK+W,QAAST,IACpFD,EAAI1a,UAAU0F,OAAS,WAAc,OAAO,IAAIsV,EAAY3W,KAAK8W,MAAO9W,KAAK+W,QAASnK,IACtFyJ,EAAI1a,UAAUwF,QAAU,WAAc,OAAO,IAAIwV,EAAY3W,KAAK8W,MAAO9W,KAAK+W,QAASP,IACvFH,EAAI1a,UAAU,cAAgB,WAAc,OAAOqE,KAAKmB,WACxDkV,EAAI1a,UAAU0X,GAAkB,WAAc,OAAOrT,KAAKmB,WAC1DkV,EAAI1a,UAAU2b,MAAQ,SAAUhc,EAAKmc,GASjC,OARIzX,KAAKoX,YAAc9b,IACnB0E,KAAKqX,YAAcrX,KAAK8W,MAAM1T,QAAQpD,KAAKoX,UAAY9b,IAEvD0E,KAAKqX,YAAc,GAAKI,IACxBzX,KAAKqX,YAAcrX,KAAK8W,MAAMtW,OAC9BR,KAAK8W,MAAMlW,KAAKtF,GAChB0E,KAAK+W,QAAQnW,UAAK3E,IAEf+D,KAAKqX,aAEThB,EA9DX,GAh3BwGqB,GAANrB,IAClGsB,EAAQzB,GAA8B,mBAAR0B,KAAuD,mBAA1BA,IAAIjc,UAAUwF,QA27BnD,WAClB,SAASyW,IACL5X,KAAK6X,KAAO,IAAIlF,EAgBpB,OAdAlY,OAAOC,eAAekd,EAAIjc,UAAW,OAAQ,CACzCf,IAAK,WAAc,OAAOoF,KAAK6X,KAAKN,MACpC5c,YAAY,EACZiH,cAAc,IAElBgW,EAAIjc,UAAUqF,IAAM,SAAUhG,GAAS,OAAOgF,KAAK6X,KAAK7W,IAAIhG,IAC5D4c,EAAIjc,UAAUmc,IAAM,SAAU9c,GAAS,OAAOgF,KAAK6X,KAAKhY,IAAI7E,EAAOA,GAAQgF,MAC3E4X,EAAIjc,UAAUkF,OAAS,SAAU7F,GAAS,OAAOgF,KAAK6X,KAAKhX,OAAO7F,IAClE4c,EAAIjc,UAAU6b,MAAQ,WAAcxX,KAAK6X,KAAKL,SAC9CI,EAAIjc,UAAUyF,KAAO,WAAc,OAAOpB,KAAK6X,KAAKzW,QACpDwW,EAAIjc,UAAU0F,OAAS,WAAc,OAAOrB,KAAK6X,KAAKxW,UACtDuW,EAAIjc,UAAUwF,QAAU,WAAc,OAAOnB,KAAK6X,KAAK1W,WACvDyW,EAAIjc,UAAU,cAAgB,WAAc,OAAOqE,KAAKoB,QACxDwW,EAAIjc,UAAU0X,GAAkB,WAAc,OAAOrT,KAAKoB,QACnDwW,EAlBX,GA37BkGA,IAIlGnF,EAAW,IAHCyD,GAAkC,mBAAZ6B,QAg9BtC,WA+BI,SAASC,IACL,IAAI1c,EACJ,GACIA,EAAM,cAAgB2c,UACnBhC,EAAQjV,IAAII,EAAM9F,IAEzB,OADA8F,EAAK9F,IAAO,EACLA,EAEX,SAAS4c,EAAwBnG,EAAQ1W,GACrC,IAAKqa,EAAOxb,KAAK6X,EAAQoG,GAAU,CAC/B,IAAK9c,EACD,OACJZ,OAAOC,eAAeqX,EAAQoG,EAAS,CAAEnd,MAAOib,EAAQ5a,WAE5D,OAAO0W,EAAOoG,GAElB,SAASC,EAAgBC,EAAQd,GAC7B,IAAK,IAAIxd,EAAI,EAAGA,EAAIwd,IAAQxd,EACxBse,EAAOte,GAAqB,IAAhBue,KAAKC,SAAkB,EACvC,OAAOF,EAYX,SAASJ,IACL,IAXoBV,EAWhB7P,GAXgB6P,EAnDR,GAoDc,mBAAfjQ,WACe,oBAAXH,OACAA,OAAOE,gBAAgB,IAAIC,WAAWiQ,IACzB,oBAAbnQ,SACAA,SAASC,gBAAgB,IAAIC,WAAWiQ,IAC5Ca,EAAgB,IAAI9Q,WAAWiQ,GAAOA,GAE1Ca,EAAgB,IAAInS,MAAMsR,GAAOA,IAKxC7P,EAAK,GAAe,GAAVA,EAAK,GAAY,GAC3BA,EAAK,GAAe,IAAVA,EAAK,GAAY,IAE3B,IADA,IAAI4M,EAAS,GACJkE,EAAS,EAAGA,EAnET,KAmE+BA,EAAQ,CAC/C,IAAIC,EAAO/Q,EAAK8Q,GACD,IAAXA,GAA2B,IAAXA,GAA2B,IAAXA,IAChClE,GAAU,KACVmE,EAAO,KACPnE,GAAU,KACdA,GAAUmE,EAAK7Y,SAAS,IAAI8Y,cAEhC,OAAOpE,EA3EX,IACIlT,EAAO6U,EAAQ5a,SACf8c,EAAUH,IACd,OAAsB,WAClB,SAASD,IACL/X,KAAK2Y,KAAOX,IAuBhB,OArBAD,EAAQpc,UAAUqF,IAAM,SAAU+Q,GAC9B,IAAI6G,EAAQV,EAAwBnG,GAAmB,GACvD,YAAiB9V,IAAV2c,GAAsB3C,EAAQjV,IAAI4X,EAAO5Y,KAAK2Y,OAEzDZ,EAAQpc,UAAUf,IAAM,SAAUmX,GAC9B,IAAI6G,EAAQV,EAAwBnG,GAAmB,GACvD,YAAiB9V,IAAV2c,EAAsB3C,EAAQrb,IAAIge,EAAO5Y,KAAK2Y,WAAQ1c,GAEjE8b,EAAQpc,UAAUkE,IAAM,SAAUkS,EAAQ/W,GAGtC,OAFYkd,EAAwBnG,GAAmB,GACjD/R,KAAK2Y,MAAQ3d,EACZgF,MAEX+X,EAAQpc,UAAUkF,OAAS,SAAUkR,GACjC,IAAI6G,EAAQV,EAAwBnG,GAAmB,GACvD,YAAiB9V,IAAV2c,UAA6BA,EAAM5Y,KAAK2Y,OAEnDZ,EAAQpc,UAAU6b,MAAQ,WAEtBxX,KAAK2Y,KAAOX,KAETD,EAzBX,GAp9BqEc,GAAVd,SAgE/D5F,EAAS,YArBT,SAAkB2G,EAAY/G,EAAQgH,EAAajX,GAC/C,GAAK4Q,EAAYqG,GAYZ,CACD,IAAKjE,EAAQgE,GACT,MAAM,IAAIvY,UACd,IAAKwU,EAAchD,GACf,MAAM,IAAIxR,UACd,OAwZR,SAA6BuY,EAAY/G,GACrC,IAAK,IAAIhY,EAAI+e,EAAWtY,OAAS,EAAGzG,GAAK,IAAKA,EAAG,CAC7C,IACIif,GAAYC,EADAH,EAAW/e,IACDgY,GAC1B,IAAKW,EAAYsG,KAAejF,EAAOiF,GAAY,CAC/C,IAAKjE,EAAciE,GACf,MAAM,IAAIzY,UACdwR,EAASiH,GAGjB,OAAOjH,EAlaImH,CAAoBJ,EAAY/G,GAhBvC,IAAK+C,EAAQgE,GACT,MAAM,IAAIvY,UACd,IAAKgT,EAASxB,GACV,MAAM,IAAIxR,UACd,IAAKgT,EAASzR,KAAgB4Q,EAAY5Q,KAAgBiS,EAAOjS,GAC7D,MAAM,IAAIvB,UAId,OAHIwT,EAAOjS,KACPA,OAAa7F,GA6azB,SAA0B6c,EAAY/G,EAAQgH,EAAaI,GACvD,IAAK,IAAIpf,EAAI+e,EAAWtY,OAAS,EAAGzG,GAAK,IAAKA,EAAG,CAC7C,IACIif,GAAYC,EADAH,EAAW/e,IACDgY,EAAQgH,EAAaI,GAC/C,IAAKzG,EAAYsG,KAAejF,EAAOiF,GAAY,CAC/C,IAAKzF,EAASyF,GACV,MAAM,IAAIzY,UACd4Y,EAAaH,GAGrB,OAAOG,EArbIC,CAAiBN,EAAY/G,EADpCgH,EAAcpE,EAAcoE,GAC6BjX,MA+DjEqQ,EAAS,YAVT,SAAkBkH,EAAaC,GAQ3B,OAPA,SAAmBvH,EAAQgH,GACvB,IAAKxF,EAASxB,GACV,MAAM,IAAIxR,UACd,IAAKmS,EAAYqG,KAgoBzB,SAAuBnE,GACnB,OAAQf,EAAKe,IACT,KAAK,EACL,KAAK,EAAgB,OAAO,EAC5B,QAAS,OAAO,GApoBkB2E,CAAcR,GAC5C,MAAM,IAAIxY,UACdyS,EAA0BqG,EAAaC,EAAevH,EAAQgH,OAmDtE5G,EAAS,kBAPT,SAAwBkH,EAAaC,EAAevH,EAAQgH,GACxD,IAAKxF,EAASxB,GACV,MAAM,IAAIxR,UAGd,OAFKmS,EAAYqG,KACbA,EAAcpE,EAAcoE,IACzB/F,EAA0BqG,EAAaC,EAAevH,EAAQgH,MA4CzE5G,EAAS,eAPT,SAAqBkH,EAAatH,EAAQgH,GACtC,IAAKxF,EAASxB,GACV,MAAM,IAAIxR,UAGd,OAFKmS,EAAYqG,KACbA,EAAcpE,EAAcoE,IAqTpC,SAASS,EAAoB1G,EAAaT,EAAGC,GAEzC,GADaO,EAAuBC,EAAaT,EAAGC,GAEhD,OAAO,EACX,IAAI7H,EAAS0K,EAAuB9C,GACpC,OAAK0B,EAAOtJ,IACD+O,EAAoB1G,EAAarI,EAAQ6H,GA1T7CkH,CAAoBH,EAAatH,EAAQgH,MA4CpD5G,EAAS,kBAPT,SAAwBkH,EAAatH,EAAQgH,GACzC,IAAKxF,EAASxB,GACV,MAAM,IAAIxR,UAGd,OAFKmS,EAAYqG,KACbA,EAAcpE,EAAcoE,IACzBlG,EAAuBwG,EAAatH,EAAQgH,MA4CvD5G,EAAS,eAPT,SAAqBkH,EAAatH,EAAQgH,GACtC,IAAKxF,EAASxB,GACV,MAAM,IAAIxR,UAGd,OAFKmS,EAAYqG,KACbA,EAAcpE,EAAcoE,IAoPpC,SAASU,EAAoB3G,EAAaT,EAAGC,GAEzC,GADaO,EAAuBC,EAAaT,EAAGC,GAEhD,OAAOS,EAAuBD,EAAaT,EAAGC,GAClD,IAAI7H,EAAS0K,EAAuB9C,GACpC,OAAK0B,EAAOtJ,QAEZ,EADWgP,EAAoB3G,EAAarI,EAAQ6H,GAzP7CmH,CAAoBJ,EAAatH,EAAQgH,MA4CpD5G,EAAS,kBAPT,SAAwBkH,EAAatH,EAAQgH,GACzC,IAAKxF,EAASxB,GACV,MAAM,IAAIxR,UAGd,OAFKmS,EAAYqG,KACbA,EAAcpE,EAAcoE,IACzBhG,EAAuBsG,EAAatH,EAAQgH,MA2CvD5G,EAAS,mBAPT,SAAyBJ,EAAQgH,GAC7B,IAAKxF,EAASxB,GACV,MAAM,IAAIxR,UAGd,OAFKmS,EAAYqG,KACbA,EAAcpE,EAAcoE,IA0LpC,SAASW,EAAqBrH,EAAGC,GAC7B,IAAIqH,EAAUzG,EAAwBb,EAAGC,GACrC7H,EAAS0K,EAAuB9C,GACpC,GAAe,OAAX5H,EACA,OAAOkP,EACX,IAAIC,EAAaF,EAAqBjP,EAAQ6H,GAC9C,GAAIsH,EAAWpZ,QAAU,EACrB,OAAOmZ,EACX,GAAIA,EAAQnZ,QAAU,EAClB,OAAOoZ,EAGX,IAFA,IAAI/Z,EAAM,IAAI8X,EACVvW,EAAO,GACFyY,EAAK,EAAGC,EAAYH,EAASE,EAAKC,EAAUtZ,OAAQqZ,IAAM,CAElDha,EAAImB,IADb1F,EAAMwe,EAAUD,MAGhBha,EAAIiY,IAAIxc,GACR8F,EAAKR,KAAKtF,IAGlB,IAAK,IAAIye,EAAK,EAAGC,EAAeJ,EAAYG,EAAKC,EAAaxZ,OAAQuZ,IAAM,CACxE,IAAIze,EACSuE,EAAImB,IADb1F,EAAM0e,EAAaD,MAGnBla,EAAIiY,IAAIxc,GACR8F,EAAKR,KAAKtF,IAGlB,OAAO8F,EArNAsY,CAAqB3H,EAAQgH,MA2CxC5G,EAAS,sBAPT,SAA4BJ,EAAQgH,GAChC,IAAKxF,EAASxB,GACV,MAAM,IAAIxR,UAGd,OAFKmS,EAAYqG,KACbA,EAAcpE,EAAcoE,IACzB7F,EAAwBnB,EAAQgH,MAwD3C5G,EAAS,kBAnBT,SAAwBkH,EAAatH,EAAQgH,GACzC,IAAKxF,EAASxB,GACV,MAAM,IAAIxR,UACTmS,EAAYqG,KACbA,EAAcpE,EAAcoE,IAChC,IAAInG,EAAcR,EAAuBL,EAAQgH,GAAwB,GACzE,GAAIrG,EAAYE,GACZ,OAAO,EACX,IAAKA,EAAY/R,OAAOwY,GACpB,OAAO,EACX,GAAIzG,EAAY2E,KAAO,EACnB,OAAO,EACX,IAAI/E,EAAiBC,EAAS7X,IAAImX,GAElC,OADAS,EAAe3R,OAAOkY,GAClBvG,EAAe+E,KAAO,GAE1B9E,EAAS5R,OAAOkR,IADL,KAtffkI,CAAQ9H,GAZZ,GAHJ,CA2lCGN,IAAYA,EAAU,O,wDCnmClB,SAASqI,EAAO/G,EAAKgH,OAEtB,IAAIpgB,KAAKogB,EAAOhH,EAAIpZ,GAAKogB,EAAMpgB,YAU9B,SAASqgB,EAAWC,OACtBC,EAAaD,EAAKC,WAClBA,GAAYA,EAAWC,YAAYF,GCXxC,SAAgBpX,EAAc8C,EAAMoU,EAAOK,GAA3C,IAEElf,EACAmf,EACA1gB,cAHG2gB,EAAkB,OAIjB3gB,KAAKogB,EACA,OAALpgB,EAAYuB,EAAM6e,EAAMpgB,GACd,OAALA,EAAY0gB,EAAMN,EAAMpgB,GAC5B2gB,EAAgB3gB,GAAKogB,EAAMpgB,MAG7BiK,UAAUxD,OAAS,MACtBga,EAAW,CAACA,GAEPzgB,EAAI,EAAGA,EAAIiK,UAAUxD,OAAQzG,IACjCygB,EAAS5Z,KAAKoD,EAAUjK,OAGV,MAAZygB,IACHE,EAAgBF,SAAWA,GAKT,mBAARzU,GAA2C,MAArBA,EAAK4U,iBAChC5gB,KAAKgM,EAAK4U,sBACVD,EAAgB3gB,KACnB2gB,EAAgB3gB,GAAKgM,EAAK4U,aAAa5gB,WAKnC6gB,EAAY7U,EAAM2U,EAAiBpf,EAAKmf,EAAK,MAe9C,SAASG,EAAY7U,EAAMoU,EAAO7e,EAAKmf,EAAKI,OAG5CC,EAAQ,CACb/U,OACAoU,QACA7e,MACAmf,UACW,QACF,SACD,MACF,gBAKIxe,IACE,SACA,KACZsZ,mBAAatZ,IACU,MAAZ4e,IAAqBxe,MAAmBwe,UAG/B,MAAjBxe,EAAQye,OAAeze,EAAQye,MAAMA,GAElCA,EAGR,SAAgBC,UACR,CAAEC,QAAS,MAGZ,SAASC,EAASd,UACjBA,EAAMK,SC9EP,SAASU,EAAUf,EAAOne,QAC3Bme,MAAQA,OACRne,QAAUA,EAyET,SAASmf,EAAcL,EAAOM,MAClB,MAAdA,SAEIN,KACJK,EAAcL,KAAeA,SAAwB1X,QAAQ0X,GAAS,GACtE,aAGAO,EACGD,EAAaN,MAAgBta,OAAQ4a,OAG5B,OAFfC,EAAUP,MAAgBM,KAEa,MAAhBC,aAIfA,YASmB,mBAAdP,EAAM/U,KAAqBoV,EAAcL,GAAS,KAuCjE,SAASQ,EAAwBR,GAAjC,IAGW/gB,EACJwhB,KAHyB,OAA1BT,EAAQA,OAA8C,MAApBA,MAA0B,KAChEA,MAAaA,MAAiBpY,KAAO,KAC5B3I,EAAI,EAAGA,EAAI+gB,MAAgBta,OAAQzG,OAE9B,OADTwhB,EAAQT,MAAgB/gB,KACO,MAAdwhB,MAAoB,CACxCT,MAAaA,MAAiBpY,KAAO6Y,mBAKhCD,EAAwBR,IAoC1B,SAASU,EAAcphB,KAE1BA,QACAA,WACDqhB,EAAc7a,KAAKxG,KAClB+b,SACFuF,IAAiBrf,EAAQsf,sBAEzBD,EAAerf,EAAQsf,oBACNC,GAAOzF,GAK1B,SAASA,YACJ0F,EACI1F,MAAyBsF,EAAcjb,QAC9Cqb,EAAQJ,EAAcha,MAAK,SAACC,EAAGC,UAAMD,UAAkBC,aACvD8Z,EAAgB,GAGhBI,EAAMC,MAAK,YApGb,IAAyBC,EAMnBC,EACEC,EANHnB,EACHoB,EACAC,EAkGK/hB,QAnGL8hB,GADGpB,GADoBiB,EAqGQ3hB,aAlG/B+hB,EAAYJ,SAGRC,EAAc,IACZC,EAAW/B,EAAO,GAAIY,QACPA,MAAkB,EAEvCsB,EACCD,EACArB,EACAmB,EACAF,eACAI,EAAUE,gBACU,MAApBvB,MAA2B,CAACoB,GAAU,KACtCF,EACU,MAAVE,EAAiBf,EAAcL,GAASoB,EACxCpB,OAEDwB,EAAWN,EAAalB,GAEpBA,OAAcoB,GACjBZ,EAAwBR,QCtH3B,SAAgByB,EACfJ,EACAK,EACAC,EACAC,EACAC,EACAC,EACAC,EACAb,EACAE,EACAY,GAVD,IAYK/iB,EAAGgjB,EAAGd,EAAUe,EAAYC,EAAQC,EAAeC,EAInDC,EAAeV,GAAkBA,OAA6BW,EAE9DC,EAAoBF,EAAY5c,WAEpCic,MAA2B,GACtB1iB,EAAI,EAAGA,EAAIyiB,EAAahc,OAAQzG,OA2ClB,OAvCjBijB,EAAaP,MAAyB1iB,GADrB,OAFlBijB,EAAaR,EAAaziB,KAEqB,kBAAdijB,EACW,KAKd,iBAAdA,GAA+C,iBAAdA,EACLpC,EAC1C,KACAoC,EACA,KACA,KACAA,GAES/W,MAAMC,QAAQ8W,GACmBpC,EAC1CK,EACA,CAAET,SAAUwC,GACZ,KACA,KACA,MAESA,MAAoB,EAKapC,EAC1CoC,EAAWjX,KACXiX,EAAW7C,MACX6C,EAAW1hB,IACX,KACA0hB,OAG0CA,OAS5CA,KAAqBP,EACrBO,MAAoBP,MAAwB,EAS9B,QAHdR,EAAWmB,EAAYrjB,KAIrBkiB,GACAe,EAAW1hB,KAAO2gB,EAAS3gB,KAC3B0hB,EAAWjX,OAASkW,EAASlW,KAE9BqX,EAAYrjB,eAAKkC,IAIZ8gB,EAAI,EAAGA,EAAIO,EAAmBP,IAAK,KACvCd,EAAWmB,EAAYL,KAKtBC,EAAW1hB,KAAO2gB,EAAS3gB,KAC3B0hB,EAAWjX,OAASkW,EAASlW,KAC5B,CACDqX,EAAYL,UAAK9gB,MAGlBggB,EAAW,KAObG,EACCD,EACAa,EALDf,EAAWA,GAAYsB,EAOtBZ,EACAC,EACAC,EACAb,EACAE,EACAY,GAGDG,EAASD,OAEJD,EAAIC,EAAWvC,MAAQwB,EAASxB,KAAOsC,IACtCI,IAAMA,EAAO,IACdlB,EAASxB,KAAK0C,EAAKvc,KAAKqb,EAASxB,IAAK,KAAMuC,GAChDG,EAAKvc,KAAKmc,EAAGC,OAAyBC,EAAQD,IAGjC,MAAVC,GACkB,MAAjBC,IACHA,EAAgBD,GAIU,mBAAnBD,EAAWjX,MACM,MAAxBiX,OACAA,QAAyBf,MAEzBe,MAAsBd,EAASsB,EAC9BR,EACAd,EACAC,GAGDD,EAASuB,EACRtB,EACAa,EACAf,EACAmB,EACAH,EACAf,GAcGY,GAAuC,WAAxBL,EAAe1W,KAIM,mBAAvB0W,EAAe1W,OAQhC0W,MAA0BP,GAT1BC,EAAUnhB,MAAQ,IAYnBkhB,GACAD,OAAiBC,GACjBA,EAAO5B,YAAc6B,IAIrBD,EAASf,EAAcc,QAIzBQ,MAAsBS,EAGjBnjB,EAAIujB,EAAmBvjB,KACL,MAAlBqjB,EAAYrjB,KAEgB,mBAAvB0iB,EAAe1W,MACC,MAAvBqX,EAAYrjB,QACZqjB,EAAYrjB,QAAW0iB,QAKvBA,MAA0BtB,EAAcuB,EAAgB3iB,EAAI,IAG7D2jB,EAAQN,EAAYrjB,GAAIqjB,EAAYrjB,QAKlCojB,MACEpjB,EAAI,EAAGA,EAAIojB,EAAK3c,OAAQzG,IAC5B4jB,EAASR,EAAKpjB,GAAIojB,IAAOpjB,GAAIojB,IAAOpjB,IAKvC,SAASyjB,EAAgBR,EAAYd,EAAQC,GAA7C,IACUyB,EACJ9C,MADI8C,EAAM,EAAGA,EAAMZ,MAAqBxc,OAAQod,KAChD9C,EAAQkC,MAAqBY,MAMhC9C,KAAgBkC,EAGfd,EADwB,mBAAdpB,EAAM/U,KACPyX,EAAgB1C,EAAOoB,EAAQC,GAE/BsB,EACRtB,EACArB,EACAA,EACAkC,MACAlC,MACAoB,WAMGA,EASD,SAAS2B,EAAarD,EAAUsD,UACtCA,EAAMA,GAAO,GACG,MAAZtD,GAAuC,kBAAZA,IACpBvU,MAAMC,QAAQsU,GACxBA,EAASsB,MAAK,YACb+B,EAAatC,EAAOuC,MAGrBA,EAAIld,KAAK4Z,IAEHsD,EAGR,SAASL,EACRtB,EACAa,EACAf,EACAmB,EACAH,EACAf,GAND,IAQK6B,EAuBGC,EAAiBjB,cAtBpBC,MAIHe,EAAUf,MAMVA,kBACM,GACM,MAAZf,GACAgB,GAAUf,GACW,MAArBe,EAAO3C,WAEP2D,EAAO,GAAc,MAAV/B,GAAkBA,EAAO5B,aAAe6B,EAClDA,EAAUhZ,YAAY8Z,GACtBc,EAAU,SACJ,KAGDC,EAAS9B,EAAQa,EAAI,GACxBiB,EAASA,EAAOE,cAAgBnB,EAAIK,EAAY5c,OACjDuc,GAAK,KAEDiB,GAAUf,QACPgB,EAGR9B,EAAUgC,aAAalB,EAAQf,GAC/B6B,EAAU7B,kBAOR6B,EACMA,EAEAd,EAAOiB,YC9SlB,SAASE,EAASC,EAAO/iB,EAAKN,GACd,MAAXM,EAAI,GACP+iB,EAAMC,YAAYhjB,EAAKN,GAEvBqjB,EAAM/iB,GADa,MAATN,EACG,GACa,iBAATA,GAAqBujB,EAAmB9a,KAAKnI,GACjDN,EAEAA,EAAQ,KAYhB,SAASsjB,EAAYE,EAAKlkB,EAAMU,EAAOyjB,EAAU7B,GAAjD,IACF8B,EAEJlkB,EAAG,GAAa,UAATF,KACc,iBAATU,EACVwjB,EAAIH,MAAMM,QAAU3jB,MACd,IACiB,iBAAZyjB,IACVD,EAAIH,MAAMM,QAAUF,EAAW,IAG5BA,MACEnkB,KAAQmkB,EACNzjB,GAASV,KAAQU,GACtBojB,EAASI,EAAIH,MAAO/jB,EAAM,OAKzBU,MACEV,KAAQU,EACPyjB,GAAYzjB,EAAMV,KAAUmkB,EAASnkB,IACzC8jB,EAASI,EAAIH,MAAO/jB,EAAMU,EAAMV,SAOhC,GAAgB,MAAZA,EAAK,IAA0B,MAAZA,EAAK,GAChCokB,EAAapkB,KAAUA,EAAOA,EAAKiF,QAAQ,WAAY,KAGxBjF,EAA3BA,EAAKoe,gBAAiB8F,EAAYlkB,EAAKoe,cAAc3X,MAAM,GACnDzG,EAAKyG,MAAM,GAElByd,EAAII,IAAYJ,EAAII,EAAa,IACtCJ,EAAII,EAAWtkB,EAAOokB,GAAc1jB,EAEhCA,EACEyjB,GAEJD,EAAIxV,iBAAiB1O,EADLokB,EAAaG,EAAoBC,EACbJ,GAIrCF,EAAI1X,oBAAoBxM,EADRokB,EAAaG,EAAoBC,EACVJ,QAElC,GAAa,4BAATpkB,EAAoC,IAC1CsiB,EAIHtiB,EAAOA,EAAKiF,QAAQ,aAAc,KAAKA,QAAQ,SAAU,UACnD,GACG,SAATjF,GACS,SAATA,GACS,SAATA,GACS,aAATA,GACAA,KAAQkkB,MAGPA,EAAIlkB,GAAiB,MAATU,EAAgB,GAAKA,QAE3BR,EACL,MAAOiE,IAUW,mBAAVzD,IAGD,MAATA,SACCA,GAAgC,MAAZV,EAAK,IAA0B,MAAZA,EAAK,IAE7CkkB,EAAIO,aAAazkB,EAAMU,GAEvBwjB,EAAIQ,gBAAgB1kB,KAUvB,SAASwkB,EAAWrgB,QACdmgB,EAAWngB,EAAEsH,SAAc1J,EAAQuJ,MAAQvJ,EAAQuJ,MAAMnH,GAAKA,GAGpE,SAASogB,EAAkBpgB,QACrBmgB,EAAWngB,EAAEsH,SAAa1J,EAAQuJ,MAAQvJ,EAAQuJ,MAAMnH,GAAKA,GCjInE,SAAgB2d,EACfD,EACA8C,EACAhD,EACAU,EACAC,EACAC,EACAb,EACAE,EACAY,GATD,IAWKc,EAoBExjB,EAAG8kB,EAAOC,EAAUC,EAAUC,EAAUC,EACxCC,EAKAC,EACAC,EAkIAjD,EA5JLkD,EAAUT,EAASlZ,iBAIhBkZ,EAAS1J,YAA2B,OAAO,KAGpB,MAAvB0G,QACHa,EAAcb,MACdC,EAAS+C,MAAgBhD,MAEzBgD,MAAsB,KACtBpC,EAAoB,CAACX,KAGjB0B,EAAMvhB,QAAgBuhB,EAAIqB,OAG9BhB,EAAO,GAAsB,mBAAXyB,EAAuB,IAEpCH,EAAWN,EAAS9E,MAKpBqF,GADJ5B,EAAM8B,EAAQC,cACQhD,EAAciB,OAChC6B,EAAmB7B,EACpB4B,EACCA,EAASrF,MAAMnf,MACf4iB,KACDjB,EAGCV,MAEHqD,GADAllB,EAAI6kB,MAAsBhD,UAC0B7hB,OAGhD,cAAeslB,GAAWA,EAAQ/jB,UAAUikB,OAE/CX,MAAsB7kB,EAAI,IAAIslB,EAAQH,EAAUE,IAGhDR,MAAsB7kB,EAAI,IAAI8gB,EAAUqE,EAAUE,GAClDrlB,EAAEmb,YAAcmK,EAChBtlB,EAAEwlB,OAASC,GAERL,GAAUA,EAASM,IAAI1lB,GAE3BA,EAAE+f,MAAQoF,EACLnlB,EAAE2lB,QAAO3lB,EAAE2lB,MAAQ,IACxB3lB,EAAE4B,QAAUyjB,EACZrlB,MAAmBuiB,EACnBuC,EAAQ9kB,SACRA,MAAqB,IAIF,MAAhBA,QACHA,MAAeA,EAAE2lB,OAEsB,MAApCL,EAAQM,2BACP5lB,OAAgBA,EAAE2lB,QACrB3lB,MAAe8f,EAAO,GAAI9f,QAG3B8f,EACC9f,MACAslB,EAAQM,yBAAyBT,EAAUnlB,SAI7C+kB,EAAW/kB,EAAE+f,MACbiF,EAAWhlB,EAAE2lB,MAGTb,EAEkC,MAApCQ,EAAQM,0BACgB,MAAxB5lB,EAAE6lB,oBAEF7lB,EAAE6lB,qBAGwB,MAAvB7lB,EAAE8lB,mBACL9lB,MAAmBwG,KAAKxG,EAAE8lB,uBAErB,IAE+B,MAApCR,EAAQM,0BACRT,IAAaJ,GACkB,MAA/B/kB,EAAE+lB,2BAEF/lB,EAAE+lB,0BAA0BZ,EAAUE,IAIpCrlB,OAC0B,MAA3BA,EAAEgmB,4BACFhmB,EAAEgmB,sBACDb,EACAnlB,MACAqlB,IAEFR,QAAuBhD,MACtB,CACD7hB,EAAE+f,MAAQoF,EACVnlB,EAAE2lB,MAAQ3lB,MAEN6kB,QAAuBhD,QAAoB7hB,UAC/CA,MAAW6kB,EACXA,MAAgBhD,MAChBgD,MAAqBhD,MACjB7hB,MAAmBoG,QACtBwb,EAAYpb,KAAKxG,SAGZ6jB,EAGsB,MAAzB7jB,EAAEimB,qBACLjmB,EAAEimB,oBAAoBd,EAAUnlB,MAAcqlB,GAGnB,MAAxBrlB,EAAEkmB,oBACLlmB,MAAmBwG,MAAK,WACvBxG,EAAEkmB,mBAAmBnB,EAAUC,EAAUC,MAK5CjlB,EAAE4B,QAAUyjB,EACZrlB,EAAE+f,MAAQoF,EACVnlB,EAAE2lB,MAAQ3lB,OAELwjB,EAAMvhB,QAAkBuhB,EAAIqB,GAEjC7kB,SACAA,MAAW6kB,EACX7kB,MAAe+hB,EAEfyB,EAAMxjB,EAAEwlB,OAAOxlB,EAAE+f,MAAO/f,EAAE2lB,MAAO3lB,EAAE4B,SAGnC5B,EAAE2lB,MAAQ3lB,MAEe,MAArBA,EAAEmmB,kBACL5D,EAAgBzC,EAAOA,EAAO,GAAIyC,GAAgBviB,EAAEmmB,oBAGhDrB,GAAsC,MAA7B9kB,EAAEomB,0BACfnB,EAAWjlB,EAAEomB,wBAAwBrB,EAAUC,IAK5C5C,EADI,MAAPoB,GAAeA,EAAI7X,OAASkV,GAAuB,MAAX2C,EAAItiB,IACLsiB,EAAIzD,MAAMK,SAAWoD,EAE7DrB,EACCJ,EACAlW,MAAMC,QAAQsW,GAAgBA,EAAe,CAACA,GAC9CyC,EACAhD,EACAU,EACAC,EACAC,EACAb,EACAE,EACAY,GAGD1iB,EAAEsI,KAAOuc,MAGTA,MAAsB,KAElB7kB,MAAmBoG,QACtBwb,EAAYpb,KAAKxG,GAGdklB,IACHllB,MAAkBA,KAAyB,MAG5CA,cAEqB,MAArByiB,GACAoC,QAAuBhD,OAEvBgD,MAAqBhD,MACrBgD,MAAgBhD,OAEhBgD,MAAgBwB,EACfxE,MACAgD,EACAhD,EACAU,EACAC,EACAC,EACAb,EACAc,IAIGc,EAAMvhB,EAAQqkB,SAAS9C,EAAIqB,GAC/B,MAAOxgB,GACRwgB,MAAqB,MAEjBnC,GAAoC,MAArBD,KAClBoC,MAAgB/C,EAChB+C,QAAwBnC,EACxBD,EAAkBA,EAAkBzZ,QAAQ8Y,IAAW,MAIxD7f,MAAoBoC,EAAGwgB,EAAUhD,IAS5B,SAASK,EAAWN,EAAa/J,GACnC5V,OAAiBA,MAAgB4V,EAAM+J,GAE3CA,EAAYF,MAAK,gBAGfE,EAAc5hB,MACdA,MAAqB,GACrB4hB,EAAYF,MAAK,YAEhB3T,EAAGjO,KAAKE,MAER,MAAOqE,GACRpC,MAAoBoC,EAAGrE,WAmB1B,SAASqmB,EACRjC,EACAS,EACAhD,EACAU,EACAC,EACAC,EACAb,EACAc,GARD,IAoBSvB,EAuDHoF,EACAC,EASO7mB,EA3ERolB,EAAWlD,EAAS9B,MACpBoF,EAAWN,EAAS9E,MACpB0G,EAAW5B,EAASlZ,KACpBhM,EAAI,KAGS,QAAb8mB,IAAoBjE,MAEC,MAArBC,OACI9iB,EAAI8iB,EAAkBrc,OAAQzG,QAC9BwhB,EAAQsB,EAAkB9iB,MAO9BwhB,IAAUiD,IACTqC,EAAWtF,EAAMuF,WAAaD,EAA6B,GAAlBtF,EAAMsF,WAChD,CACDrC,EAAMjD,EACNsB,EAAkB9iB,GAAK,cAMf,MAAPykB,EAAa,IACC,OAAbqC,SAEIhe,SAASke,eAAexB,GAI/Bf,EADG5B,EACG/Z,SAASme,gBACd,6BAEAH,GAGKhe,SAASI,cAEd4d,EACAtB,EAAS0B,IAAM1B,GAKjB1C,EAAoB,KAEpBC,KAAc,GAGE,OAAb+D,EAEC1B,IAAaI,GAAczC,GAAe0B,EAAI9W,OAAS6X,IAC1Df,EAAI9W,KAAO6X,OAEN,IAEN1C,EACCA,GAAqBQ,EAAUtc,MAAM7G,KAAKskB,EAAI0C,YAI3CP,GAFJxB,EAAWlD,EAAS9B,OAASoD,GAEN4D,wBACnBP,EAAUrB,EAAS4B,yBAIlBrE,EAAa,IAGQ,MAArBD,MACHsC,EAAW,GACFplB,EAAI,EAAGA,EAAIykB,EAAI1c,WAAWtB,OAAQzG,IAC1ColB,EAASX,EAAI1c,WAAW/H,GAAGO,MAAQkkB,EAAI1c,WAAW/H,GAAGiB,OAInD4lB,GAAWD,KAGZC,IACED,GAAWC,UAAkBD,UAC/BC,WAAmBpC,EAAI4C,aAExB5C,EAAI4C,UAAaR,GAAWA,UAAmB,QDzX7C,SAAmBpC,EAAKe,EAAUJ,EAAUvC,EAAOyE,OACrDtnB,MAECA,KAAKolB,EACC,aAANplB,GAA0B,QAANA,GAAiBA,KAAKwlB,GAC7CjB,EAAYE,EAAKzkB,EAAG,KAAMolB,EAASplB,GAAI6iB,OAIpC7iB,KAAKwlB,EAEN8B,GAAiC,mBAAf9B,EAASxlB,IACvB,aAANA,GACM,QAANA,GACM,UAANA,GACM,YAANA,GACAolB,EAASplB,KAAOwlB,EAASxlB,IAEzBukB,EAAYE,EAAKzkB,EAAGwlB,EAASxlB,GAAIolB,EAASplB,GAAI6iB,GC4W/C0E,CAAU9C,EAAKe,EAAUJ,EAAUvC,EAAOE,GAGtC8D,EACH3B,MAAqB,WAErBllB,EAAIklB,EAAS9E,MAAMK,SACnB+B,EACCiC,EACAvY,MAAMC,QAAQnM,GAAKA,EAAI,CAACA,GACxBklB,EACAhD,EACAU,EACAC,GAAsB,kBAAbiE,EACThE,EACAb,EACAwC,EAAI+C,WACJzE,GAIwB,MAArBD,MACE9iB,EAAI8iB,EAAkBrc,OAAQzG,KACN,MAAxB8iB,EAAkB9iB,IAAYqgB,EAAWyC,EAAkB9iB,IAM7D+iB,IAEH,UAAWyC,aACVxlB,EAAIwlB,EAASvkB,SAKbjB,IAAMykB,EAAIxjB,OAAuB,aAAb6lB,IAA4B9mB,IAEjDukB,EAAYE,EAAK,QAASzkB,EAAGolB,EAASnkB,UAGtC,YAAaukB,aACZxlB,EAAIwlB,EAASiC,UACdznB,IAAMykB,EAAIgD,SAEVlD,EAAYE,EAAK,UAAWzkB,EAAGolB,EAASqC,aAAS,OAK7ChD,EASR,SAAgBb,EAASlD,EAAKzf,EAAO8f,OAEjB,mBAAPL,EAAmBA,EAAIzf,GAC7Byf,EAAIO,QAAUhgB,EAClB,MAAOyD,GACRpC,MAAoBoC,EAAGqc,IAYzB,SAAgB4C,EAAQ5C,EAAO2G,EAAaC,GAA5C,IACK7mB,EAOA2jB,EAsBMzkB,KA5BNsC,EAAQqhB,SAASrhB,EAAQqhB,QAAQ5C,IAEhCjgB,EAAIigB,EAAML,OACT5f,EAAEmgB,SAAWngB,EAAEmgB,UAAYF,OAAY6C,EAAS9iB,EAAG,KAAM4mB,IAI1DC,GAAmC,mBAAd5G,EAAM/U,OAC/B2b,EAAmC,OAArBlD,EAAM1D,QAKrBA,MAAaA,aAEiB,OAAzBjgB,EAAIigB,OAA2B,IAC/BjgB,EAAE8mB,yBAEJ9mB,EAAE8mB,uBACD,MAAOljB,GACRpC,MAAoBoC,EAAGgjB,GAIzB5mB,EAAE6H,KAAO7H,MAAe,QAGpBA,EAAIigB,UACC/gB,EAAI,EAAGA,EAAIc,EAAE2F,OAAQzG,IACzBc,EAAEd,IAAI2jB,EAAQ7iB,EAAEd,GAAI0nB,EAAaC,GAI5B,MAAPlD,GAAapE,EAAWoE,GAI7B,SAASqB,EAAS1F,EAAO4F,EAAO/jB,UACxBgE,KAAKuV,YAAY4E,EAAOne,GClfhC,SAAgB4jB,EAAO9E,EAAOqB,EAAWyF,GAAzC,IAMK9E,EAOAb,EAUAD,EAtBA3f,MAAeA,KAAcye,EAAOqB,GAYpCF,GAPAa,EAAqC,mBAAhB8E,GAQtB,KACCA,GAAeA,OAA0BzF,MAQzCH,EAAc,GAClBI,EACCD,EARDrB,IACGgC,GAAe8E,GACjBzF,OACalZ,EAAcgY,EAAU,KAAM,CAACH,IAS5CmB,GAAYsB,EACZA,WACApB,EAAUE,iBACTS,GAAe8E,EACb,CAACA,GACD3F,EACA,KACAE,EAAUoF,WACVlE,EAAUtc,MAAM7G,KAAKiiB,EAAU+E,YAC/B,KACHlF,GACCc,GAAe8E,EACbA,EACA3F,EACAA,MACAE,EAAUoF,WACbzE,GAIDR,EAAWN,EAAalB,GASlB,SAASuG,EAAQvG,EAAOqB,GAC9ByD,EAAO9E,EAAOqB,EAAWkF,GC9D1B,SAAgBQ,EAAa/G,EAAOX,EAAOK,GAA3C,IAEElf,EACAmf,EACA1gB,cAHG2gB,EAAkBR,EAAO,GAAIY,EAAMX,WAIlCpgB,KAAKogB,EACA,OAALpgB,EAAYuB,EAAM6e,EAAMpgB,GACd,OAALA,EAAY0gB,EAAMN,EAAMpgB,GAC5B2gB,EAAgB3gB,GAAKogB,EAAMpgB,MAG7BiK,UAAUxD,OAAS,MACtBga,EAAW,CAACA,GACPzgB,EAAI,EAAGA,EAAIiK,UAAUxD,OAAQzG,IACjCygB,EAAS5Z,KAAKoD,EAAUjK,WAGV,MAAZygB,IACHE,EAAgBF,SAAWA,GAGrBI,EACNE,EAAM/U,KACN2U,EACApf,GAAOwf,EAAMxf,IACbmf,GAAOK,EAAML,IACb,MChCK,SAASqH,EAAcC,EAAcC,OAGrChmB,EAAU,KAFhBgmB,EAAY,OAASjoB,OAILgoB,EAEfE,kBAAS9H,EAAO+H,UAIR/H,EAAMK,SAAS0H,IAGvBC,kBAAShI,OAEHiI,EACAC,SAFAriB,KAAKugB,kBACL6B,EAAO,IACPC,EAAM,IACNL,GAAahiB,UAEZugB,gBAAkB,kBAAM8B,QAExBjC,sBAAwB,SAASkC,GACjCtiB,KAAKma,MAAMnf,QAAUsnB,EAAOtnB,OAe/BonB,EAAKtG,KAAKN,SAIPsE,IAAM,YACVsC,EAAKxhB,KAAKxG,OACNmoB,EAAMnoB,EAAEunB,qBACZvnB,EAAEunB,qBAAuB,WACxBS,EAAKI,OAAOJ,EAAKhf,QAAQhJ,GAAI,GACzBmoB,GAAKA,EAAIroB,KAAKE,MAKd+f,EAAMK,kBAUPxe,EAAQmmB,YAAuBnmB,EAAQimB,SAAStC,YAAc3jB,EClEhE,sgBCWDK,ETuFOomB,ECwEThH,EAQEG,EAcFF,EM9LO3hB,ECFEwjB,EAAY,GACZF,EAAY,GACZkB,EAAqB,oECS5BliB,EAAU,KCJT,SAAqByC,EAAOgc,WAE9BiB,EAAW2G,EAAMC,EAEb7H,EAAQA,UACViB,EAAYjB,SAAsBiB,aAErC2G,EAAO3G,EAAUxG,cAE4B,MAAjCmN,EAAKE,2BAChB7G,EAAU8G,SAASH,EAAKE,yBAAyB9jB,IACjD6jB,EAAU5G,OAGwB,MAA/BA,EAAU+G,oBACb/G,EAAU+G,kBAAkBhkB,GAC5B6jB,EAAU5G,OAIP4G,SACK5G,MAA0BA,EAElC,MAAOtd,GACRK,EAAQL,QAKLK,ODvBI,GTqFE2jB,EAAiB,mBACpB,MAAT3H,YAAiBA,EAAMvF,aCzExB2F,EAAUvf,UAAUknB,SAAW,SAASE,EAAQ9hB,OAE3CnF,EAEHA,EADsB,MAAnBkE,KAAKA,KAAsBA,KAAKA,MAAeA,KAAK+f,MACnD/f,KAAKA,IAELA,KAAKA,IAAaka,EAAO,GAAIla,KAAK+f,OAGlB,mBAAVgD,IAGVA,EAASA,EAAO7I,EAAO,GAAIpe,GAAIkE,KAAKma,QAGjC4I,GACH7I,EAAOpe,EAAGinB,GAIG,MAAVA,GAEA/iB,KAAKA,MACJiB,GAAUjB,KAAKA,IAAiBY,KAAKK,GACzCua,EAAcxb,QAUhBkb,EAAUvf,UAAUqnB,YAAc,SAAS/hB,GACtCjB,uBAKCiB,GAAUjB,KAAKA,IAAiBY,KAAKK,GACzCua,EAAcxb,QAchBkb,EAAUvf,UAAUikB,OAAS3E,EAyFzBQ,EAAgB,GAQdG,EACa,mBAAX9d,QACJA,QAAQnC,UAAUgP,KAAKpP,KAAKuC,QAAQC,WACpCwI,WA2CJ4P,MAAyB,EM9Ndpc,EAAI,G,kCIFf,uBAGA,MAAM,EAAE8U,EAAF,OAAK+Q,EAAL,QAAayB,GAAY4B,EAEzBC,EAAiB/oB,GAAMA,GAAKA,EAAEgpB,QAAUhpB,EAAEgpB,QAAUhpB,EA2B1D,GATiC,kBAAmBipB,WAEnDA,UAAUC,cAAcC,SACvBC,IAAkD,aAMjC,mBAFTL,EAAeM,EAAQ,SAEF,CAC9B,IAAIvR,EACHpP,SAAS4gB,eAAe,gBAAkB5gB,SAASU,KAAKmgB,kBA4BrD5pB,EA1BO,MACV,IAAI6pB,EAAMT,EAAeM,EAAQ,SAC7BI,EAAgB,GACpB,MAAMC,EAAoBhhB,SAASihB,cAClC,gCAEGD,IACHD,EACCG,KAAKC,MAAMC,UAAUJ,EAAkBzC,YAAYwC,eACnDA,GAOiBA,EAAcnhB,MA7CdA,EA6CiCmhB,EAAcnhB,KA7C/CA,MAoDnBwP,EADwC2N,EACxB/Q,EAAE8U,EAAK,CAAEO,SARR,CAAEN,mBAQmB/gB,SAASU,KAAM0O,IAKtDxU,K,iBChED,IAAI0mB,EAGJA,EAAK,WACJ,OAAOnkB,KADH,GAIL,IAECmkB,EAAIA,GAAK,IAAIjS,SAAS,cAAb,GACR,MAAOzT,GAEc,iBAAXuD,SAAqBmiB,EAAIniB,QAOrClI,EAAOD,QAAUsqB,G,kCClBjB,SAASxd,IACL,OAAOyd,ICDJ,SAASC,EAAwBvlB,GACpC,OAAQA,aAAiBwlB,YCuDD,qCDtDpBxlB,EAAMgH,QEFd,SAASye,EAA6BC,GAClC,MAAiC,mBAAtBA,EACkBA,EACClqB,KAEQ,iBAAtBkqB,EACLA,EAAkB5kB,WAGA4kB,EAIjC,SAASC,EAA2CC,EAAWF,EAAmBG,GAC9E,IAAIC,EAAyB,GACzBC,EAAqBF,EAAYD,EAAWF,GAchD,OAbkC,IAA9BK,EAAmBrkB,SACnBokB,EAAyB,yBACzBC,EAAmBxkB,SAAQ,SAAUykB,GACjC,IAAIxqB,EAAO,SACwB,OAA/BwqB,EAAQC,qBACRzqB,EAAO0qB,EAAgBF,EAAQC,qBAEnCH,EAAyBA,EAAyB,MAAQtqB,EACtDwqB,EAAQG,WAAWC,WACnBN,EAAyBA,EAAyB,MAAQE,EAAQG,WAAWC,cAIlFN,EA0BX,SAASO,EAA8B/mB,GACnCA,EAAQgnB,cAAc/kB,SAAQ,SAAUglB,GACpC,GA1BR,SAASC,EAAuBlnB,EAASomB,GACrC,OAA8B,OAA1BpmB,EAAQmnB,gBAGHnnB,EAAQmnB,cAAcf,oBAAsBA,GAI1Cc,EAAuBlnB,EAAQmnB,cAAef,IAkBjDc,CAAuBD,EAAcA,EAAab,mBAAoB,CACtE,IAAIgB,EAhBhB,SAAiCpnB,GAW7B,OAVA,SAASqnB,EAAiBC,EAAKpR,QACZ,IAAXA,IAAqBA,EAAS,IAClC,IAAIkQ,EAAoBD,EAA6BmB,EAAIlB,mBAEzD,OADAlQ,EAAO1T,KAAK4jB,GACc,OAAtBkB,EAAIH,cACGE,EAAiBC,EAAIH,cAAejR,GAExCA,EAEKmR,CAAiBrnB,GAChBunB,UAAUpkB,KAAK,YAKTqkB,CAAwBP,GACvC,MAAM,IAAI/nB,MAAMuoB,8BAAuCL,GAGvDL,EAA8BE,MAuB1C,SAASL,EAAgBc,GACrB,GAAIA,EAAExrB,KACF,OAAOwrB,EAAExrB,KAGT,IAAIyrB,EAASD,EAAElmB,WACXomB,EAAQD,EAAOC,MAAM,yBACzB,OAAOA,EAAQA,EAAM,GAAK,uBAAyBD,EC3E3D,SAASE,EAAWC,EAAgBC,EAAiBlR,EAAMmR,GACvD,IAAIC,EAAWH,EAAeI,uBAAuBrR,GACjDsR,EAAqBF,EAASG,0BAClC,QAA2BvqB,IAAvBsqB,EAEA,MAAM,IAAIjpB,MADAuoB,+CAAiDM,EAAkB,KAGjF,IAAIM,EAA0BJ,EAASK,sBACnCtlB,EAAO3G,OAAO2G,KAAKqlB,GAGnBE,EA8BR,SAAqCP,EAAaD,EAAiBI,EAAoBE,EAAyBG,GAE5G,IADA,IAAIC,EAAU,GACL9sB,EAAI,EAAGA,EAAI6sB,EAAY7sB,IAAK,CACjC,IACIgY,EAAS+U,EADD/sB,EACmCqsB,EAAaD,EAAiBI,EAAoBE,GAClF,OAAX1U,GACA8U,EAAQjmB,KAAKmR,GAGrB,OAAO8U,EAvCkBE,CAA4BX,EAAaD,EAAiBI,EAAoBE,EAF/C,IAAhBxR,EAAKzU,QAAgBY,EAAKZ,OAAS,EACrBY,EAAKZ,OAASyU,EAAKzU,QAErEwmB,EAwCR,SAASC,EAAuBf,EAAgBgB,GAI5C,IAHA,IAAIC,EAAqBjB,EAAekB,sBAAsBF,GAC1DL,EAAU,GACVzlB,EAAO3G,OAAO2G,KAAK+lB,GACdtN,EAAK,EAAGwN,EAASjmB,EAAMyY,EAAKwN,EAAO7mB,OAAQqZ,IAAM,CACtD,IAAIve,EAAM+rB,EAAOxN,GACbrH,EAAiB2U,EAAmB7rB,GACpC+qB,EAAWiB,EAAqBH,EAAmB7rB,IAGnDyW,EAAS,IAAIwV,GAAOC,EAFPnB,EAASoB,YAAcnsB,EACf+qB,EAASqB,QAAUrB,EAASsB,aAErD5V,EAAOsU,SAAW7T,EAClBqU,EAAQjmB,KAAKmR,GAEjB,IAAI6V,EAAkBntB,OAAO2a,eAAe8R,EAAgBvrB,WAAW4Z,YACvE,GAAIqS,IAAoBntB,OAAQ,CAC5B,IAAIotB,EAAcZ,EAAuBf,EAAgB0B,GACzDf,EAAUiB,GAAejB,EAASgB,GAEtC,OAAOhB,EA3DeI,CAAuBf,EAAgBjR,GAE7D,OADc6S,GAAenB,EAAoBK,GAGrD,SAASF,EAA2B7P,EAAOmP,EAAaD,EAAiBI,EAAoBE,GACzF,IAAIjU,EAAiBiU,EAAwBxP,EAAMrX,aAAe,GAC9DymB,EAAWiB,EAAqB9U,GAChCuV,GAAmC,IAAvB1B,EAAS2B,UACrBxD,EAAoB+B,EAAmBtP,GACvCgR,EAAoB5B,EAASqB,QAAUrB,EAASsB,YAKpD,IAJAnD,EAAqByD,GAAyCzD,aAC7B0D,KAC7B1D,EAAoBA,EAAkB2D,UAEtCJ,EAAW,CAKX,IAAK3B,IAJU5B,IAAsB/pB,QACpB+pB,IAAsBtS,eACCjW,IAAtBuoB,GAId,MAAM,IAAIlnB,MADAuoB,oEAAsD5O,EAAQ,aAAekP,EAAkB,KAG7G,IAAIpU,EAAS,IAAIwV,GAAOC,EAAoCnB,EAASoB,WAAYjD,GAEjF,OADAzS,EAAOsU,SAAW7T,EACXT,EAEX,OAAO,KAyDX,SAASuV,EAAqB9U,GAC1B,IAAI4V,EAAoB,GAIxB,OAHA5V,EAAenS,SAAQ,SAAUlG,GAC7BiuB,EAAkBjuB,EAAEmB,IAAIsE,YAAczF,EAAEa,SAErC,CACH0sB,OAAQU,EAAkBC,GAC1BV,YAAaS,EAAkBC,GAC/BZ,WAAYW,EAAkBC,GAC9BL,UAAWI,EAAkBC,IC/GrC,SAASC,EAAqBC,GAC1B,OAAOA,EAAMC,mBAYjB,SAASC,EAAmBvC,EAAgBwC,EAAkB1sB,EAASupB,EAAexT,GAClF,IAAI4W,EAAWhE,EAAY3oB,EAAQ0oB,UAAW3S,EAAOyS,mBACjDoE,EAAiB,GAkBrB,OAjBID,EAASnoB,SAAWqoB,IACpB7sB,EAAQ0oB,UAAUroB,QAAQysB,oBACU,mBAA7B/W,EAAOyS,mBACd0B,EAAeI,uBAAuBvU,EAAOyS,mBAAmBgC,4BAChExqB,EAAQ0oB,UAAUnpB,KAAKwW,EAAOyS,mBAAmBuE,SACjDJ,EAAWhE,EAAY3oB,EAAQ0oB,UAAW3S,EAAOyS,oBASjDoE,EAPCF,EAOgBC,EANAA,EAASK,QAAO,SAAUlE,GACvC,IAAI1mB,EAAU,IAAI6qB,GAAQnE,EAAQN,kBAAmBxoB,EAASupB,EAAeT,EAAS/S,GACtF,OAAO+S,EAAQG,WAAW7mB,MAStC,SAAqComB,EAAmBmE,EAAU5W,EAAQ2S,GACtE,OAAQiE,EAASnoB,QACb,KAAKqoB,GACD,GAAI9W,EAAOmX,aACP,OAAOP,EAGP,IAAIQ,EAA0B5E,EAA6BC,GACvD4E,EHjDQ,oDGoDZ,MAFAA,GFWhB,SAA+BD,EAAyBpX,GACpD,GAAIA,EAAOsX,YAActX,EAAOuX,UAAW,CACvC,IAAIC,EAAM,GACNC,EAAWzX,EAAO0X,cAClBC,EAAY3X,EAAO4X,gBASvB,OARiB,OAAbH,IACAD,GAAOC,EAAS5pB,WAAa,MAEf,OAAd8pB,GACAA,EAAUrpB,SAAQ,SAAUupB,GACxBL,GAAOK,EAAIhqB,WAAa,QAGzB,IAAMupB,EAA0B,MAAQA,EAA0B,MAAQI,EAGjF,MAAO,IAAMJ,EE3BEU,CAAsBV,EAAyBpX,GACtDqX,GAAO3E,EAA2CC,EAAWyE,EAAyBxE,GAChF,IAAIrnB,MAAM8rB,GAExB,KAAKP,GACD,IAAK9W,EAAO7L,UACR,OAAOyiB,EAEf,KAAKE,EACL,QACI,GAAK9W,EAAO7L,UAOR,OAAOyiB,EALHS,EAAMvD,iDADNsD,EAA0B5E,EAA6BC,IAG3D,MADA4E,GAAO3E,EAA2CC,EAAWyE,EAAyBxE,GAChF,IAAIrnB,MAAM8rB,IA1B5BU,CAA4B/X,EAAOyS,kBAAmBoE,EAAgB7W,EAAQ/V,EAAQ0oB,WAC/EkE,EAgCX,SAASmB,EAAmB7D,EAAgBwC,EAAkBlE,EAAmBxoB,EAASupB,EAAexT,GACrG,IAAI6W,EACAvD,EACJ,GAAsB,OAAlBE,EAAwB,CACxBqD,EAAiBH,EAAmBvC,EAAgBwC,EAAkB1sB,EAAS,KAAM+V,GACrFsT,EAAe,IAAI4D,GAAQzE,EAAmBxoB,EAAS,KAAM4sB,EAAgB7W,GAC7E,IAAIiY,EAAU,IAAIC,GAAKjuB,EAASqpB,GAChCrpB,EAAQkuB,QAAQF,QAGhBpB,EAAiBH,EAAmBvC,EAAgBwC,EAAkB1sB,EAASupB,EAAexT,GAC9FsT,EAAeE,EAAc4E,gBAAgBpY,EAAOyS,kBAAmBoE,EAAgB7W,GAE3F6W,EAAevoB,SAAQ,SAAUykB,GAC7B,IAAIsF,EAAkB,KACtB,GAAIrY,EAAO7L,UACPkkB,EAAkB/E,EAAa8E,gBAAgBrF,EAAQN,kBAAmBM,EAAS/S,OAElF,CACD,GAAI+S,EAAQuF,MACR,OAEJD,EAAkB/E,EAEtB,GAAIP,EAAQ/e,OAASukB,GAA2D,OAA/BxF,EAAQC,mBAA6B,CAClF,IAAIwF,EDzFhB,SAAyBrE,EAAgBjR,GAGrC,OADcgR,EAAWC,EADHlB,EAAgB/P,GACoBA,GAAM,GCuFrCuV,CAAgBtE,EAAgBpB,EAAQC,oBAC3D,IAAK/oB,EAAQ0oB,UAAUroB,QAAQouB,oBAAqB,CAChD,IAAIC,EDbpB,SAASC,EAA4BzE,EAAgBjR,GACjD,IAAI2S,EAAkBntB,OAAO2a,eAAeH,EAAKtZ,WAAW4Z,YAC5D,GAAIqS,IAAoBntB,OAAQ,CAC5B,IACIosB,EAAUZ,EAAWC,EADClB,EAAgB4C,GACoBA,GAAiB,GAC3EvB,EAAWQ,EAAQpb,KAAI,SAAUxQ,GACjC,OAAOA,EAAEorB,SAAS2C,QAAO,SAAU7uB,GAC/B,OAAOA,EAAEmB,MAAQ+sB,QAGrBuC,EAAiB,GAAGC,OAAO9mB,MAAM,GAAIsiB,GAAU7lB,OAC/CsqB,EAAkBjE,EAAQrmB,OAASoqB,EACvC,OAAIE,EAAkB,EACXA,EAGAH,EAA4BzE,EAAgB0B,GAIvD,OAAO,ECPgC+C,CAA4BzE,EAAgBpB,EAAQC,oBACnF,GAAIwF,EAAa/pB,OAASkqB,EAA0B,CAChD,IAAI5rB,EHlFe,WAEnC,IADA,IAAIuC,EAAS,GACJwY,EAAK,EAAGA,EAAK7V,UAAUxD,OAAQqZ,IACpCxY,EAAOwY,GAAM7V,UAAU6V,GAE3B,MAAO,4DACFxY,EAAO,GAAK,0EG4EWwkB,CAAqCb,EAAgBF,EAAQC,qBACzE,MAAM,IAAIznB,MAAMwB,IAGxByrB,EAAalqB,SAAQ,SAAU0qB,GAC3BhB,EAAmB7D,GAAgB,EAAO6E,EAAWvG,kBAAmBxoB,EAASouB,EAAiBW,UAKlH,SAASpG,EAAYD,EAAWF,GAC5B,IAAImE,EAAW,GACXqC,EAAoB1C,EAAqB5D,GAO7C,OANIsG,EAAkBC,OAAOzG,GACzBmE,EAAWqC,EAAkBpwB,IAAI4pB,GAEP,OAArBE,EAAUja,SACfke,EAAWhE,EAAYD,EAAUja,OAAQ+Z,IAEtCmE,EAEX,SAASuC,EAAKhF,EAAgBxB,EAAWyG,EAAeC,EAAY5G,EAAmBlpB,EAAKN,EAAO0tB,QACtE,IAArBA,IAA+BA,GAAmB,GACtD,IAAI1sB,EAAU,IAAIqvB,GAAQ3G,GACtB3S,EAnHR,SAAuBoZ,EAAeC,EAAY5G,EAAmBlqB,EAAMgB,EAAKN,GAC5E,IACIswB,EAAiB,IAAI7Y,GADP0Y,EAAgB9C,EAAgCA,EACnB7D,GAC3CzS,EAAS,IAAIwV,GAAO6D,EAAY9wB,EAAMkqB,EAAmB8G,GAC7D,QAAYrvB,IAARX,EAAmB,CACnB,IAAIiwB,EAAc,IAAI9Y,GAASnX,EAAKN,GACpC+W,EAAOsU,SAASzlB,KAAK2qB,GAEzB,OAAOxZ,EA2GMyZ,CAAcL,EAAeC,EAAY5G,EAAmB,GAAIlpB,EAAKN,GAClF,IAEI,OADA+uB,EAAmB7D,EAAgBwC,EAAkBlE,EAAmBxoB,EAAS,KAAM+V,GAChF/V,EAEX,MAAO8C,GAMH,MALIulB,EAAwBvlB,IACpB9C,EAAQkvB,MACR/F,EAA8BnpB,EAAQkvB,KAAKO,aAG7C3sB,GCvGd,SAAS4sB,EAAgBC,EAAQvG,EAAewG,GAC5C,IAfqBC,EAejBvX,EAAS,KACb,GAAI8Q,EAAc5kB,OAAS,EAAG,CAC1B,IAGIsrB,EAHgC1G,EAAc4D,QAAO,SAAU3D,GAC/D,OAAgC,OAAxBA,EAAatT,QAAmBsT,EAAatT,OAAOhM,OAASyhB,KAEf/b,IAAImgB,GAE9DtX,EApCR,SAA2B9X,EAAU4oB,EAAewG,GAChD,IAAIG,EAA6B3G,EAAc4D,QAAO,SAAU3D,GAC5D,OAAgC,OAAxBA,EAAatT,QACjBsT,EAAatT,OAAOhM,OAASyhB,KAEjCwE,EAAqBD,EAA2BtgB,IAAImgB,GAOxD,OANAG,EAA2B1rB,SAAQ,SAAUxF,EAAGoc,GAC5C,IAAIgV,EACJA,EAAepxB,EAAEkX,OAAOzX,KAAKU,QAE7BwB,EAASyvB,GADOD,EAAmB/U,MAGhCza,EAwBM0vB,CADT5X,EApBG,KADcuX,EAqBQF,GApBZpwB,KAAKwI,MAAM8nB,EAAM/D,GAAe,MAAC,GAoBbgE,KACE1G,EAAewG,QAGlDtX,EAAS,IAAIqX,EAGjB,OAzBJ,SAAwBA,EAAQrX,GAC5B,GAAIzC,QAAQsa,YAAY9D,EAA6BsD,GAAS,CAC1D,IAAIjkB,EAAOmK,QAAQua,YAAY/D,EAA6BsD,GAC5D,IACIrX,EAAO5M,EAAK1M,SAEhB,MAAOyD,GACH,MAAM,IAAInB,MJOY,WAE9B,IADA,IAAI+D,EAAS,GACJwY,EAAK,EAAGA,EAAK7V,UAAUxD,OAAQqZ,IACpCxY,EAAOwY,GAAM7V,UAAU6V,GAE3B,MAAO,iCAAmCxY,EAAO,GAAK,KAAOA,EAAO,GIZ5CgrB,CAAqBV,EAAOrxB,KAAMmE,EAAEqH,YAiB5DwmB,CAAeX,EAAQrX,GAChBA,ECuCX,SAASvW,EAAQ/B,GAEb,OA3EkB,SAAlBuwB,EAA4BC,GAC5B,OAAO,SAAUpuB,GACbA,EAAQquB,cAAcC,kBAAkBtuB,GACxC,IAAIuqB,EAAWvqB,EAAQuqB,SACnBvD,EAAgBhnB,EAAQgnB,cACxBuH,EAAkBvuB,EAAQ2T,QAAU3T,EAAQ2T,OAAO7L,UACnD0mB,IAA4BxuB,EAAQmnB,eACnCnnB,EAAQmnB,cAAcxT,QACtB3T,EAAQ2T,QACR3T,EAAQmnB,cAAcxT,OAAO8a,aAAazuB,EAAQ2T,OAAOyS,oBAC9D,GAAImI,GAAmBC,EACnB,OAAOxH,EAAc3Z,KAAI,SAAU4Z,GAE/B,OADSkH,EAAgBC,EAClBM,CAAGzH,MAId,IAAI/Q,EAAS,KACb,IAAIlW,EAAQ2T,OAAOmX,cAAoC,IAApBP,EAASnoB,OAA5C,CAGA,IAAIusB,EAAYpE,EAAS,GACrBqE,EAAcD,EAAUE,QAAUC,EAClCC,EAAqBJ,EAAUE,QAAUC,EAC7C,GAAIF,GAAeD,EAAUK,UACzB,OAAOL,EAAU1C,MAErB,GAAI8C,GACiB,OAAjBX,GACAA,EAAaxrB,IAAI+rB,EAAUpmB,IAC3B,OAAO6lB,EAAa5xB,IAAImyB,EAAUpmB,IAEtC,GAAIomB,EAAUhnB,OAASukB,EACnBhW,EAASyY,EAAU1C,WAElB,GAAI0C,EAAUhnB,OAASukB,EACxBhW,EAASyY,EAAU1C,WAElB,GAAI0C,EAAUhnB,OAASukB,EACxBhW,EAASyY,EAAUhI,wBAElB,GAAIgI,EAAUhnB,OAASukB,GAA2D,OAA3ByC,EAAUM,aAClE/Y,EAASgZ,GAAc,iBAAkBP,EAAUvI,mBAAmB,WAAc,OAAOuI,EAAUM,aAAajvB,EAAQquB,uBAEzH,GAAIM,EAAUhnB,OAASukB,GAAiD,OAAtByC,EAAU9S,QAC7D3F,EAASgZ,GAAc,YAAaP,EAAUvI,mBAAmB,WAAc,OAAOuI,EAAU9S,QAAQ7b,EAAQquB,uBAE/G,GAAIM,EAAUhnB,OAASukB,GAAmD,OAAvByC,EAAUvN,SAC9DlL,EAASgZ,GAAc,aAAcP,EAAUvI,mBAAmB,WAAc,OAAOuI,EAAUvN,SAASphB,EAAQquB,sBAEjH,IAAIM,EAAUhnB,OAASukB,GAA6D,OAAjCyC,EAAUhI,mBAG7D,CACD,IAAIP,EAAoBD,EAA6BnmB,EAAQomB,mBAC7D,MAAM,IAAIlnB,MAAMuoB,yBAAwCrB,GAJxDlQ,EAASoX,EAAgBqB,EAAUhI,mBAAoBK,EAAemH,EAAgBC,IAkB1F,MAZsC,mBAA3BO,EAAUQ,eACjBjZ,EAASyY,EAAUQ,aAAanvB,EAAQquB,cAAenY,IAEvD0Y,IACAD,EAAU1C,MAAQ/V,EAClByY,EAAUK,WAAY,GAEtBD,GACiB,OAAjBX,IACCA,EAAaxrB,IAAI+rB,EAAUpmB,KAC5B6lB,EAAa3sB,IAAIktB,EAAUpmB,GAAI2N,GAE5BA,IAKNiY,CAAgBvwB,EAAQkvB,KAAKO,YAAYe,aAC3CM,CAAG9wB,EAAQkvB,KAAKO,aC5F3B,SAAS+B,EAAa9sB,EAAOpF,EAAKyC,EAAS0vB,GAevChzB,OAAOC,eAAegG,EAAOpF,EAAK,CAC9BsG,cAAc,EACdjH,YAAY,EACZC,IAjBJ,WAII,OAHI6yB,IAAY5b,QAAQsa,YAAYuB,GAAW1tB,KAAM1E,IACjDuW,QAAQ8b,eAAeD,GAAW3vB,IAAWiC,KAAM1E,GAEnDuW,QAAQsa,YAAYuB,GAAW1tB,KAAM1E,GAC9BuW,QAAQua,YAAYsB,GAAW1tB,KAAM1E,GAGrCyC,KAUX8B,IAPJ,SAAgB+tB,GACZ/b,QAAQ8b,eAAeD,GAAWE,EAAQ5tB,KAAM1E,M,+nCCd7CuyB,EAAY,QACZC,EAAW,OACXC,EAAgB,YAChBC,EAAe,WACfC,EAAa,SACbC,EAAmB,eACnBC,EAAS,mBACTC,EAAc,yBACdC,EAAc,uBACdC,EAAqB,oBACrBC,EAAiB,iBCVxBrB,EACS,UADTA,EAEW,YAFXA,EAGW,YAEX5C,EACe,gBADfA,EAEa,cAFbA,EAGc,eAHdA,EAIS,UAJTA,EAKU,WALVA,EAMU,WANVA,EAOS,UAPTA,EAQU,WAEV9C,EACe,gBADfA,EAEqB,sBAFrBA,EAGU,WVlBVpD,EAAY,EWEZoK,EAAW,WACX,SAASA,EAAQhK,EAAmByI,GAChCjtB,KAAK2G,GAAKA,IACV3G,KAAKotB,WAAY,EACjBptB,KAAKwkB,kBAAoBA,EACzBxkB,KAAKitB,MAAQA,EACbjtB,KAAK+F,KAAOukB,EACZtqB,KAAKilB,WAAa,WAAqB,OAAO,GAC9CjlB,KAAK+kB,mBAAqB,KAC1B/kB,KAAKqqB,MAAQ,KACbrqB,KAAKia,QAAU,KACfja,KAAKwf,SAAW,KAChBxf,KAAKutB,aAAe,KACpBvtB,KAAKqtB,aAAe,KAgBxB,OAdAmB,EAAQ7yB,UAAU8yB,MAAQ,WACtB,IAAIA,EAAQ,IAAID,EAAQxuB,KAAKwkB,kBAAmBxkB,KAAKitB,OAWrD,OAVAwB,EAAMrB,WAAY,EAClBqB,EAAM1J,mBAAqB/kB,KAAK+kB,mBAChC0J,EAAMpB,aAAertB,KAAKqtB,aAC1BoB,EAAMxB,MAAQjtB,KAAKitB,MACnBwB,EAAM1oB,KAAO/F,KAAK+F,KAClB0oB,EAAMxU,QAAUja,KAAKia,QACrBwU,EAAMjP,SAAWxf,KAAKwf,SACtBiP,EAAMxJ,WAAajlB,KAAKilB,WACxBwJ,EAAMlB,aAAevtB,KAAKutB,aAC1BkB,EAAMpE,MAAQrqB,KAAKqqB,MACZoE,GAEJD,EA7BI,GCDXE,EAAkB,WAClB,SAASA,KAcT,OAZAA,EAAe/yB,UAAU2qB,uBAAyB,SAAUY,GAGxD,MAAO,CACHV,0BAH4B3U,QAAQua,YAAY/D,EAA0BnB,GAI1ER,sBAHwB7U,QAAQua,YAAY/D,EAAqBnB,IAGjB,KAGxDwH,EAAe/yB,UAAUyrB,sBAAwB,SAAUF,GAEvD,OAD4BrV,QAAQua,YAAY/D,EAA0BnB,IAAoB,IAG3FwH,EAfW,GCDlB7F,EAC2B,EAD3BA,GAEqB,EAFrBA,GAGyB,ECFzBwC,GAAW,WACX,SAASA,EAAQ3G,GACb1kB,KAAK2G,GAAKA,IACV3G,KAAK0kB,UAAYA,EAQrB,OANA2G,EAAQ1vB,UAAUuuB,QAAU,SAAUgB,GAClClrB,KAAKkrB,KAAOA,GAEhBG,EAAQ1vB,UAAU+wB,kBAAoB,SAAUiC,GAC5C3uB,KAAK2uB,eAAiBA,GAEnBtD,EAXI,GCAX5Y,GAAY,WACZ,SAASA,EAASnX,EAAKN,GACnBgF,KAAK1E,IAAMA,EACX0E,KAAKhF,MAAQA,EAUjB,OARAyX,EAAS9W,UAAUiE,SAAW,WAC1B,OAAII,KAAK1E,MAAQ+sB,EACN,UAAYroB,KAAKhF,MAAM4E,WAAa,IAGpC,iBAAmBI,KAAK1E,IAAIsE,WAAa,YAAcI,KAAKhF,MAAQ,MAG5EyX,EAbK,GCDZwX,GACA,SAAcwC,EAAehB,GACzBzrB,KAAKysB,cAAgBA,EACrBzsB,KAAKyrB,YAAcA,GCCvBvD,GAAwB,WACxB,SAASA,EAAqB/f,GAC1BnI,KAAK4uB,IAAMzmB,EAKf,OAHA+f,EAAqBvsB,UAAUwsB,OAAS,WACpC,OAAOnoB,KAAK4uB,OAET1G,EAPiB,GCJxB2G,GAAmB,WACnB,SAASA,EAAgBC,GACrB9uB,KAAK8uB,IAAMA,EAoBf,OAlBAD,EAAgBlzB,UAAUozB,WAAa,SAAUhvB,GAC7C,OAA0C,IAAnCC,KAAK8uB,IAAI1rB,QAAQrD,IAE5B8uB,EAAgBlzB,UAAUqzB,SAAW,SAAUjvB,GAC3C,IAAIkvB,EACAC,EAAsBnvB,EAAagC,MAAM,IAAI4jB,UAAUpkB,KAAK,IAEhE,OADA0tB,EAAgBjvB,KAAK8uB,IAAI/sB,MAAM,IAAI4jB,UAAUpkB,KAAK,IAC3CvB,KAAK+uB,WAAW70B,KAAK,CAAE40B,IAAKG,GAAiBC,IAExDL,EAAgBlzB,UAAUwzB,SAAW,SAAUpvB,GAC3C,OAA4C,IAApCC,KAAK8uB,IAAI1rB,QAAQrD,IAE7B8uB,EAAgBlzB,UAAUyzB,OAAS,SAAUC,GACzC,OAAOrvB,KAAK8uB,MAAQO,GAExBR,EAAgBlzB,UAAUX,MAAQ,WAC9B,OAAOgF,KAAK8uB,KAETD,EAtBY,GCInBtH,GAAU,WACV,SAASA,EAAOxhB,EAAMzL,EAAMkqB,EAAmB8K,GAC3CtvB,KAAK2G,GAAKA,IACV3G,KAAK+F,KAAOA,EACZ/F,KAAKwkB,kBAAoBA,EACzBxkB,KAAK1F,KAAO,IAAIu0B,GAAgBv0B,GAAQ,IACxC0F,KAAKqmB,SAAW,IAAIpgB,MACpB,IAAIspB,EAAe,KACU,iBAAlBD,EACPC,EAAe,IAAI9c,GAAS4V,EAAwBiH,GAE/CA,aAAyB7c,KAC9B8c,EAAeD,GAEE,OAAjBC,GACAvvB,KAAKqmB,SAASzlB,KAAK2uB,GAkE3B,OA/DAhI,EAAO5rB,UAAU6zB,OAAS,SAAUl0B,GAChC,IAAK,IAAIue,EAAK,EAAGE,EAAK/Z,KAAKqmB,SAAUxM,EAAKE,EAAGvZ,OAAQqZ,IAAM,CAEvD,GADQE,EAAGF,GACLve,MAAQA,EACV,OAAO,EAGf,OAAO,GAEXisB,EAAO5rB,UAAUuK,QAAU,WACvB,OAAOlG,KAAKwvB,OAAOnH,IAEvBd,EAAO5rB,UAAUkxB,aAAe,SAAUvyB,GACtC,OAAO0F,KAAKyvB,WAAWpH,EAAhBroB,CAA+C1F,IAE1DitB,EAAO5rB,UAAU2tB,QAAU,WACvB,OAAOtpB,KAAKwvB,OAAOnH,IAEvBd,EAAO5rB,UAAU0tB,SAAW,WACxB,OAAOrpB,KAAKqmB,SAASvK,MAAK,SAAU3hB,GAChC,OAAQA,EAAEmB,MAAQ+sB,GACbluB,EAAEmB,MAAQ+sB,GACVluB,EAAEmB,MAAQ+sB,GACVluB,EAAEmB,MAAQ+sB,GACVluB,EAAEmB,MAAQ+sB,MAGvBd,EAAO5rB,UAAUutB,WAAa,WAC1B,OAAOlpB,KAAKyvB,WAAWpH,EAAhBroB,EAA2C,IAEtDunB,EAAO5rB,UAAU8tB,YAAc,WAC3B,OAAIzpB,KAAKspB,UACEtpB,KAAKqmB,SAAS2C,QAAO,SAAU7uB,GAAK,OAAOA,EAAEmB,MAAQ+sB,KAA2B,GAEpF,MAEXd,EAAO5rB,UAAUguB,cAAgB,WAC7B,OAAI3pB,KAAKqpB,WACErpB,KAAKqmB,SAAS2C,QAAO,SAAU7uB,GAClC,OAAQA,EAAEmB,MAAQ+sB,GACbluB,EAAEmB,MAAQ+sB,GACVluB,EAAEmB,MAAQ+sB,GACVluB,EAAEmB,MAAQ+sB,GACVluB,EAAEmB,MAAQ+sB,KAGhB,MAEXd,EAAO5rB,UAAU+zB,gBAAkB,SAAUp1B,GACzC,OAAO0F,KAAKyvB,WAAWpH,EAAhBroB,CAAwC1F,IAEnDitB,EAAO5rB,UAAU8zB,WAAa,SAAUn0B,GACpC,IAAI8E,EAAQJ,KACZ,OAAO,SAAUhF,GACb,IAAK,IAAI6e,EAAK,EAAGE,EAAK3Z,EAAMimB,SAAUxM,EAAKE,EAAGvZ,OAAQqZ,IAAM,CACxD,IAAI1f,EAAI4f,EAAGF,GACX,GAAI1f,EAAEmB,MAAQA,GAAOnB,EAAEa,QAAUA,EAC7B,OAAO,EAGf,OAAO,IAGRusB,EAjFG,GfJVO,GAAkD,WAClD,IAAK,IAAIhsB,EAAI,EAAG/B,EAAI,EAAG41B,EAAK3rB,UAAUxD,OAAQzG,EAAI41B,EAAI51B,IAAK+B,GAAKkI,UAAUjK,GAAGyG,OACxE,IAAI3F,EAAIoL,MAAMnK,GAAI2X,EAAI,EAA3B,IAA8B1Z,EAAI,EAAGA,EAAI41B,EAAI51B,IACzC,IAAK,IAAI2H,EAAIsC,UAAUjK,GAAIgjB,EAAI,EAAG6S,EAAKluB,EAAElB,OAAQuc,EAAI6S,EAAI7S,IAAKtJ,IAC1D5Y,EAAE4Y,GAAK/R,EAAEqb,GACjB,OAAOliB,GgBJPouB,GAAW,WACX,SAASA,EAAQzE,EAAmBiI,EAAelH,EAAeoD,EAAU5W,GACxE/R,KAAK2G,GAAKA,IACV3G,KAAKwkB,kBAAoBA,EACzBxkB,KAAKysB,cAAgBA,EACrBzsB,KAAKulB,cAAgBA,EACrBvlB,KAAK+R,OAASA,EACd/R,KAAKolB,cAAgB,GACrBplB,KAAK2oB,SAAY1iB,MAAMC,QAAQyiB,GAAYA,EAAW,CAACA,GACvD3oB,KAAKwsB,aAAiC,OAAlBjH,EACd,IAAIlP,IACJ,KAOV,OALA4S,EAAQttB,UAAUwuB,gBAAkB,SAAU3F,EAAmBmE,EAAU5W,GACvE,IAAIwJ,EAAQ,IAAI0N,EAAQzE,EAAmBxkB,KAAKysB,cAAezsB,KAAM2oB,EAAU5W,GAE/E,OADA/R,KAAKolB,cAAcxkB,KAAK2a,GACjBA,GAEJ0N,EAlBI,GdDXnB,GAAkD,WAClD,IAAK,IAAIhsB,EAAI,EAAG/B,EAAI,EAAG41B,EAAK3rB,UAAUxD,OAAQzG,EAAI41B,EAAI51B,IAAK+B,GAAKkI,UAAUjK,GAAGyG,OACxE,IAAI3F,EAAIoL,MAAMnK,GAAI2X,EAAI,EAA3B,IAA8B1Z,EAAI,EAAGA,EAAI41B,EAAI51B,IACzC,IAAK,IAAI2H,EAAIsC,UAAUjK,GAAIgjB,EAAI,EAAG6S,EAAKluB,EAAElB,OAAQuc,EAAI6S,EAAI7S,IAAKtJ,IAC1D5Y,EAAE4Y,GAAK/R,EAAEqb,GACjB,OAAOliB,GCAPyyB,GAAgB,SAAUuC,EAAarL,EAAmBsL,GAC1D,IACI,OAAOA,IAEX,MAAOhxB,GACH,MAAIulB,EAAwBvlB,GAClB,IAAIxB,MLqCsB,WAExC,IADA,IAAI+D,EAAS,GACJwY,EAAK,EAAGA,EAAK7V,UAAUxD,OAAQqZ,IACpCxY,EAAOwY,GAAM7V,UAAU6V,GAE3B,MAAO,+DACkBxY,EAAO,GADzB,mEAEuBA,EAAO,GAAK,KK5ClBwkB,CAA0CgK,EAAarL,EAAkB5kB,aAGnFd,IcZdixB,GAAqB,SAArBA,EAA+B3xB,EAAS6mB,GACxC,IAAIxa,EAASrM,EAAQmnB,cACrB,OAAe,OAAX9a,MACOwa,EAAWxa,IAAiBslB,EAAmBtlB,EAAQwa,KAMlE+K,GAAmB,SAAU10B,GAAO,OAAO,SAAUN,GACrD,IAAIiqB,EAAa,SAAU7mB,GACvB,OAAmB,OAAZA,GAAuC,OAAnBA,EAAQ2T,QAAmB3T,EAAQ2T,OAAO0d,WAAWn0B,EAA1B8C,CAA+BpD,IAGzF,OADAiqB,EAAWC,SAAW,IAAIzS,GAASnX,EAAKN,GACjCiqB,IAEPgL,GAAkBD,GAAiB3H,GACnC6H,GAAiB,SAAUnqB,GAAQ,OAAO,SAAU3H,GAEpD,OAAgB,OAAZA,IAEoB,iBAAT2H,EADD3H,EAAQuqB,SAAS,GAESnE,oBACHze,EAItBA,IADW3H,EAAQuqB,SAAS,GAAG5D,sBC1B9CoL,GAAqB,WACrB,SAASA,EAAkBrL,GACvB9kB,KAAKowB,SAAWtL,EAyFpB,OAvFAqL,EAAkBx0B,UAAU00B,KAAO,SAAUpL,GAEzC,OADAjlB,KAAKowB,SAASnL,WAAaA,EACpB,IAAIqL,GAAgBtwB,KAAKowB,WAEpCD,EAAkBx0B,UAAU40B,gBAAkB,SAAUj2B,GAEpD,OADA0F,KAAKowB,SAASnL,WAAagL,GAAgB31B,GACpC,IAAIg2B,GAAgBtwB,KAAKowB,WAEpCD,EAAkBx0B,UAAU60B,oBAAsB,WAO9C,OANAxwB,KAAKowB,SAASnL,WAAa,SAAU7mB,GAIjC,OAH0C,OAAnBA,EAAQ2T,SACzB3T,EAAQ2T,OAAOuX,YACflrB,EAAQ2T,OAAOsX,YAGlB,IAAIiH,GAAgBtwB,KAAKowB,WAEpCD,EAAkBx0B,UAAU80B,iBAAmB,SAAU7G,EAAK5uB,GAE1D,OADAgF,KAAKowB,SAASnL,WAAa+K,GAAiBpG,EAAjBoG,CAAsBh1B,GAC1C,IAAIs1B,GAAgBtwB,KAAKowB,WAEpCD,EAAkBx0B,UAAU+0B,iBAAmB,SAAUjmB,GAIrD,OAHAzK,KAAKowB,SAASnL,WAAa,SAAU7mB,GACjC,OAAO8xB,GAAezlB,EAAfylB,CAAuB9xB,EAAQmnB,gBAEnC,IAAI+K,GAAgBtwB,KAAKowB,WAEpCD,EAAkBx0B,UAAUg1B,gBAAkB,SAAUr2B,GAIpD,OAHA0F,KAAKowB,SAASnL,WAAa,SAAU7mB,GACjC,OAAO6xB,GAAgB31B,EAAhB21B,CAAsB7xB,EAAQmnB,gBAElC,IAAI+K,GAAgBtwB,KAAKowB,WAEpCD,EAAkBx0B,UAAUi1B,iBAAmB,SAAUhH,EAAK5uB,GAI1D,OAHAgF,KAAKowB,SAASnL,WAAa,SAAU7mB,GACjC,OAAO4xB,GAAiBpG,EAAjBoG,CAAsBh1B,EAAtBg1B,CAA6B5xB,EAAQmnB,gBAEzC,IAAI+K,GAAgBtwB,KAAKowB,WAEpCD,EAAkBx0B,UAAUk1B,kBAAoB,SAAUC,GAItD,OAHA9wB,KAAKowB,SAASnL,WAAa,SAAU7mB,GACjC,OAAO2xB,GAAmB3xB,EAAS8xB,GAAeY,KAE/C,IAAIR,GAAgBtwB,KAAKowB,WAEpCD,EAAkBx0B,UAAUo1B,iBAAmB,SAAUD,GAIrD,OAHA9wB,KAAKowB,SAASnL,WAAa,SAAU7mB,GACjC,OAAQ2xB,GAAmB3xB,EAAS8xB,GAAeY,KAEhD,IAAIR,GAAgBtwB,KAAKowB,WAEpCD,EAAkBx0B,UAAUq1B,qBAAuB,SAAU12B,GAIzD,OAHA0F,KAAKowB,SAASnL,WAAa,SAAU7mB,GACjC,OAAO2xB,GAAmB3xB,EAAS6xB,GAAgB31B,KAEhD,IAAIg2B,GAAgBtwB,KAAKowB,WAEpCD,EAAkBx0B,UAAUs1B,oBAAsB,SAAU32B,GAIxD,OAHA0F,KAAKowB,SAASnL,WAAa,SAAU7mB,GACjC,OAAQ2xB,GAAmB3xB,EAAS6xB,GAAgB31B,KAEjD,IAAIg2B,GAAgBtwB,KAAKowB,WAEpCD,EAAkBx0B,UAAUu1B,sBAAwB,SAAUtH,EAAK5uB,GAI/D,OAHAgF,KAAKowB,SAASnL,WAAa,SAAU7mB,GACjC,OAAO2xB,GAAmB3xB,EAAS4xB,GAAiBpG,EAAjBoG,CAAsBh1B,KAEtD,IAAIs1B,GAAgBtwB,KAAKowB,WAEpCD,EAAkBx0B,UAAUw1B,qBAAuB,SAAUvH,EAAK5uB,GAI9D,OAHAgF,KAAKowB,SAASnL,WAAa,SAAU7mB,GACjC,OAAQ2xB,GAAmB3xB,EAAS4xB,GAAiBpG,EAAjBoG,CAAsBh1B,KAEvD,IAAIs1B,GAAgBtwB,KAAKowB,WAEpCD,EAAkBx0B,UAAUy1B,uBAAyB,SAAUnM,GAI3D,OAHAjlB,KAAKowB,SAASnL,WAAa,SAAU7mB,GACjC,OAAO2xB,GAAmB3xB,EAAS6mB,IAEhC,IAAIqL,GAAgBtwB,KAAKowB,WAEpCD,EAAkBx0B,UAAU01B,sBAAwB,SAAUpM,GAI1D,OAHAjlB,KAAKowB,SAASnL,WAAa,SAAU7mB,GACjC,OAAQ2xB,GAAmB3xB,EAAS6mB,IAEjC,IAAIqL,GAAgBtwB,KAAKowB,WAE7BD,EA3Fc,GCDrBG,GAAmB,WACnB,SAASA,EAAgBxL,GACrB9kB,KAAKowB,SAAWtL,EAMpB,OAJAwL,EAAgB30B,UAAU4xB,aAAe,SAAU+D,GAE/C,OADAtxB,KAAKowB,SAAS7C,aAAe+D,EACtB,IAAInB,GAAkBnwB,KAAKowB,WAE/BE,EARY,GCCnBiB,GAAuB,WACvB,SAASA,EAAoBzM,GACzB9kB,KAAKowB,SAAWtL,EAChB9kB,KAAKwxB,mBAAqB,IAAIrB,GAAkBnwB,KAAKowB,UACrDpwB,KAAKyxB,iBAAmB,IAAInB,GAAgBtwB,KAAKowB,UAkDrD,OAhDAmB,EAAoB51B,UAAU00B,KAAO,SAAUpL,GAC3C,OAAOjlB,KAAKwxB,mBAAmBnB,KAAKpL,IAExCsM,EAAoB51B,UAAU40B,gBAAkB,SAAUj2B,GACtD,OAAO0F,KAAKwxB,mBAAmBjB,gBAAgBj2B,IAEnDi3B,EAAoB51B,UAAU60B,oBAAsB,WAChD,OAAOxwB,KAAKwxB,mBAAmBhB,uBAEnCe,EAAoB51B,UAAU80B,iBAAmB,SAAU7G,EAAK5uB,GAC5D,OAAOgF,KAAKwxB,mBAAmBf,iBAAiB7G,EAAK5uB,IAEzDu2B,EAAoB51B,UAAU+0B,iBAAmB,SAAUjmB,GACvD,OAAOzK,KAAKwxB,mBAAmBd,iBAAiBjmB,IAEpD8mB,EAAoB51B,UAAUg1B,gBAAkB,SAAUr2B,GACtD,OAAO0F,KAAKwxB,mBAAmBb,gBAAgBr2B,IAEnDi3B,EAAoB51B,UAAUi1B,iBAAmB,SAAUhH,EAAK5uB,GAC5D,OAAOgF,KAAKwxB,mBAAmBZ,iBAAiBhH,EAAK5uB,IAEzDu2B,EAAoB51B,UAAUk1B,kBAAoB,SAAUC,GACxD,OAAO9wB,KAAKwxB,mBAAmBX,kBAAkBC,IAErDS,EAAoB51B,UAAUo1B,iBAAmB,SAAUD,GACvD,OAAO9wB,KAAKwxB,mBAAmBT,iBAAiBD,IAEpDS,EAAoB51B,UAAUq1B,qBAAuB,SAAU12B,GAC3D,OAAO0F,KAAKwxB,mBAAmBR,qBAAqB12B,IAExDi3B,EAAoB51B,UAAUu1B,sBAAwB,SAAUtH,EAAK5uB,GACjE,OAAOgF,KAAKwxB,mBAAmBN,sBAAsBtH,EAAK5uB,IAE9Du2B,EAAoB51B,UAAUs1B,oBAAsB,SAAU32B,GAC1D,OAAO0F,KAAKwxB,mBAAmBP,oBAAoB32B,IAEvDi3B,EAAoB51B,UAAUw1B,qBAAuB,SAAUvH,EAAK5uB,GAChE,OAAOgF,KAAKwxB,mBAAmBL,qBAAqBvH,EAAK5uB,IAE7Du2B,EAAoB51B,UAAUy1B,uBAAyB,SAAUnM,GAC7D,OAAOjlB,KAAKwxB,mBAAmBJ,uBAAuBnM,IAE1DsM,EAAoB51B,UAAU01B,sBAAwB,SAAUpM,GAC5D,OAAOjlB,KAAKwxB,mBAAmBH,sBAAsBpM,IAEzDsM,EAAoB51B,UAAU4xB,aAAe,SAAU+D,GACnD,OAAOtxB,KAAKyxB,iBAAiBlE,aAAa+D,IAEvCC,EAtDgB,GCAvBG,GAAmB,WACnB,SAASA,EAAgB5M,GACrB9kB,KAAKowB,SAAWtL,EAcpB,OAZA4M,EAAgB/1B,UAAUg2B,eAAiB,WAEvC,OADA3xB,KAAKowB,SAASnD,MAAQC,EACf,IAAIqE,GAAoBvxB,KAAKowB,WAExCsB,EAAgB/1B,UAAUi2B,iBAAmB,WAEzC,OADA5xB,KAAKowB,SAASnD,MAAQC,EACf,IAAIqE,GAAoBvxB,KAAKowB,WAExCsB,EAAgB/1B,UAAUk2B,iBAAmB,WAEzC,OADA7xB,KAAKowB,SAASnD,MAAQC,EACf,IAAIqE,GAAoBvxB,KAAKowB,WAEjCsB,EAhBY,GCCnBI,GAAyB,WACzB,SAASA,EAAsBhN,GAC3B9kB,KAAKowB,SAAWtL,EAChB9kB,KAAKwxB,mBAAqB,IAAIrB,GAAkBnwB,KAAKowB,UACrDpwB,KAAKyxB,iBAAmB,IAAInB,GAAgBtwB,KAAKowB,UACjDpwB,KAAK+xB,iBAAmB,IAAIL,GAAgB5M,GA2DhD,OAzDAgN,EAAsBn2B,UAAUg2B,eAAiB,WAC7C,OAAO3xB,KAAK+xB,iBAAiBJ,kBAEjCG,EAAsBn2B,UAAUi2B,iBAAmB,WAC/C,OAAO5xB,KAAK+xB,iBAAiBH,oBAEjCE,EAAsBn2B,UAAUk2B,iBAAmB,WAC/C,OAAO7xB,KAAK+xB,iBAAiBF,oBAEjCC,EAAsBn2B,UAAU00B,KAAO,SAAUpL,GAC7C,OAAOjlB,KAAKwxB,mBAAmBnB,KAAKpL,IAExC6M,EAAsBn2B,UAAU40B,gBAAkB,SAAUj2B,GACxD,OAAO0F,KAAKwxB,mBAAmBjB,gBAAgBj2B,IAEnDw3B,EAAsBn2B,UAAU60B,oBAAsB,WAClD,OAAOxwB,KAAKwxB,mBAAmBhB,uBAEnCsB,EAAsBn2B,UAAU80B,iBAAmB,SAAU7G,EAAK5uB,GAC9D,OAAOgF,KAAKwxB,mBAAmBf,iBAAiB7G,EAAK5uB,IAEzD82B,EAAsBn2B,UAAU+0B,iBAAmB,SAAUjmB,GACzD,OAAOzK,KAAKwxB,mBAAmBd,iBAAiBjmB,IAEpDqnB,EAAsBn2B,UAAUg1B,gBAAkB,SAAUr2B,GACxD,OAAO0F,KAAKwxB,mBAAmBb,gBAAgBr2B,IAEnDw3B,EAAsBn2B,UAAUi1B,iBAAmB,SAAUhH,EAAK5uB,GAC9D,OAAOgF,KAAKwxB,mBAAmBZ,iBAAiBhH,EAAK5uB,IAEzD82B,EAAsBn2B,UAAUk1B,kBAAoB,SAAUC,GAC1D,OAAO9wB,KAAKwxB,mBAAmBX,kBAAkBC,IAErDgB,EAAsBn2B,UAAUo1B,iBAAmB,SAAUD,GACzD,OAAO9wB,KAAKwxB,mBAAmBT,iBAAiBD,IAEpDgB,EAAsBn2B,UAAUq1B,qBAAuB,SAAU12B,GAC7D,OAAO0F,KAAKwxB,mBAAmBR,qBAAqB12B,IAExDw3B,EAAsBn2B,UAAUu1B,sBAAwB,SAAUtH,EAAK5uB,GACnE,OAAOgF,KAAKwxB,mBAAmBN,sBAAsBtH,EAAK5uB,IAE9D82B,EAAsBn2B,UAAUs1B,oBAAsB,SAAU32B,GAC5D,OAAO0F,KAAKwxB,mBAAmBP,oBAAoB32B,IAEvDw3B,EAAsBn2B,UAAUw1B,qBAAuB,SAAUvH,EAAK5uB,GAClE,OAAOgF,KAAKwxB,mBAAmBL,qBAAqBvH,EAAK5uB,IAE7D82B,EAAsBn2B,UAAUy1B,uBAAyB,SAAUnM,GAC/D,OAAOjlB,KAAKwxB,mBAAmBJ,uBAAuBnM,IAE1D6M,EAAsBn2B,UAAU01B,sBAAwB,SAAUpM,GAC9D,OAAOjlB,KAAKwxB,mBAAmBH,sBAAsBpM,IAEzD6M,EAAsBn2B,UAAU4xB,aAAe,SAAU+D,GACrD,OAAOtxB,KAAKyxB,iBAAiBlE,aAAa+D,IAEvCQ,EAhEkB,GCCzBE,GAAmB,WACnB,SAASA,EAAgBlN,GACrB9kB,KAAKowB,SAAWtL,EA8DpB,OA5DAkN,EAAgBr2B,UAAUs2B,GAAK,SAAU1c,GAGrC,OAFAvV,KAAKowB,SAASrqB,KAAOukB,EACrBtqB,KAAKowB,SAASrL,mBAAqBxP,EAC5B,IAAIuc,GAAsB9xB,KAAKowB,WAE1C4B,EAAgBr2B,UAAUotB,OAAS,WAC/B,GAA+C,mBAApC/oB,KAAKowB,SAAS5L,kBACrB,MAAM,IAAIlnB,MzBKa,4FyBF3B,OAAO0C,KAAKiyB,GADDjyB,KAAKowB,SAAS5L,oBAG7BwN,EAAgBr2B,UAAUu2B,gBAAkB,SAAUl3B,GAKlD,OAJAgF,KAAKowB,SAASrqB,KAAOukB,EACrBtqB,KAAKowB,SAAS/F,MAAQrvB,EACtBgF,KAAKowB,SAAS/C,aAAe,KAC7BrtB,KAAKowB,SAASrL,mBAAqB,KAC5B,IAAIwM,GAAoBvxB,KAAKowB,WAExC4B,EAAgBr2B,UAAUw2B,eAAiB,SAAUld,GAKjD,OAJAjV,KAAKowB,SAASrqB,KAAOukB,EACrBtqB,KAAKowB,SAAS/F,MAAQ,KACtBrqB,KAAKowB,SAAS/C,aAAepY,EAC7BjV,KAAKowB,SAASrL,mBAAqB,KAC5B,IAAI+M,GAAsB9xB,KAAKowB,WAE1C4B,EAAgBr2B,UAAUy2B,cAAgB,SAAU7c,GAGhD,OAFAvV,KAAKowB,SAASrqB,KAAOukB,EACrBtqB,KAAKowB,SAASrL,mBAAqBxP,EAC5B,IAAIgc,GAAoBvxB,KAAKowB,WAExC4B,EAAgBr2B,UAAU02B,UAAY,SAAUpY,GAG5C,OAFAja,KAAKowB,SAASrqB,KAAOukB,EACrBtqB,KAAKowB,SAASnW,QAAUA,EACjB,IAAIsX,GAAoBvxB,KAAKowB,WAExC4B,EAAgBr2B,UAAU22B,WAAa,SAAUrd,GAC7C,GAAoB,mBAATA,EACP,MAAM,IAAI3X,MzB3BgB,0DyB6B9B,IAAIi1B,EAAsBvyB,KAAKkyB,gBAAgBjd,GAE/C,OADAjV,KAAKowB,SAASrqB,KAAOukB,EACdiI,GAEXP,EAAgBr2B,UAAU62B,cAAgB,SAAUhO,GAMhD,OALAxkB,KAAKowB,SAASrqB,KAAOukB,EACrBtqB,KAAKowB,SAASnW,QAAU,SAAUje,GAE9B,OADkB,WAAc,OAAOA,EAAQ0oB,UAAU9pB,IAAI4pB,KAG1D,IAAI+M,GAAoBvxB,KAAKowB,WAExC4B,EAAgBr2B,UAAU82B,WAAa,SAAUjT,GAG7C,OAFAxf,KAAKowB,SAASrqB,KAAOukB,EACrBtqB,KAAKowB,SAAS5Q,SAAWA,EAClB,IAAI+R,GAAoBvxB,KAAKowB,WAExC4B,EAAgBr2B,UAAU+2B,UAAY,SAAUC,GAC5C3yB,KAAKmyB,gBAAe,SAAUn2B,GAAW,OAAOA,EAAQ0oB,UAAU9pB,IAAI+3B,OAEnEX,EAhEY,GCJnBY,GAAqB,WACrB,SAASA,KAQT,OANAA,EAAkBC,GAAK,SAAUlK,EAAUmK,GACvC,IAAIzT,EAAW,IAAIuT,EAGnB,OAFAvT,EAASsJ,SAAWA,EACpBtJ,EAASyT,WAAaA,EACfzT,GAEJuT,EATc,GCCrBG,GAAU,WACV,SAASA,IACL/yB,KAAK6X,KAAO,IAAIxB,IAuEpB,OArEA0c,EAAOp3B,UAAUq3B,OAAS,WACtB,OAAOhzB,KAAK6X,MAEhBkb,EAAOp3B,UAAUmc,IAAM,SAAU0M,EAAmBxpB,GAChD,GAAIwpB,QACA,MAAM,IAAIlnB,M3BRK,iB2BUnB,GAAItC,QACA,MAAM,IAAIsC,M3BXK,iB2BanB,IAAImD,EAAQT,KAAK6X,KAAKjd,IAAI4pB,QACZvoB,IAAVwE,GACAA,EAAMG,KAAK5F,GACXgF,KAAK6X,KAAKhY,IAAI2kB,EAAmB/jB,IAGjCT,KAAK6X,KAAKhY,IAAI2kB,EAAmB,CAACxpB,KAG1C+3B,EAAOp3B,UAAUf,IAAM,SAAU4pB,GAC7B,GAAIA,QACA,MAAM,IAAIlnB,M3BxBK,iB2B0BnB,IAAImD,EAAQT,KAAK6X,KAAKjd,IAAI4pB,GAC1B,QAAcvoB,IAAVwE,EACA,OAAOA,EAGP,MAAM,IAAInD,M3B9BK,kB2BiCvBy1B,EAAOp3B,UAAUs3B,OAAS,SAAUzO,GAChC,GAAIA,QACA,MAAM,IAAIlnB,M3BpCK,iB2BsCnB,IAAK0C,KAAK6X,KAAKhX,OAAO2jB,GAClB,MAAM,IAAIlnB,M3BtCK,kB2ByCvBy1B,EAAOp3B,UAAUu3B,kBAAoB,SAAUC,GAC3C,IAAI/yB,EAAQJ,KACZA,KAAK6X,KAAKxX,SAAQ,SAAUc,EAAS7F,GACjC,IAAI83B,EAAiBjyB,EAAQ6nB,QAAO,SAAUvoB,GAAS,OAAQ0yB,EAAU1yB,MACrE2yB,EAAe5yB,OAAS,EACxBJ,EAAMyX,KAAKhY,IAAIvE,EAAK83B,GAGpBhzB,EAAMyX,KAAKhX,OAAOvF,OAI9By3B,EAAOp3B,UAAUsvB,OAAS,SAAUzG,GAChC,GAAIA,QACA,MAAM,IAAIlnB,M3BxDK,iB2B0DnB,OAAO0C,KAAK6X,KAAK7W,IAAIwjB,IAEzBuO,EAAOp3B,UAAU8yB,MAAQ,WACrB,IAAI4E,EAAO,IAAIN,EAIf,OAHA/yB,KAAK6X,KAAKxX,SAAQ,SAAUrF,EAAOM,GAC/BN,EAAMqF,SAAQ,SAAUsB,GAAK,OAAO0xB,EAAKvb,IAAIxc,EAAKqG,EAAE8sB,eAEjD4E,GAEXN,EAAOp3B,UAAU23B,SAAW,SAAUre,GAClCjV,KAAK6X,KAAKxX,SAAQ,SAAUrF,EAAOM,GAC/B2Z,EAAK3Z,EAAKN,OAGX+3B,EAzEG,GCDVQ,GAAwC,SAAUryB,EAASsyB,EAAYlhB,EAAGmhB,GAE1E,OAAO,IAAKnhB,IAAMA,EAAIxU,WAAU,SAAUC,EAASC,GAC/C,SAAS01B,EAAU14B,GAAS,IAAM24B,EAAKF,EAAUv0B,KAAKlE,IAAW,MAAOyD,GAAKT,EAAOS,IACpF,SAASm1B,EAAS54B,GAAS,IAAM24B,EAAKF,EAAS,MAAUz4B,IAAW,MAAOyD,GAAKT,EAAOS,IACvF,SAASk1B,EAAKrf,GAJlB,IAAetZ,EAIasZ,EAAOlV,KAAOrB,EAAQuW,EAAOtZ,QAJ1CA,EAIyDsZ,EAAOtZ,MAJhDA,aAAiBsX,EAAItX,EAAQ,IAAIsX,GAAE,SAAUvU,GAAWA,EAAQ/C,OAIT2P,KAAK+oB,EAAWE,GAClGD,GAAMF,EAAYA,EAAU1vB,MAAM7C,EAASsyB,GAAc,KAAKt0B,YAGlE20B,GAA4C,SAAU3yB,EAASqC,GAG/D,SAASuwB,EAAKt4B,GAAK,OAAO,SAAUsqB,GAAK,OACzC,SAAciO,GACV,GAAI7e,EAAG,MAAM,IAAI3U,UAAU,mCAC3B,KAAOgW,GAAG,IACN,GAAIrB,EAAI,EAAG8e,IAAM/4B,EAAY,EAAR84B,EAAG,GAASC,EAAC,OAAaD,EAAG,GAAKC,EAAC,SAAe/4B,EAAI+4B,EAAC,SAAe/4B,EAAEf,KAAK85B,GAAI,GAAKA,EAAE90B,SAAWjE,EAAIA,EAAEf,KAAK85B,EAAGD,EAAG,KAAK30B,KAAM,OAAOnE,EAE3J,OADI+4B,EAAI,EAAG/4B,IAAG84B,EAAK,CAAS,EAARA,EAAG,GAAQ94B,EAAED,QACzB+4B,EAAG,IACP,KAAK,EAAG,KAAK,EAAG94B,EAAI84B,EAAI,MACxB,KAAK,EAAc,OAAXxd,EAAE0d,QAAgB,CAAEj5B,MAAO+4B,EAAG,GAAI30B,MAAM,GAChD,KAAK,EAAGmX,EAAE0d,QAASD,EAAID,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAKxd,EAAE2d,IAAIC,MAAO5d,EAAE6d,KAAKD,MAAO,SACxC,QACI,KAAMl5B,EAAIsb,EAAE6d,MAAMn5B,EAAIA,EAAEuF,OAAS,GAAKvF,EAAEA,EAAEuF,OAAS,KAAkB,IAAVuzB,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAExd,EAAI,EAAG,SACjG,GAAc,IAAVwd,EAAG,MAAc94B,GAAM84B,EAAG,GAAK94B,EAAE,IAAM84B,EAAG,GAAK94B,EAAE,IAAM,CAAEsb,EAAE0d,MAAQF,EAAG,GAAI,MAC9E,GAAc,IAAVA,EAAG,IAAYxd,EAAE0d,MAAQh5B,EAAE,GAAI,CAAEsb,EAAE0d,MAAQh5B,EAAE,GAAIA,EAAI84B,EAAI,MAC7D,GAAI94B,GAAKsb,EAAE0d,MAAQh5B,EAAE,GAAI,CAAEsb,EAAE0d,MAAQh5B,EAAE,GAAIsb,EAAE2d,IAAItzB,KAAKmzB,GAAK,MACvD94B,EAAE,IAAIsb,EAAE2d,IAAIC,MAChB5d,EAAE6d,KAAKD,MAAO,SAEtBJ,EAAKxwB,EAAKrJ,KAAKgH,EAASqV,GAC1B,MAAO9X,GAAKs1B,EAAK,CAAC,EAAGt1B,GAAIu1B,EAAI,EAjBrB,QAiBoC9e,EAAIja,EAAI,EACtD,GAAY,EAAR84B,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAE/4B,MAAO+4B,EAAG,GAAKA,EAAG,QAAK,EAAQ30B,MAAM,GArB9Bu0B,CAAK,CAACn4B,EAAGsqB,KAFzD,IAAsG5Q,EAAG8e,EAAG/4B,EAAGkpB,EAA3G5N,EAAI,CAAE0d,MAAO,EAAGI,KAAM,WAAa,GAAW,EAAPp5B,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,IAAOm5B,KAAM,GAAIF,IAAK,IAChG,OAAO/P,EAAI,CAAEjlB,KAAM40B,EAAK,GAAI,MAASA,EAAK,GAAI,OAAUA,EAAK,IAAwB,mBAAXh5B,SAA0BqpB,EAAErpB,OAAO+D,UAAY,WAAa,OAAOmB,OAAUmkB,GAqCvJmQ,GAAa,WACb,SAASA,EAAUC,GACf,IAAIl4B,EAAUk4B,GAAoB,GAClC,GAAuB,iBAAZl4B,EACP,MAAM,IAAIiB,M5BpB2B,gF4BsBzC,QAA6BrB,IAAzBI,EAAQm4B,aACRn4B,EAAQm4B,aAAetH,OAEtB,GAAI7wB,EAAQm4B,eAAiBtH,GAC9B7wB,EAAQm4B,eAAiBtH,GACzB7wB,EAAQm4B,eAAiBtH,EACzB,MAAM,IAAI5vB,M5B1B+B,0F4B4B7C,QAAmCrB,IAA/BI,EAAQysB,mBACRzsB,EAAQysB,oBAAqB,OAE5B,GAA0C,kBAA/BzsB,EAAQysB,mBACpB,MAAM,IAAIxrB,M5B9BsC,oE4BgCpD,QAAoCrB,IAAhCI,EAAQouB,oBACRpuB,EAAQouB,qBAAsB,OAE7B,GAA2C,kBAAhCpuB,EAAQouB,oBACpB,MAAM,IAAIntB,M5BlCiC,+D4BoC/C0C,KAAK3D,QAAU,CACXysB,mBAAoBzsB,EAAQysB,mBAC5B0L,aAAcn4B,EAAQm4B,aACtB/J,oBAAqBpuB,EAAQouB,qBAEjCzqB,KAAK2G,GAAKA,IACV3G,KAAKwoB,mBAAqB,IAAIuK,GAC9B/yB,KAAKy0B,WAAa,GAClBz0B,KAAK00B,YAAc,KACnB10B,KAAKyK,OAAS,KACdzK,KAAK20B,gBAAkB,IAAIjG,EA6O/B,OA3OA4F,EAAUM,MAAQ,SAAUC,EAAYC,GAKpC,SAASC,EAAejwB,EAAQkwB,GAC5BlwB,EAAOwuB,UAAS,SAAUh4B,EAAKN,GAC3BA,EAAMqF,SAAQ,SAAUykB,GACpBkQ,EAAYld,IAAIgN,EAAQN,kBAAmBM,EAAQ2J,eAP/D,IAAI/J,EAAY,IAAI4P,EAChBtJ,EAAoB1C,EAAqB5D,GACzCuQ,EAAqB3M,EAAqBuM,GAC1CK,EAAqB5M,EAAqBwM,GAU9C,OAFAC,EAAeE,EAAoBjK,GACnC+J,EAAeG,EAAoBlK,GAC5BtG,GAEX4P,EAAU34B,UAAUw5B,KAAO,WAEvB,IADA,IAAIl7B,EAAU,GACL4f,EAAK,EAAGA,EAAK7V,UAAUxD,OAAQqZ,IACpC5f,EAAQ4f,GAAM7V,UAAU6V,GAG5B,IADA,IAAIub,EAAap1B,KAAKq1B,oCACbtb,EAAK,EAAGub,EAAYr7B,EAAS8f,EAAKub,EAAU90B,OAAQuZ,IAAM,CAC/D,IAAIwb,EAAgBD,EAAUvb,GAC1Byb,EAAyBJ,EAAWG,EAAc5uB,IACtD4uB,EAAcE,SAASD,EAAuBE,aAAcF,EAAuBG,eAAgBH,EAAuBI,gBAAiBJ,EAAuBK,kBAG1KvB,EAAU34B,UAAUm6B,UAAY,WAE5B,IADA,IAAI77B,EAAU,GACL4f,EAAK,EAAGA,EAAK7V,UAAUxD,OAAQqZ,IACpC5f,EAAQ4f,GAAM7V,UAAU6V,GAE5B,OAAO0Z,GAAUvzB,UAAM,OAAQ,GAAQ,WACnC,IAAIo1B,EAAYrb,EAAIgc,EAAWR,EAAeC,EAC9C,OAAO3B,GAAY7zB,MAAM,SAAUg2B,GAC/B,OAAQA,EAAG/B,OACP,KAAK,EACDmB,EAAap1B,KAAKq1B,oCAClBtb,EAAK,EAAGgc,EAAY97B,EACpB+7B,EAAG/B,MAAQ,EACf,KAAK,EACD,OAAMla,EAAKgc,EAAUv1B,QAErBg1B,EAAyBJ,GADzBG,EAAgBQ,EAAUhc,IACwBpT,IAC3C,CAAC,EAAG4uB,EAAcE,SAASD,EAAuBE,aAAcF,EAAuBG,eAAgBH,EAAuBI,gBAAiBJ,EAAuBK,kBAHxI,CAAC,EAAG,GAI7C,KAAK,EACDG,EAAG3B,OACH2B,EAAG/B,MAAQ,EACf,KAAK,EAED,OADAla,IACO,CAAC,EAAG,GACf,KAAK,EAAG,MAAO,CAAC,WAKhCua,EAAU34B,UAAUs6B,OAAS,WAGzB,IAFA,IAAI71B,EAAQJ,KACR/F,EAAU,GACL4f,EAAK,EAAGA,EAAK7V,UAAUxD,OAAQqZ,IACpC5f,EAAQ4f,GAAM7V,UAAU6V,GAE5B,IAAIqc,EAAmB,SAAUC,GAAY,OAAO,SAAUC,GAC1D,OAAOA,EAAKz8B,WAAaw8B,IAE7Bl8B,EAAQoG,SAAQ,SAAUvG,GACtB,IAAIq5B,EAAY+C,EAAiBp8B,EAAO6M,IACxCvG,EAAMooB,mBAAmB0K,kBAAkBC,OAGnDmB,EAAU34B,UAAUJ,KAAO,SAAUipB,GACjC,IACIM,EAAU,IAAI0J,EAAQhK,EADdxkB,KAAK3D,QAAQm4B,cAAgBtH,GAGzC,OADAltB,KAAKwoB,mBAAmB1Q,IAAI0M,EAAmBM,GACxC,IAAIkN,GAAgBlN,IAE/BwP,EAAU34B,UAAU06B,OAAS,SAAU7R,GAEnC,OADAxkB,KAAKs2B,OAAO9R,GACLxkB,KAAKzE,KAAKipB,IAErB8P,EAAU34B,UAAU26B,OAAS,SAAU9R,GACnC,IACIxkB,KAAKwoB,mBAAmByK,OAAOzO,GAEnC,MAAO/lB,GACH,MAAM,IAAInB,MAAMuoB,uCAAiCtB,EAA6BC,MAGtF8P,EAAU34B,UAAU46B,UAAY,WAC5Bv2B,KAAKwoB,mBAAqB,IAAIuK,IAElCuB,EAAU34B,UAAU66B,QAAU,SAAUhS,GACpC,IAAIiS,EAAQz2B,KAAKwoB,mBAAmByC,OAAOzG,GAI3C,OAHKiS,GAASz2B,KAAKyK,SACfgsB,EAAQz2B,KAAKyK,OAAO+rB,QAAQhS,IAEzBiS,GAEXnC,EAAU34B,UAAU+6B,aAAe,SAAUlS,EAAmBmS,GAC5D,OAAO32B,KAAK42B,cAAcpS,EAAmB6D,EAAwBsO,IAEzErC,EAAU34B,UAAUi7B,cAAgB,SAAUpS,EAAmBlpB,EAAKN,GAClE,IAAIy7B,GAAQ,EACZ,GAAIz2B,KAAKwoB,mBAAmByC,OAAOzG,GAAoB,CACnD,IAAImE,EAAW3oB,KAAKwoB,mBAAmB5tB,IAAI4pB,GACvCqS,EzBhDhB,SAA2BnS,EAAWF,EAAmBlpB,EAAKN,GAC1D,IAAI+W,EAAS,IAAIwV,GAAOC,EAAyB,GAAIhD,EAAmB,IAAI/R,GAASnX,EAAKN,IACtFgB,EAAU,IAAIqvB,GAAQ3G,GAE1B,OADc,IAAIuE,GAAQzE,EAAmBxoB,EAAS,KAAM,GAAI+V,GyB6CxC+kB,CAAkB92B,KAAMwkB,EAAmBlpB,EAAKN,GAChEy7B,EAAQ9N,EAAS7M,MAAK,SAAUna,GAAK,OAAOA,EAAEsjB,WAAW4R,MAK7D,OAHKJ,GAASz2B,KAAKyK,SACfgsB,EAAQz2B,KAAKyK,OAAOmsB,cAAcpS,EAAmBlpB,EAAKN,IAEvDy7B,GAEXnC,EAAU34B,UAAU0jB,SAAW,WAC3Brf,KAAKy0B,WAAW7zB,KAAKgyB,GAAkBC,GAAG7yB,KAAKwoB,mBAAmBiG,QAASzuB,KAAK00B,eAEpFJ,EAAU34B,UAAUo7B,QAAU,WAC1B,IAAI1X,EAAWrf,KAAKy0B,WAAWN,MAC/B,QAAiBl4B,IAAbojB,EACA,MAAM,IAAI/hB,M5B7LmB,qC4B+LjC0C,KAAKwoB,mBAAqBnJ,EAASsJ,SACnC3oB,KAAK00B,YAAcrV,EAASyT,YAEhCwB,EAAU34B,UAAUq7B,YAAc,SAAUzC,GACxC,IAAIhZ,EAAQ,IAAI+Y,EAAUC,GAAoBv0B,KAAK3D,SAEnD,OADAkf,EAAM9Q,OAASzK,KACRub,GAEX+Y,EAAU34B,UAAUs7B,gBAAkB,WAElC,IADA,IAAIC,EAAc,GACTrd,EAAK,EAAGA,EAAK7V,UAAUxD,OAAQqZ,IACpCqd,EAAYrd,GAAM7V,UAAU6V,GAEhC,IAAIsd,EAAWn3B,KAAK00B,YAAe10B,KAAK00B,YAAc10B,KAAKo3B,kBAC3Dp3B,KAAK00B,YAAcwC,EAAYG,QAAO,SAAUC,EAAMC,GAAQ,OAAOA,EAAKD,KAAUH,IAExF7C,EAAU34B,UAAU67B,0BAA4B,SAAUtR,GACtDlmB,KAAK20B,gBAAkBzO,GAE3BoO,EAAU34B,UAAUf,IAAM,SAAU4pB,GAChC,OAAOxkB,KAAKy3B,MAAK,GAAO,EAAOjQ,EAAyBhD,IAE5D8P,EAAU34B,UAAU+7B,UAAY,SAAUlT,EAAmBlpB,EAAKN,GAC9D,OAAOgF,KAAKy3B,MAAK,GAAO,EAAOjQ,EAAyBhD,EAAmBlpB,EAAKN,IAEpFs5B,EAAU34B,UAAUg8B,SAAW,SAAUnT,EAAmBmS,GACxD,OAAO32B,KAAK03B,UAAUlT,EAAmB6D,EAAwBsO,IAErErC,EAAU34B,UAAUmF,OAAS,SAAU0jB,GACnC,OAAOxkB,KAAKy3B,MAAK,GAAM,EAAMjQ,EAAyBhD,IAE1D8P,EAAU34B,UAAUi8B,aAAe,SAAUpT,EAAmBlpB,EAAKN,GACjE,OAAOgF,KAAKy3B,MAAK,GAAO,EAAMjQ,EAAyBhD,EAAmBlpB,EAAKN,IAEnFs5B,EAAU34B,UAAUk8B,YAAc,SAAUrT,EAAmBmS,GAC3D,OAAO32B,KAAK43B,aAAapT,EAAmB6D,EAAwBsO,IAExErC,EAAU34B,UAAUoC,QAAU,SAAU+5B,GACpC,IAAIC,EAAgB/3B,KAAKg3B,cAEzB,OADAe,EAAcx8B,KAAKu8B,GAAqB/O,SACjCgP,EAAcn9B,IAAIk9B,IAE7BxD,EAAU34B,UAAU05B,kCAAoC,WACpD,IAAIj1B,EAAQJ,KACRg4B,EAAc,SAAUC,EAAiBt+B,GACzCs+B,EAAgB7H,SAASz2B,SAAWA,GAsBpCu+B,EAAoB,SAAUv+B,GAC9B,OAAO,SAAU6qB,GACb,IACIyT,EADU73B,EAAMi2B,OAAO96B,KAAK6E,EACV+3B,CAAQ3T,GAE9B,OADAwT,EAAYC,EAAiBt+B,GACtBs+B,IAGf,OAAO,SAAUG,GAAO,MAAQ,CAC5B1C,cA7B4B/7B,EA6BEy+B,EA5BvB,SAAU5T,GACb,IACIyT,EADQ73B,EAAM7E,KAAKA,KAAK6E,EACNi4B,CAAM7T,GAE5B,OADAwT,EAAYC,EAAiBt+B,GACtBs+B,IAyBXrC,gBAfO,SAAUpR,GAEb,OADepkB,EAAMo2B,QAAQj7B,KAAK6E,EAC3Bk4B,CAAS9T,IAcpBqR,eAAgBqC,EAAkBE,GAClCzC,eAvBO,SAAUnR,GACCpkB,EAAMk2B,OAAO/6B,KAAK6E,EAChCm4B,CAAQ/T,KAXM,IAAU7qB,IAmCpC26B,EAAU34B,UAAU87B,KAAO,SAAU/O,EAAkByC,EAAeC,EAAY5G,EAAmBlpB,EAAKN,GACtG,IAAIsZ,EAAS,KACTkkB,EAAc,CACd9P,iBAAkBA,EAClB+P,mBAAoB,SAAUz8B,GAAW,OAAOA,GAChDmvB,cAAeA,EACf7vB,IAAKA,EACLkpB,kBAAmBA,EACnB4G,WAAYA,EACZpwB,MAAOA,GAEX,GAAIgF,KAAK00B,aAEL,GAAIpgB,OADJA,EAAStU,KAAK00B,YAAY8D,IAEtB,MAAM,IAAIl7B,M5B9Ra,mE4BkS3BgX,EAAStU,KAAKo3B,iBAALp3B,CAAuBw4B,GAEpC,OAAOlkB,GAEXggB,EAAU34B,UAAUy7B,gBAAkB,WAClC,IAAIh3B,EAAQJ,KACZ,OAAO,SAAU04B,GACb,IAAI18B,EAAUkvB,EAAK9qB,EAAMu0B,gBAAiBv0B,EAAOs4B,EAAKvN,cAAeuN,EAAKtN,WAAYsN,EAAKlU,kBAAmBkU,EAAKp9B,IAAKo9B,EAAK19B,MAAO09B,EAAKhQ,kBAGzI,OADa3qB,EADb/B,EAAU08B,EAAKD,mBAAmBz8B,MAKnCs4B,EAjRM,GtBhDb5G,GAAY5yB,OAAO69B,IAAI,auBcZC,GAbf,SAAuBlU,EAAW+I,GAM9B,YALgB,IAAZA,IAAsBA,GAAU,GAK7B,CACHoL,WvBeR,SAAqCnU,EAAW+I,GAC5C,OAAO,SAAUjJ,GACb,OAAO,SAAU9jB,EAAOpF,GAIpBkyB,EAAa9sB,EAAOpF,GAHN,WACV,OAAOopB,EAAU9pB,IAAI4pB,KAESiJ,KuB1BzBqL,CAA4BpU,EAAW+I,GAMpDsL,gBvBwBR,SAA0CrU,EAAW+I,GACjD,OAAO,SAAUjJ,EAAmBmS,GAChC,OAAO,SAAUj2B,EAAOpF,GAIpBkyB,EAAa9sB,EAAOpF,GAHN,WACV,OAAOopB,EAAUiT,SAASnT,EAAmBmS,KAEflJ,KuBnCpBuL,CAAiCtU,EAAW+I,GAM9DwL,iBvBiCR,SAA2CvU,EAAW+I,GAClD,OAAO,SAAUjJ,EAAmBlpB,EAAKN,GACrC,OAAO,SAAU0F,EAAOurB,GAIpBuB,EAAa9sB,EAAOurB,GAHN,WACV,OAAOvH,EAAUgT,UAAUlT,EAAmBlpB,EAAKN,KAEZyyB,KuB5C5ByL,CAAkCxU,EAAW+I,GAMhE0L,gBvB0CR,SAA0CzU,EAAW+I,GACjD,OAAO,SAAUjJ,GACb,OAAO,SAAU9jB,EAAOpF,GAIpBkyB,EAAa9sB,EAAOpF,GAHN,WACV,OAAOopB,EAAU5jB,OAAO0jB,KAEMiJ,KuBrDpB2L,CAAiC1U,EAAW+I,K,ICHjD4L,GCAV,SAAUtnB,GACb,GAAIF,QAAQynB,eAAejR,EAA0BtW,GACjD,MAAM,IAAIzU,M/BLuB,sD+BOrC,IAAIi8B,EAAQ1nB,QAAQua,YAAY/D,EAAiCtW,IAAW,GAE5E,OADAF,QAAQ8b,eAAetF,EAA0BkR,EAAOxnB,GACjDA,E,GDPf,MACoC,mBAChCynB,iBAA2C,GAC3CC,MAAMn+B,EAAaN,GACfgF,KAAK05B,kBAAkBC,QAAQr+B,EAAKyoB,KAAK6V,UAAU5+B,IAGvD6+B,UAAUv+B,GACN,MAAMw+B,EAAa95B,KAAK05B,kBAAkBK,QAAQz+B,GAClD,OAAOw+B,EAAa/V,KAAKC,MAAM8V,GAAc,KAGhDJ,kBACG,OAAIM,WAAU,aACHC,aAEJj6B,KAAKk6B,qBAGfA,qBACG,MAAO,CACHP,QAAS,CAACr+B,EAAaN,KACnBgF,KAAKw5B,iBAAiBl+B,GAAON,GAEjC++B,QAAUz+B,GACC0E,KAAKw5B,iBAAiBl+B,Q,mBEAtC,MAAMopB,GAAY,IAAI4P,GAAU,CAAExL,oBAAoB,IAE7DpE,GAAUnpB,KAAK,kBAAkB02B,GAAGoH,IAAgBzH,mBAEpDlN,GAAUnpB,KAAK,gBAAgB42B,eAAgBn2B,IACpCyB,gBAGXinB,GAAUnpB,KAAK,wBAAwBk3B,WAA2Dz2B,KAC9F8L,QAAQC,IAAI,6CACL,IACItK,iBAOf,IAAMo7B,WAAYsB,IAAuBvB,GAAclU,IAYhD,MAAMmU,IAXqC5f,GAWHkhB,GAVnC,IAAIzB,IAAgB,CACxB3mB,EACAka,KACGmO,KAEHnhB,MAAayf,EAAbzf,CAAmBlH,EAAQka,KAAiBmO,GACrC3/B,OAAO4/B,yBAAyBtoB,EAAQka,KAPvD,IAAkDhT,G,yBC1B7BqhB,I,GAEhBzB,GAAW,kB,GAEXA,GAAW,wB,GACXA,GAAW,gB,SALD,cAAkB3d,YAO/B3F,cACEglB,QADY,uGAEZv6B,KAAK+f,MAAQ,CACXya,aAAa,GAIjBva,qBAGI,GAAIjgB,KAAKy6B,aAAc,CACrB3yB,QAAQC,IAAI,iDAAkD,4DAC9D,IACE/H,KAAKy6B,aAAa9vB,KAAM+vB,IACtB5yB,QAAQC,IAAI,gEACZD,QAAQC,IAAI,6BAA8B2yB,EAAIpqB,MAAM1D,WAAWjC,KAAM2J,GAAgBxM,QAAQC,IAAIuM,OAChGzJ,MAAM/L,GAASgJ,QAAQC,IAAIjJ,IAC9B,MAAM67B,GACN7yB,QAAQC,IAAI4yB,KAMpB/a,cACE,OACE,mBAAKjZ,GAAG,c,kTCjDC2zB","file":"bundle.feee4.esm.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dc-extension-kmitchell-example/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"mdyV\");\n","import { ClientConnection } from 'message-event-channel';\nimport { HttpClient } from '../components/HttpClient';\nimport { Users } from '../components/Users';\nimport { InitOptions } from '../init';\nimport { Params } from '../models/Params';\n\nexport interface ExtensionOptions extends InitOptions {\n  connection: ClientConnection;\n}\n\nexport interface ContextObject {\n  category: string;\n  params: Params;\n}\n\nexport function isContextObject(context: unknown | ContextObject): context is ContextObject {\n  return (context as ContextObject)?.params?.installation !== undefined;\n}\n\nexport abstract class Extension<ContextObject> {\n  /**\n   * message-event-channel [[ClientConnection]] instance. Use to listen to any of the message-event-channel lifecycle events.\n   */\n  public readonly connection!: ClientConnection;\n\n  /**\n   * Client - used with [dc-management-sdk-js](https://github.com/amplience/dc-management-sdk-js) to make requests to dynamic-content\n   */\n  public client!: HttpClient;\n\n  /**\n   * Users - used to get the current user or all users under the company\n   */\n  public users!: Users;\n\n  constructor(protected readonly options: ExtensionOptions) {\n    this.connection = this.options.connection;\n    this.client = new HttpClient(this.connection);\n    this.users = new Users(this.connection);\n  }\n\n  public abstract setupContext(context: ContextObject): void;\n}\n","import { EXTENSION } from '../constants/Errors';\nimport { isContentFieldContextObject } from './content-field/ContentFieldContextObject';\nimport { ContentFieldExtension } from './content-field/ContentFieldExtension';\nimport { isDashboardContextObject } from './dashboard/DashboardContextObject';\nimport { DashboardExtension } from './dashboard/DashboardExtension';\nimport { ContextObject, Extension, ExtensionOptions } from './Extension';\n\nexport function extensionFactory<ExtensionType extends Extension<ContextObject>>(\n  context: unknown,\n  options: ExtensionOptions\n): ExtensionType {\n  let extension;\n\n  if (isContentFieldContextObject(context)) {\n    extension = new ContentFieldExtension(options);\n    extension.setupContext(context);\n  }\n  if (isDashboardContextObject(context)) {\n    extension = new DashboardExtension(options);\n    extension.setupContext(context);\n  }\n  if (!extension) {\n    throw new Error(EXTENSION.UNSUPPORTED_EXTENSION);\n  }\n\n  return (extension as unknown) as ExtensionType;\n}\n","import { FieldSchema } from '../../components/Field';\nimport { LocalesModel } from '../../models/Locales';\nimport { Params } from '../../models/Params';\nimport { ContextObject, isContextObject } from '../Extension';\n\nexport interface ContentFieldContextObject<ParamType extends Params = Params>\n  extends ContextObject {\n  contentItemId: string;\n  fieldSchema: FieldSchema<ParamType>;\n  params: ParamType;\n  locales: LocalesModel;\n  stagingEnvironment: string;\n  visualisation: string;\n  readOnly: boolean;\n}\n\nexport function isContentFieldContextObject(\n  context: unknown | ContentFieldContextObject\n): context is ContentFieldContextObject {\n  return (\n    isContextObject(context) &&\n    (context as ContentFieldContextObject).category === 'CONTENT_FIELD' &&\n    (context as ContentFieldContextObject)?.params?.instance !== undefined &&\n    (context as ContentFieldContextObject).contentItemId !== undefined &&\n    (context as ContentFieldContextObject).fieldSchema !== undefined &&\n    (context as ContentFieldContextObject).locales !== undefined &&\n    (context as ContentFieldContextObject).readOnly !== undefined &&\n    (context as ContentFieldContextObject).stagingEnvironment !== undefined &&\n    (context as ContentFieldContextObject).visualisation !== undefined\n  );\n}\n","import { Params } from '../../models/Params';\nimport { ContextObject, isContextObject } from '../Extension';\n\nexport interface DashboardContextObject<ParamType extends Params = Params> extends ContextObject {\n  hubId: string;\n  locationHref: string;\n  params: ParamType;\n}\n\nexport function isDashboardContextObject(\n  context: unknown | DashboardContextObject\n): context is DashboardContextObject {\n  return (\n    isContextObject(context) &&\n    (context as DashboardContextObject).category === 'DASHBOARD' &&\n    (context as DashboardContextObject).hubId !== undefined &&\n    (context as DashboardContextObject).locationHref !== undefined\n  );\n}\n","import { ClientConnection, MC_EVENTS } from 'message-event-channel';\nimport { ERRORS_INIT } from './constants/Errors';\nimport { CONTEXT } from './constants/Events';\nimport { Extension } from './extensions/Extension';\nimport { extensionFactory } from './extensions/ExtensionFactory';\n\nexport interface InitOptions {\n  window: Window;\n  connectionTimeout: number | boolean;\n  timeout: number | boolean;\n  debug: boolean;\n}\n\nconst defaultOptions: InitOptions = {\n  window: window,\n  connectionTimeout: false,\n  timeout: false,\n  debug: false,\n};\n\n/**\n * The method that starts it all\n *\n * @type FieldType This is the field model that the extension is acting on\n * @type Params The installation parameters and instance parameters provided from Dynamic Content\n * @param options The configuration object to change the behaviour of the extension\n *\n * @return Returns a promise that will resolve with a new [[SDK]] instance\n *\n * ```typescript\n * import { init } from 'dc-extensions-sdk';\n *\n * async function initialize() {\n *  const contentFieldExtension = await <ContentFieldExtension>init();\n *\n *  //.. setup extension\n * }\n * ```\n */\nexport async function init<ExtensionType extends Extension<{}>>(\n  options: Partial<InitOptions> = {}\n): Promise<ExtensionType> {\n  const mergedOptions: InitOptions = { ...defaultOptions, ...options };\n  const connection = new ClientConnection(mergedOptions);\n  return new Promise<ExtensionType>(async (resolve, reject) => {\n    connection.init();\n    connection.on(MC_EVENTS.CONNECTED, async () => {\n      let context;\n      try {\n        context = await connection.request(CONTEXT.GET, null, { timeout: false });\n      } catch (e) {\n        reject(new Error(ERRORS_INIT.CONTEXT));\n      }\n      try {\n        const extension: ExtensionType = extensionFactory(context, {\n          connection,\n          ...mergedOptions,\n        });\n        resolve(extension);\n      } catch (e) {\n        reject(e);\n      }\n    });\n    connection.on(MC_EVENTS.CONNECTION_TIMEOUT, () => {\n      reject(new Error(ERRORS_INIT.CONNECTION_TIMEOUT));\n    });\n  });\n}\n","(function(global) {\r\n  /**\r\n   * Polyfill URLSearchParams\r\n   *\r\n   * Inspired from : https://github.com/WebReflection/url-search-params/blob/master/src/url-search-params.js\r\n   */\r\n\r\n  var checkIfIteratorIsSupported = function() {\r\n    try {\r\n      return !!Symbol.iterator;\r\n    } catch (error) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n\r\n  var iteratorSupported = checkIfIteratorIsSupported();\r\n\r\n  var createIterator = function(items) {\r\n    var iterator = {\r\n      next: function() {\r\n        var value = items.shift();\r\n        return { done: value === void 0, value: value };\r\n      }\r\n    };\r\n\r\n    if (iteratorSupported) {\r\n      iterator[Symbol.iterator] = function() {\r\n        return iterator;\r\n      };\r\n    }\r\n\r\n    return iterator;\r\n  };\r\n\r\n  /**\r\n   * Search param name and values should be encoded according to https://url.spec.whatwg.org/#urlencoded-serializing\r\n   * encodeURIComponent() produces the same result except encoding spaces as `%20` instead of `+`.\r\n   */\r\n  var serializeParam = function(value) {\r\n    return encodeURIComponent(value).replace(/%20/g, '+');\r\n  };\r\n\r\n  var deserializeParam = function(value) {\r\n    return decodeURIComponent(String(value).replace(/\\+/g, ' '));\r\n  };\r\n\r\n  var polyfillURLSearchParams = function() {\r\n\r\n    var URLSearchParams = function(searchString) {\r\n      Object.defineProperty(this, '_entries', { writable: true, value: {} });\r\n      var typeofSearchString = typeof searchString;\r\n\r\n      if (typeofSearchString === 'undefined') {\r\n        // do nothing\r\n      } else if (typeofSearchString === 'string') {\r\n        if (searchString !== '') {\r\n          this._fromString(searchString);\r\n        }\r\n      } else if (searchString instanceof URLSearchParams) {\r\n        var _this = this;\r\n        searchString.forEach(function(value, name) {\r\n          _this.append(name, value);\r\n        });\r\n      } else if ((searchString !== null) && (typeofSearchString === 'object')) {\r\n        if (Object.prototype.toString.call(searchString) === '[object Array]') {\r\n          for (var i = 0; i < searchString.length; i++) {\r\n            var entry = searchString[i];\r\n            if ((Object.prototype.toString.call(entry) === '[object Array]') || (entry.length !== 2)) {\r\n              this.append(entry[0], entry[1]);\r\n            } else {\r\n              throw new TypeError('Expected [string, any] as entry at index ' + i + ' of URLSearchParams\\'s input');\r\n            }\r\n          }\r\n        } else {\r\n          for (var key in searchString) {\r\n            if (searchString.hasOwnProperty(key)) {\r\n              this.append(key, searchString[key]);\r\n            }\r\n          }\r\n        }\r\n      } else {\r\n        throw new TypeError('Unsupported input\\'s type for URLSearchParams');\r\n      }\r\n    };\r\n\r\n    var proto = URLSearchParams.prototype;\r\n\r\n    proto.append = function(name, value) {\r\n      if (name in this._entries) {\r\n        this._entries[name].push(String(value));\r\n      } else {\r\n        this._entries[name] = [String(value)];\r\n      }\r\n    };\r\n\r\n    proto.delete = function(name) {\r\n      delete this._entries[name];\r\n    };\r\n\r\n    proto.get = function(name) {\r\n      return (name in this._entries) ? this._entries[name][0] : null;\r\n    };\r\n\r\n    proto.getAll = function(name) {\r\n      return (name in this._entries) ? this._entries[name].slice(0) : [];\r\n    };\r\n\r\n    proto.has = function(name) {\r\n      return (name in this._entries);\r\n    };\r\n\r\n    proto.set = function(name, value) {\r\n      this._entries[name] = [String(value)];\r\n    };\r\n\r\n    proto.forEach = function(callback, thisArg) {\r\n      var entries;\r\n      for (var name in this._entries) {\r\n        if (this._entries.hasOwnProperty(name)) {\r\n          entries = this._entries[name];\r\n          for (var i = 0; i < entries.length; i++) {\r\n            callback.call(thisArg, entries[i], name, this);\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    proto.keys = function() {\r\n      var items = [];\r\n      this.forEach(function(value, name) {\r\n        items.push(name);\r\n      });\r\n      return createIterator(items);\r\n    };\r\n\r\n    proto.values = function() {\r\n      var items = [];\r\n      this.forEach(function(value) {\r\n        items.push(value);\r\n      });\r\n      return createIterator(items);\r\n    };\r\n\r\n    proto.entries = function() {\r\n      var items = [];\r\n      this.forEach(function(value, name) {\r\n        items.push([name, value]);\r\n      });\r\n      return createIterator(items);\r\n    };\r\n\r\n    if (iteratorSupported) {\r\n      proto[Symbol.iterator] = proto.entries;\r\n    }\r\n\r\n    proto.toString = function() {\r\n      var searchArray = [];\r\n      this.forEach(function(value, name) {\r\n        searchArray.push(serializeParam(name) + '=' + serializeParam(value));\r\n      });\r\n      return searchArray.join('&');\r\n    };\r\n\r\n\r\n    global.URLSearchParams = URLSearchParams;\r\n  };\r\n\r\n  var checkIfURLSearchParamsSupported = function() {\r\n    try {\r\n      var URLSearchParams = global.URLSearchParams;\r\n\r\n      return (new URLSearchParams('?a=1').toString() === 'a=1') && (typeof URLSearchParams.prototype.set === 'function');\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n  if (!checkIfURLSearchParamsSupported()) {\r\n    polyfillURLSearchParams();\r\n  }\r\n\r\n  var proto = global.URLSearchParams.prototype;\r\n\r\n  if (typeof proto.sort !== 'function') {\r\n    proto.sort = function() {\r\n      var _this = this;\r\n      var items = [];\r\n      this.forEach(function(value, name) {\r\n        items.push([name, value]);\r\n        if (!_this._entries) {\r\n          _this.delete(name);\r\n        }\r\n      });\r\n      items.sort(function(a, b) {\r\n        if (a[0] < b[0]) {\r\n          return -1;\r\n        } else if (a[0] > b[0]) {\r\n          return +1;\r\n        } else {\r\n          return 0;\r\n        }\r\n      });\r\n      if (_this._entries) { // force reset because IE keeps keys index\r\n        _this._entries = {};\r\n      }\r\n      for (var i = 0; i < items.length; i++) {\r\n        this.append(items[i][0], items[i][1]);\r\n      }\r\n    };\r\n  }\r\n\r\n  if (typeof proto._fromString !== 'function') {\r\n    Object.defineProperty(proto, '_fromString', {\r\n      enumerable: false,\r\n      configurable: false,\r\n      writable: false,\r\n      value: function(searchString) {\r\n        if (this._entries) {\r\n          this._entries = {};\r\n        } else {\r\n          var keys = [];\r\n          this.forEach(function(value, name) {\r\n            keys.push(name);\r\n          });\r\n          for (var i = 0; i < keys.length; i++) {\r\n            this.delete(keys[i]);\r\n          }\r\n        }\r\n\r\n        searchString = searchString.replace(/^\\?/, '');\r\n        var attributes = searchString.split('&');\r\n        var attribute;\r\n        for (var i = 0; i < attributes.length; i++) {\r\n          attribute = attributes[i].split('=');\r\n          this.append(\r\n            deserializeParam(attribute[0]),\r\n            (attribute.length > 1) ? deserializeParam(attribute[1]) : ''\r\n          );\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  // HTMLAnchorElement\r\n\r\n})(\r\n  (typeof global !== 'undefined') ? global\r\n    : ((typeof window !== 'undefined') ? window\r\n    : ((typeof self !== 'undefined') ? self : this))\r\n);\r\n\r\n(function(global) {\r\n  /**\r\n   * Polyfill URL\r\n   *\r\n   * Inspired from : https://github.com/arv/DOM-URL-Polyfill/blob/master/src/url.js\r\n   */\r\n\r\n  var checkIfURLIsSupported = function() {\r\n    try {\r\n      var u = new global.URL('b', 'http://a');\r\n      u.pathname = 'c%20d';\r\n      return (u.href === 'http://a/c%20d') && u.searchParams;\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n  };\r\n\r\n\r\n  var polyfillURL = function() {\r\n    var _URL = global.URL;\r\n\r\n    var URL = function(url, base) {\r\n      if (typeof url !== 'string') url = String(url);\r\n\r\n      // Only create another document if the base is different from current location.\r\n      var doc = document, baseElement;\r\n      if (base && (global.location === void 0 || base !== global.location.href)) {\r\n        doc = document.implementation.createHTMLDocument('');\r\n        baseElement = doc.createElement('base');\r\n        baseElement.href = base;\r\n        doc.head.appendChild(baseElement);\r\n        try {\r\n          if (baseElement.href.indexOf(base) !== 0) throw new Error(baseElement.href);\r\n        } catch (err) {\r\n          throw new Error('URL unable to set base ' + base + ' due to ' + err);\r\n        }\r\n      }\r\n\r\n      var anchorElement = doc.createElement('a');\r\n      anchorElement.href = url;\r\n      if (baseElement) {\r\n        doc.body.appendChild(anchorElement);\r\n        anchorElement.href = anchorElement.href; // force href to refresh\r\n      }\r\n\r\n      if (anchorElement.protocol === ':' || !/:/.test(anchorElement.href)) {\r\n        throw new TypeError('Invalid URL');\r\n      }\r\n\r\n      Object.defineProperty(this, '_anchorElement', {\r\n        value: anchorElement\r\n      });\r\n\r\n\r\n      // create a linked searchParams which reflect its changes on URL\r\n      var searchParams = new global.URLSearchParams(this.search);\r\n      var enableSearchUpdate = true;\r\n      var enableSearchParamsUpdate = true;\r\n      var _this = this;\r\n      ['append', 'delete', 'set'].forEach(function(methodName) {\r\n        var method = searchParams[methodName];\r\n        searchParams[methodName] = function() {\r\n          method.apply(searchParams, arguments);\r\n          if (enableSearchUpdate) {\r\n            enableSearchParamsUpdate = false;\r\n            _this.search = searchParams.toString();\r\n            enableSearchParamsUpdate = true;\r\n          }\r\n        };\r\n      });\r\n\r\n      Object.defineProperty(this, 'searchParams', {\r\n        value: searchParams,\r\n        enumerable: true\r\n      });\r\n\r\n      var search = void 0;\r\n      Object.defineProperty(this, '_updateSearchParams', {\r\n        enumerable: false,\r\n        configurable: false,\r\n        writable: false,\r\n        value: function() {\r\n          if (this.search !== search) {\r\n            search = this.search;\r\n            if (enableSearchParamsUpdate) {\r\n              enableSearchUpdate = false;\r\n              this.searchParams._fromString(this.search);\r\n              enableSearchUpdate = true;\r\n            }\r\n          }\r\n        }\r\n      });\r\n    };\r\n\r\n    var proto = URL.prototype;\r\n\r\n    var linkURLWithAnchorAttribute = function(attributeName) {\r\n      Object.defineProperty(proto, attributeName, {\r\n        get: function() {\r\n          return this._anchorElement[attributeName];\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement[attributeName] = value;\r\n        },\r\n        enumerable: true\r\n      });\r\n    };\r\n\r\n    ['hash', 'host', 'hostname', 'port', 'protocol']\r\n      .forEach(function(attributeName) {\r\n        linkURLWithAnchorAttribute(attributeName);\r\n      });\r\n\r\n    Object.defineProperty(proto, 'search', {\r\n      get: function() {\r\n        return this._anchorElement['search'];\r\n      },\r\n      set: function(value) {\r\n        this._anchorElement['search'] = value;\r\n        this._updateSearchParams();\r\n      },\r\n      enumerable: true\r\n    });\r\n\r\n    Object.defineProperties(proto, {\r\n\r\n      'toString': {\r\n        get: function() {\r\n          var _this = this;\r\n          return function() {\r\n            return _this.href;\r\n          };\r\n        }\r\n      },\r\n\r\n      'href': {\r\n        get: function() {\r\n          return this._anchorElement.href.replace(/\\?$/, '');\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement.href = value;\r\n          this._updateSearchParams();\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'pathname': {\r\n        get: function() {\r\n          return this._anchorElement.pathname.replace(/(^\\/?)/, '/');\r\n        },\r\n        set: function(value) {\r\n          this._anchorElement.pathname = value;\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'origin': {\r\n        get: function() {\r\n          // get expected port from protocol\r\n          var expectedPort = { 'http:': 80, 'https:': 443, 'ftp:': 21 }[this._anchorElement.protocol];\r\n          // add port to origin if, expected port is different than actual port\r\n          // and it is not empty f.e http://foo:8080\r\n          // 8080 != 80 && 8080 != ''\r\n          var addPortToOrigin = this._anchorElement.port != expectedPort &&\r\n            this._anchorElement.port !== '';\r\n\r\n          return this._anchorElement.protocol +\r\n            '//' +\r\n            this._anchorElement.hostname +\r\n            (addPortToOrigin ? (':' + this._anchorElement.port) : '');\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'password': { // TODO\r\n        get: function() {\r\n          return '';\r\n        },\r\n        set: function(value) {\r\n        },\r\n        enumerable: true\r\n      },\r\n\r\n      'username': { // TODO\r\n        get: function() {\r\n          return '';\r\n        },\r\n        set: function(value) {\r\n        },\r\n        enumerable: true\r\n      },\r\n    });\r\n\r\n    URL.createObjectURL = function(blob) {\r\n      return _URL.createObjectURL.apply(_URL, arguments);\r\n    };\r\n\r\n    URL.revokeObjectURL = function(url) {\r\n      return _URL.revokeObjectURL.apply(_URL, arguments);\r\n    };\r\n\r\n    global.URL = URL;\r\n\r\n  };\r\n\r\n  if (!checkIfURLIsSupported()) {\r\n    polyfillURL();\r\n  }\r\n\r\n  if ((global.location !== void 0) && !('origin' in global.location)) {\r\n    var getOrigin = function() {\r\n      return global.location.protocol + '//' + global.location.hostname + (global.location.port ? (':' + global.location.port) : '');\r\n    };\r\n\r\n    try {\r\n      Object.defineProperty(global.location, 'origin', {\r\n        get: getOrigin,\r\n        enumerable: true\r\n      });\r\n    } catch (e) {\r\n      setInterval(function() {\r\n        global.location.origin = getOrigin();\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n})(\r\n  (typeof global !== 'undefined') ? global\r\n    : ((typeof window !== 'undefined') ? window\r\n    : ((typeof self !== 'undefined') ? self : this))\r\n);\r\n","export interface Promises {\n  [key: string]: MPromise;\n}\n\nexport interface MPromise {\n  resolve: Function;\n  reject: Function;\n}\n\nexport interface Emits {\n  [key: string]: Function[];\n}\n\nexport interface EmitMessage {\n  type: MESSAGE_TYPE.EMIT;\n  event: string;\n  payload?: any;\n}\n\nexport interface RequestMessage {\n  type: MESSAGE_TYPE.REQUEST;\n  id: string;\n  event: string;\n  payload?: any;\n}\n\nexport interface ResolveMessage {\n  type: MESSAGE_TYPE.RESOLVE;\n  id: string;\n  event: string;\n  payload: any;\n}\n\nexport interface RejectMessage {\n  type: MESSAGE_TYPE.REJECT;\n  id: string;\n  event: string;\n  payload: any;\n}\n/**\n * Options for the connection.\n */\nexport interface ConnectionOptions {\n  window?: Window;\n  timeout?: number;\n  connectionTimeout?: number;\n  debug?: boolean;\n  onload?: boolean;\n  clientInitiates?: boolean;\n  targetOrigin?: string;\n}\n\nexport interface RequestOptions {\n  timeout?: number | boolean;\n}\n\nexport interface ConnectionSettings {\n  window: Window;\n  timeout: number | boolean;\n  connectionTimeout: number | boolean;\n  debug: boolean;\n  onload: boolean;\n  clientInitiates: boolean;\n  targetOrigin: string;\n}\n\ntype Message = ResolveMessage | RejectMessage | EmitMessage | RequestMessage;\n\ndeclare global {\n  interface Window {\n    msCrypto: Crypto;\n  }\n}\n\n/**\n * The set of possible message types.\n */\nexport enum MESSAGE_TYPE {\n  SUBSCRIBE = 'subscribe',\n  EMIT = 'emit',\n  REQUEST = 'request',\n  RESOLVE = 'resolve',\n  REJECT = 'reject'\n}\n\n/**\n * The set of internally used event triggers that can be bound to.\n */\nexport enum MC_EVENTS {\n  HANDSHAKE = 'mc-handshake',\n  CONNECTED = 'mc-connected',\n  DISCONNECTED = 'mc-disconnected',\n  CONNECTION_TIMEOUT = 'mc-connection-timeout'\n}\n/**\n * Connection Base Class.\n *\n * It is used to provide the shared functionality of [[ServerConnection]] and [[ClientConnection]]\n *\n */\nexport class Connection {\n  /**\n   * Indicates if a connection has been established\n   */\n  public connected: boolean = false;\n  public id!: string | null;\n  protected port!: MessagePort;\n  private backlog: Array<Message> = [];\n  protected promises: Promises = {};\n  private emitters: Emits = {};\n  protected options: ConnectionSettings;\n  protected connectionTimeout!: number;\n  protected connectionStep: string = '';\n  protected messageListener!: any;\n  protected readonly defaultOptions: ConnectionSettings = {\n    window: window,\n    connectionTimeout: 2000,\n    timeout: 200,\n    debug: false,\n    onload: true,\n    clientInitiates: false,\n    targetOrigin: '*'\n  };\n\n  /**\n   * Creates a Connection instance.\n   * @param options Connection configuration options\n   * @param options.timeout Default request timeout (ms). This will trigger a reject on a any request that takes longer than this value. 200ms by default.\n   * @param options.connectionTimeout Connection timeout (ms). This will trigger the CONNECTION_TIMEOUT if a connection hasn't been established by this time.\n   * @param options.debug Enabling uses console.log to output what MC is doing behind the scenes. Used for debugging. Disabled by default.\n   * @param options.onload Uses the onload event of an iframe to trigger the process for creating a connection. If set to false the connection process needs to be triggered manually. Note a connection will only work if the child frame has loaded. Enabled by default.\n   * @param options.targetOrigin Limits the iframe to send messages to only the specified origins. '*' by Default.\n   * @param options.clientInitiates Awaits an postMessage (init) trigger from the child before it sets up and sends the MessageChannel port to the child. false by Default.\n   */\n  constructor(options: ConnectionOptions = {}) {\n    this.options = { ...this.defaultOptions, ...options };\n  }\n\n  /**\n   * This method will emit an event to its counterpart.\n   * @param event The name of the event to emit.\n   * @param payload Payload to be sent with the event.\n   * @return Returns Connection instance.\n   */\n  public emit(event: string, payload?: any) {\n    this.message({\n      type: MESSAGE_TYPE.EMIT,\n      event,\n      payload\n    });\n    return this;\n  }\n\n  /**\n   * Bind a callback to an event.\n   * @param event The name of the event to listen for.\n   * @param callback The function to call when the event is fired.\n   * @return Returns Connection instance.\n   */\n  public on(event: string, callback: Function) {\n    if (this.emitters[event] && Array.isArray(this.emitters[event])) {\n      this.emitters[event].push(callback);\n    } else {\n      this.emitters[event] = [callback];\n    }\n    return this;\n  }\n\n  /**\n   * Make a request of the counterpart. It will automatically reject the promise if the timeout time is exceeded.\n   * @param event The name of the event to emit\n   * @param payload Payload to be sent with the request\n   * @param options\n   * @param options.timeout Override for the default promise timeout, can be an interger or false\n   * @returns A promise that can resolve with any payload\n   */\n  public request<T = any>(event: string, payload?: any, options: RequestOptions = {}): Promise<T> {\n    return new Promise<any>((resolve, reject) => {\n      const uuid: string = this.uuidv4();\n      const timeout = this.getRequestTimeout(options.timeout);\n      let ct: number;\n      if (timeout !== false && typeof timeout === 'number') {\n        ct = window.setTimeout(() => reject('timeout'), timeout);\n      }\n      this.promises[uuid] = {\n        resolve: (resolvedData: T) => {\n          resolve(resolvedData);\n          if (ct) {\n            clearTimeout(ct);\n          }\n        },\n        reject: (error: any) => {\n          reject(error);\n          if (ct) {\n            clearTimeout(ct);\n          }\n        }\n      };\n      this.message({\n        type: MESSAGE_TYPE.REQUEST,\n        event: event,\n        id: uuid,\n        payload\n      });\n    });\n  }\n\n  /**\n   * Close the port being used to communicate. It will prevent any further messages being sent or received.\n   */\n  public close() {\n    if (this.connected) {\n      this.port.close();\n      this.connected = false;\n    }\n    if (this.messageListener) {\n      this.options.window.removeEventListener('message', this.messageListener, false);\n    }\n  }\n\n  protected setConnectionTimeout() {\n    clearTimeout(this.connectionTimeout);\n    if (this.options.connectionTimeout !== false) {\n      this.connectionTimeout = window.setTimeout(() => {\n        if (this.messageListener) {\n          this.options.window.removeEventListener('message', this.messageListener, false);\n        }\n        this.handleMessage({\n          type: MESSAGE_TYPE.EMIT,\n          event: MC_EVENTS.CONNECTION_TIMEOUT,\n          payload: { message: 'Connection timed out while ' + this.connectionStep }\n        });\n      }, Number(this.options.connectionTimeout));\n    }\n  }\n\n  protected uuidv4(): string {\n    const crypt = window.crypto || window.msCrypto;\n    return (([1e7] as any) + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (c: any) =>\n      (c ^ (crypt.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))).toString(16)\n    );\n  }\n\n  protected clearConnectionTimeout() {\n    clearTimeout(this.connectionTimeout);\n  }\n\n  protected initPortEvents() {\n    this.port.onmessage = message => {\n      this.handleMessage(message.data);\n    };\n    this.port.onmessageerror = error => {\n      this.handleError(error);\n    };\n  }\n\n  protected finishInit() {\n    this.connected = true;\n    this.clearConnectionTimeout();\n    if (this.options.debug) {\n      console.log(`Finished connection on ${this.isClient() ? 'client' : 'server'}`);\n    }\n    this.emit(MC_EVENTS.CONNECTED);\n    this.completeBacklog();\n  }\n\n  protected completeBacklog() {\n    this.backlog.forEach((message: Message) => {\n      this.portMessage(message);\n    });\n    this.backlog = [];\n  }\n\n  protected handleError(error: any) {\n    if (this.options.debug) {\n      console.error(error);\n    }\n  }\n\n  protected handleMessage(message: Message) {\n    if (this.options.debug) {\n      console.log(\n        `handle by ${this.isClient() ? 'client' : 'server'} - [${message.type}] \"${\n          message.event\n        }\", payload: `,\n        message.payload\n      );\n    }\n    switch (message.type) {\n      case MESSAGE_TYPE.EMIT:\n        if (!this.emitters[message.event] || !Array.isArray(this.emitters[message.event])) {\n          return;\n        }\n        this.emitters[message.event].forEach((cb: Function) => cb(message.payload));\n        break;\n      case MESSAGE_TYPE.REQUEST:\n        if (!this.emitters[message.event] || !Array.isArray(this.emitters[message.event])) {\n          return;\n        }\n        this.emitters[message.event].forEach((cb: Function) =>\n          cb(\n            message.payload,\n            (payload: any) => {\n              this.message({\n                id: message.id,\n                type: MESSAGE_TYPE.RESOLVE,\n                event: message.event,\n                payload\n              });\n            },\n            (payload: any) => {\n              this.message({\n                id: message.id,\n                type: MESSAGE_TYPE.REJECT,\n                event: message.event,\n                payload\n              });\n            }\n          )\n        );\n        break;\n      case MESSAGE_TYPE.RESOLVE:\n        if (!this.promises[message.id]) {\n          return;\n        }\n        this.promises[message.id].resolve(message.payload);\n        delete this.promises[message.id];\n        break;\n      case MESSAGE_TYPE.REJECT:\n        if (!this.promises[message.id]) {\n          return;\n        }\n        this.promises[message.id].reject(message.payload);\n        delete this.promises[message.id];\n        break;\n    }\n  }\n\n  protected getRequestTimeout(timeout: number | boolean | undefined): number | boolean {\n    if (typeof timeout === 'number' && timeout >= 0) {\n      return timeout;\n    } else if (typeof timeout === 'number') {\n      return 0;\n    } else if (timeout === true) {\n      return this.options.timeout;\n    } else if (timeout === false) {\n      return false;\n    } else {\n      return this.options.timeout;\n    }\n  }\n\n  protected isClient(): Boolean {\n    return false;\n  }\n\n  protected message(message: Message) {\n    let force = false;\n    if (\n      message.event === MC_EVENTS.HANDSHAKE ||\n      message.event === MC_EVENTS.CONNECTED ||\n      message.event === MC_EVENTS.DISCONNECTED\n    ) {\n      force = true;\n    }\n    if (!this.connected && !force) {\n      this.backlog.push(message);\n    } else if (this.port) {\n      this.portMessage(message);\n    }\n  }\n\n  private portMessage(message: Message) {\n    if (this.options.debug) {\n      console.log(\n        `send from ${this.isClient() ? 'client' : 'server'} - [${message.type}] \"${\n          message.event\n        }\", payload: `,\n        message.payload\n      );\n    }\n    this.port.postMessage(message);\n  }\n}\n","import { Connection, MC_EVENTS, MESSAGE_TYPE } from './Connection';\n\nenum CONNECTION_STEPS {\n  CONNECTION = 'waiting for connection.',\n  IFRAME_LOADING = 'waiting for iframe to load.',\n  INITIATION_FROM_CLIENT = 'waiting for initiation from client.'\n}\n\n/**\n * The parent side of the connection.\n */\nexport class ServerConnection extends Connection {\n  private channel!: MessageChannel;\n  protected connectionStep: CONNECTION_STEPS = CONNECTION_STEPS.CONNECTION;\n\n  /**\n   *\n   * @param frame The iframe target to setup the connection on.\n   * @param options Connection configuration options.\n   * @param options.timeout Default request timeout (ms). This will trigger a reject on a any request that takes longer than this value. 200ms by default.\n   * @param options.connectionTimeout Connection timeout (ms). This will trigger the CONNECTION_TIMEOUT if a connection hasn't been established by this time.\n   * @param options.debug Enabling uses console.log to output what MC is doing behind the scenes. Used for debugging. Disabled by default.\n   * @param options.onload Uses the onload event of an iframe to trigger the process for creating a connection. If set to false the connection process needs to be triggered manually. Note a connection will only work if the child frame has loaded. Enabled by default.\n   * @param options.targetOrigin Limits the iframe to send messages to only the specified origins. '*' by Default.\n   * @param options.clientInitiates Awaits an postMessage (init) trigger from the child before it sets up and sends the MessageChannel port to the child. false by Default.\n   */\n  constructor(protected frame: HTMLIFrameElement, options: any = {}) {\n    super(options);\n    if (this.options.onload) {\n      this.setupLoadInit();\n    }\n    if (this.options.clientInitiates) {\n      this.setupClientInit();\n    }\n    this.setConnectionTimeout();\n    this.on(MC_EVENTS.DISCONNECTED, () => this.close());\n  }\n\n  private clientInitiation(e: MessageEvent) {\n    if (e.data === this.id) {\n      this.connectionStep = CONNECTION_STEPS.CONNECTION;\n      this.setConnectionTimeout();\n      this.options.window.removeEventListener('message', this.messageListener, false);\n      if (this.options.debug) {\n        console.log('Server: Client triggered initiation');\n      }\n      this.init();\n    }\n  }\n\n  private setupLoadInit() {\n    this.connectionStep = CONNECTION_STEPS.IFRAME_LOADING;\n    this.frame.addEventListener('load', () => {\n      this.connectionStep = this.options.clientInitiates\n        ? CONNECTION_STEPS.INITIATION_FROM_CLIENT\n        : CONNECTION_STEPS.CONNECTION;\n      this.setConnectionTimeout();\n      this.init();\n    });\n  }\n\n  private setupClientInit() {\n    this.connectionStep = CONNECTION_STEPS.INITIATION_FROM_CLIENT;\n    this.id = this.uuidv4();\n    const url = new URL(this.frame.src);\n    url.searchParams.set('mc-name', this.id);\n    this.frame.src = url.toString();\n    this.messageListener = (e: MessageEvent) => this.clientInitiation(e);\n    this.options.window.addEventListener('message', this.messageListener);\n  }\n\n  /**\n   * Used to trigger the initiation of a connection manually. To be used if the onload, and clientInitiates options are disabled.\n   */\n  public init() {\n    if (!this.frame.contentWindow || !this.frame.src || this.connected) {\n      return false;\n    }\n    this.setupChannel();\n    this.initPortEvents();\n    this.listenForHandshake();\n    this.sendPortToClient(this.frame.contentWindow);\n  }\n\n  private sendPortToClient(client: Window) {\n    client.postMessage(null, this.options.targetOrigin ? this.options.targetOrigin : '*', [\n      this.channel.port2\n    ]);\n  }\n\n  private listenForHandshake() {\n    this.on(MC_EVENTS.HANDSHAKE, (payload: any, resolve: Function) => {\n      resolve(payload);\n      this.finishInit();\n    });\n  }\n\n  private setupChannel() {\n    this.channel = new MessageChannel();\n    this.port = this.channel.port1;\n  }\n}\n","import { Connection, MC_EVENTS } from './Connection';\n\nenum CONNECTION_STEPS {\n  CONNECTION = 'waiting for connection.',\n  HANDSHAKE = 'waiting for handshake.'\n}\n/**\n * The child side of a connection.\n */\nexport class ClientConnection extends Connection {\n  protected messageListener: any;\n  constructor(options: any = {}) {\n    super(options);\n    this.messageListener = (e: MessageEvent) => this.messageHandler(e);\n    this.options.window.addEventListener('message', this.messageListener);\n    if (this.options.connectionTimeout !== false) {\n      this.connectionStep = CONNECTION_STEPS.CONNECTION;\n      this.setConnectionTimeout();\n    }\n  }\n\n  public init() {\n    const url = new URL(this.options.window.location.toString());\n    this.id = url.searchParams.get('mc-name');\n    if (this.options.debug) {\n      console.log('Client: sent postMessage value:', this.id);\n    }\n    this.options.window.parent.postMessage(this.id, this.options.targetOrigin);\n  }\n\n  private messageHandler(e: MessageEvent) {\n    if (e.ports[0]) {\n      this.port = e.ports[0];\n      this.initPortEvents();\n      this.listenForHandshake();\n      this.options.window.removeEventListener('message', this.messageListener);\n    }\n  }\n\n  protected listenForHandshake() {\n    if (this.options.connectionTimeout !== false) {\n      this.connectionStep = CONNECTION_STEPS.HANDSHAKE;\n      this.setConnectionTimeout();\n    }\n    this.request(MC_EVENTS.HANDSHAKE, null, { timeout: false })\n      .then(() => {\n        this.addBeforeUnloadEvent();\n        this.finishInit();\n      })\n      .catch((e: any) => {\n        this.handleError(e);\n      });\n  }\n\n  protected addBeforeUnloadEvent() {\n    this.options.window.addEventListener('beforeunload', (event: BeforeUnloadEvent) => {\n      this.emit(MC_EVENTS.DISCONNECTED);\n      this.close();\n    });\n  }\n\n  protected isClient() {\n    return true;\n  }\n}\n","export enum ERRORS_INIT {\n  /**\n   * We failed to fetch all the necessary data for displaying a custom control\n   */\n  CONTEXT = 'Failed to fetch context for UI Extension',\n  /**\n   * Extension failed to connect to Dynamic content\n   */\n  CONNECTION_TIMEOUT = 'Failed to establish connection to DC Application',\n}\n\nexport enum ERRORS_CONTENT_ITEM {\n  /**\n   * Must supply content type ids in order to fetch a content item/reference\n   */\n  NO_IDS = 'Please provide content type ids',\n}\n\nexport enum ERRORS_FRAME {\n  /**\n   * Must supply a number or nothing, this normally means you've provided a type setHeight can't handle\n   */\n  SET_HEIGHT_NUMBER = 'setHeight() only accepts an optional number argument',\n}\n\nexport enum FORM {\n  /**\n   * This normally means you're in a context where there is no model to return i.e Schema Editor\n   */\n  NO_MODEL = 'Unable to retrieve form model as form context does not have an active model.',\n}\n\nexport enum EXTENSION {\n  /**\n   * This means you are trying to load an extension that isn't supported by this SDK version\n   */\n  UNSUPPORTED_EXTENSION = 'Unsupported extension',\n}\n\nexport enum APPLICATION_NAVIGATOR {\n  /**\n   * The location href must include a #!\n   */\n  MUST_INCLUDE_HASH_BANG = 'locationHref must include a hash bang (#!)',\n}\n","export enum CONTEXT {\n  GET = 'context-get',\n}\n\nexport enum CONTENT_ITEM {\n  GET = 'content-item-get',\n}\n\nexport enum MEDIA_LINK {\n  IMAGE_GET = 'media-image-get',\n  VIDEO_GET = 'media-video-get',\n}\n\nexport enum CONTENT_LINK {\n  CONTENT_GET = 'content-link-get',\n}\n\nexport enum CONTENT_REFERENCE {\n  CONTENT_REF_GET = 'content-reference-get',\n}\n\nexport enum FIELD {\n  MODEL_GET = 'field-model-get',\n  MODEL_SET = 'field-model-set',\n  MODEL_RESET = 'field-model-reset',\n  MODEL_IS_VALID = 'field-model-is-valid',\n  MODEL_VALIDATE = 'field-model-validate',\n  SCHEMA_GET = 'field-schema-get',\n}\n\nexport enum FORM {\n  READ_ONLY = 'form-read-only-change',\n  GET_FORM_MODEL = 'form-model-get',\n}\n\nexport enum FRAME {\n  HEIGHT_GET = 'height-get',\n  HEIGHT_SET = 'height-set',\n}\n","import { ClientConnection } from 'message-event-channel';\n\n/**\n * @hidden\n */\nexport interface HttpResponse {\n  status: number;\n  data: string | Record<string, unknown>;\n}\n\n/**\n * @hidden\n */\nexport enum HttpMethod {\n  GET = 'GET',\n  POST = 'POST',\n  PUT = 'PUT',\n  PATCH = 'PATCH',\n  DELETE = 'DELETE',\n}\n\n/**\n * @hidden\n */\nexport interface HttpRequest {\n  url: string;\n  method: HttpMethod;\n  data?: string | Record<string, unknown>;\n  headers?: { [key: string]: string };\n}\n\n/**\n * Client to be used with [dc-management-sdk-js](https://github.com/amplience/dc-management-sdk-js)\n *\n * You must have enabled your extension in Dynamic Content for this service to work\n *\n * ```typescript\n * import { init } from 'dc-extensions-sdk';\n * import { DynamicContent } from \"dc-management-sdk-js\";\n *\n * const dcExtension = await init();\n * const dcManagement = new DynamicContent(\n *  {},\n *  {},\n *  dcExtension.client\n * );\n *\n * const hubs = await dcManagement.hubs.list();\n * ```\n */\nexport class HttpClient {\n  private DEFAULT_ERROR = {\n    status: 403,\n    data: {\n      errors: [\n        {\n          code: 'UNKNOWN',\n          level: 'ERROR',\n          message: 'Unknown error',\n        },\n      ],\n    },\n  };\n\n  constructor(private connection: ClientConnection) {}\n\n  public async request(config: HttpRequest): Promise<HttpResponse> {\n    try {\n      const response = await this.connection.request<HttpResponse>('dc-management-sdk-js:request', {\n        data: config.data,\n        method: config.method,\n        headers: config.headers,\n        url: config.url,\n      });\n\n      return {\n        data: response.data,\n        status: response.status,\n      };\n    } catch (error) {\n      if (error) {\n        return {\n          data: error.data,\n          status: error.status,\n        };\n      }\n\n      return this.DEFAULT_ERROR;\n    }\n  }\n}\n","export enum LOCATION_HREF {\n  HASH_BANG = '#!',\n}\n","import { ClientConnection } from 'message-event-channel';\nimport { USERS_URL } from '../constants/Users';\nimport { HttpClient, HttpMethod, HttpResponse } from './HttpClient';\n\ninterface AuthUser {\n  id: string;\n  attributes: {\n    email: string;\n    'first-name': string;\n    'last-name': string;\n  };\n}\n\ninterface AuthUserResponse {\n  data: AuthUser[];\n}\n\nexport interface User {\n  id: string;\n  firstName: string;\n  lastName: string;\n  email: string;\n}\n\nexport class Users {\n  private client: HttpClient;\n\n  constructor(private connection: ClientConnection) {\n    this.client = new HttpClient(connection);\n  }\n\n  async list(): Promise<User[]> {\n    try {\n      const response: HttpResponse = await this.client.request({\n        url: USERS_URL,\n        method: HttpMethod.GET,\n      });\n\n      if (response.status !== 200) {\n        throw new Error(\n          `API responded with a non 200 status code. Error: ${\n            response.data || `status code ${response.status}`\n          }`\n        );\n      }\n\n      return (\n        ((response?.data as unknown) as AuthUserResponse)?.data?.map((user) =>\n          this.transformUser(user)\n        ) || []\n      );\n    } catch (error) {\n      throw new Error(`Unable to get users: ${error.message}`);\n    }\n  }\n\n  private transformUser(authUser: AuthUser): User {\n    return {\n      id: authUser.id,\n      firstName: authUser.attributes['first-name'],\n      lastName: authUser.attributes['last-name'],\n      email: authUser.attributes.email,\n    };\n  }\n}\n","export const USERS_URL = 'https://auth.amplience.net/users' as const;\n","import { ClientConnection } from 'message-event-channel';\nimport { CONTENT_ITEM } from '../constants/Events';\nimport { ContentItemModel } from '../models/ContentItemModel';\n\nexport class ContentItem {\n  /**\n   * Content Item - Used for retrieving Content Items.\n   *\n   * @param connection message-event-channel connection\n   */\n  constructor(private connection: ClientConnection) {}\n  /**\n   *\n   * @type ContentItemBody defines the shape of the data that is expected to be returned in the Content Item body\n   *\n   * Use to fetch the Content Item that is currently being edited. Returns a promise which will resolve to a [[ContentItemModel]]\n   *\n   * ### Example\n   * ```typescript\n   * try {\n   *   const contentItem = await sdk.contentItem.getCurrent();\n   *\n   *   console.log(contentItem)\n   * } catch (e) {\n   *   // In a context where contentItem doesn't exist yet\n   * }\n   *\n   * ```\n   */\n  async getCurrent<ContentItemBody = {}>(): Promise<ContentItemModel<ContentItemBody>> {\n    const contentItem = await this.connection.request(CONTENT_ITEM.GET);\n    return contentItem;\n  }\n}\n","import { ClientConnection } from 'message-event-channel';\nimport { CONTENT_LINK } from '../constants/Events';\nimport { ERRORS_CONTENT_ITEM } from '../constants/Errors';\nexport interface ContentItemLink {\n  _meta: {\n    schema: string;\n  };\n  id: string;\n  contentType: string;\n}\n\nexport interface ContentLinkOptions {\n  max?: number | null;\n}\nexport class ContentLink {\n  /**\n   * Content Link - Use to open the content browser.\n   *\n   * @param connection message-event-channel connection\n   */\n  constructor(private connection: ClientConnection) {}\n  /**\n   * This method will trigger a content browser. It returns a promise that will resolve to the chosen Content References.\n   *\n   * @param contentTypeIds list of Content Type Ids to filter the Content Browser by.\n   * @param options.max Max amount of selected contnet links\n   *\n   * ### Example\n   * ```typescript\n   * const enums = sdk.field.schema.allOf[1].properties.contentType.enum;\n   * const contentLink = await sdk.contentLink.getMultiple(enums);\n   *\n   * console.log(contentLink);\n   * ```\n   */\n  getMultiple(\n    contentTypeIds: Array<string>,\n    options: ContentLinkOptions = { max: null }\n  ): Promise<ContentItemLink[]> {\n    if (options.max === undefined) {\n      options.max = null;\n    }\n    return this.fetchLinks(contentTypeIds, options.max);\n  }\n  /**\n   * This method will trigger a content browser. It returns a promise that will resolve to the chosen Content Link.\n   *\n   * @param contentTypeIds list of Content Type Ids to filter the Content Browser by.\n   *\n   * ### Example\n   * ```typescript\n   * const enums = sdk.field.schema.allOf[1].properties.contentType.enum;\n   * const contentLink = await sdk.contentLink.get(enums);\n   *\n   * console.log(contentLink);\n   * ```\n   */\n  async get(contentTypeIds: Array<string>): Promise<ContentItemLink> {\n    return this.fetchLinks(contentTypeIds);\n  }\n\n  async fetchLinks(contentTypeIds: Array<string>, max?: number | null) {\n    if (!contentTypeIds || !Array.isArray(contentTypeIds) || !contentTypeIds.length) {\n      throw new Error(ERRORS_CONTENT_ITEM.NO_IDS);\n    }\n\n    const response = {\n      contentTypeIds,\n      ...((max !== undefined && { max }) || {}),\n    };\n\n    return this.connection.request(CONTENT_LINK.CONTENT_GET, response, {\n      timeout: false,\n    });\n  }\n}\n","import { ClientConnection } from 'message-event-channel';\nimport { ERRORS_CONTENT_ITEM } from '../constants/Errors';\nimport { CONTENT_REFERENCE } from '../constants/Events';\n\nexport interface ContentItemReference {\n  _meta: {\n    schema: string;\n  };\n  id: string;\n  contentType: string;\n}\n\nexport interface ContentReferenceOptions {\n  max?: number | null;\n}\n\nexport class ContentReference {\n  /**\n   * Content Link - Use to open the content browser.\n   *\n   * @param connection message-event-channel connection\n   */\n  constructor(private connection: ClientConnection) {}\n\n  /**\n   * This method will trigger a content browser. It returns a promise that will resolve to the chosen Content References.\n   *\n   * @param contentTypeIds list of Content Type Ids to filter the Content Browser by.\n   * @param options.max Max amount of selected contnet references\n   *\n   * ### Example\n   * ```typescript\n   * const enums = sdk.field.schema.allOf[1].properties.contentType.enum;\n   * const contentRef = await sdk.contentReference.get(enums);\n   *\n   * console.log(contentRef);\n   * ```\n   */\n  getMultiple(\n    contentTypeIds: Array<string>,\n    options: ContentReferenceOptions = { max: null }\n  ): Promise<ContentItemReference[]> {\n    return this.fetchReferences(contentTypeIds, options.max);\n  }\n  /**\n   * This method will trigger a content browser. It returns a promise that will resolve to the chosen Content Reference.\n   *\n   * @param contentTypeIds list of Content Type Ids to filter the Content Browser by.\n   *\n   * ### Example\n   * ```typescript\n   * const enums = sdk.field.schema.allOf[1].properties.contentType.enum;\n   * const contentRef = await sdk.contentReference.get(enums);\n   *\n   * console.log(contentRef);\n   * ```\n   */\n  async get(contentTypeIds: Array<string>): Promise<ContentItemReference> {\n    return this.fetchReferences(contentTypeIds);\n  }\n\n  private fetchReferences(contentTypeIds: Array<string>, max?: number | null) {\n    if (!contentTypeIds || !Array.isArray(contentTypeIds) || !contentTypeIds.length) {\n      throw new Error(ERRORS_CONTENT_ITEM.NO_IDS);\n    }\n\n    const response = {\n      contentTypeIds,\n      ...((max !== undefined && { max }) || {}),\n    };\n\n    return this.connection.request(CONTENT_REFERENCE.CONTENT_REF_GET, response, {\n      timeout: false,\n    });\n  }\n}\n","import { ClientConnection } from 'message-event-channel';\nimport { FIELD } from '../constants/Events';\nimport { ObjectMap } from '../models/ContentItemModel';\nimport { ErrorReport } from '../models/ErrorReport';\nimport { Params } from '../models/Params';\n\nexport type FieldSchema<ParamType extends Params = Params> = ObjectMap<{\n  title?: string;\n  type?: string;\n  description?: string;\n  ['ui:extension']: UiExtension<ParamType>;\n}>;\n\ninterface UiExtension<ParamType extends Params = Params> {\n  url?: string;\n  name?: string;\n  params?: ParamType['instance'];\n  height?: number;\n}\n\nexport class Field<FieldType = any, ParamType extends Params = Params> {\n  /**\n   * Allows you to perform actions on the field that is being edited.\n   *\n   * @param connection message-event-channel connection\n   * @param schema JSON Schema of the field\n   */\n  constructor(private connection: ClientConnection, public schema: FieldSchema<ParamType>) {}\n\n  /**\n   * Fetch the value of the field\n   *\n   * ### Example\n   * ```typescript\n   * const value = await sdk.field.getValue()\n   *\n   * console.log(value)\n   * ```\n   */\n  getValue(): Promise<FieldType> {\n    return this.connection.request(FIELD.MODEL_GET);\n  }\n\n  /**\n   * Change the value of the field\n   *\n   * @param value The new value you want to set on the field\n   * @throws Errors are thrown If the value is not set it throws an array of [[ErrorReport]]\n   * @returns\n   *\n   * ### Example\n   * ```typescript\n   * try {\n   *  await sdk.field.setValue({ propertyName1: 'hello world' })\n   * } catch(errors) {\n   *  // failed to set value returns error report\n   * }\n   * ```\n   */\n  async setValue(value?: FieldType): Promise<ErrorReport[] | void> {\n    const errors = await this.connection.request<ErrorReport[]>(FIELD.MODEL_SET, value);\n\n    if (errors && errors.length) {\n      return Promise.reject(errors);\n    }\n\n    return;\n  }\n  /**\n   * Check if your value is valid\n   *\n   * @param value The value you wish to test\n   *\n   * Gives the current validity of the field returns a boolean\n   *\n   * ### Example\n   * ```typescript\n   * const isValid = await sdk.field.isValid()\n   *\n   * console.log(isValid) // false\n   * ```\n   */\n  async isValid(value: FieldType): Promise<Boolean> {\n    const isValid = await this.connection.request<Boolean>(FIELD.MODEL_IS_VALID, value);\n\n    return isValid;\n  }\n\n  /**\n   * Check the validation of your value. Returns an array containing any JSON Schema errors found.\n   *\n   * @param value The value you whish to test\n   *\n   * If you want to validate a field model and get back an  error reports [[ErrorReport]]\n   *\n   * ### Example\n   * ```typescript\n   * const errors = await sdk.field.validate();\n   *\n   * if (errors && errors.length) {\n   *   errors.forEach(error => console.log(error));\n   * } else {\n   *   // valid\n   * }\n   * ```\n   */\n\n  async validate(value: FieldType): Promise<ErrorReport[] | void> {\n    const errors = await this.connection.request<ErrorReport[] | void>(FIELD.MODEL_VALIDATE, value);\n\n    return errors && errors.length ? errors : undefined;\n  }\n  /**\n   * Reset the value to the previously loaded state\n   *\n   * ### Example\n   * ```typescript\n   * const resetValue = await sdk.field.reset()\n   *\n   * // will be empty content or last saved content\n   * console.log(resetValue)\n   * ```\n   */\n  reset(): Promise<FieldType> {\n    return this.connection.request(FIELD.MODEL_RESET);\n  }\n}\n","import { FORM } from '../constants/Events';\nimport { FORM as ERRORS } from '../constants/Errors';\nimport { ClientConnection } from 'message-event-channel';\nimport { Body } from '../models/ContentItemModel';\n\nexport type onChangeHandler = (readonly: boolean) => void;\n\nexport class Form {\n  private onChangeStack: Array<onChangeHandler>;\n\n  constructor(private connection: ClientConnection, public readOnly: boolean) {\n    this.onChangeStack = [];\n\n    this.connection.on(FORM.READ_ONLY, (readonly: boolean) => {\n      this.readOnly = readonly;\n      this.onChangeStack.forEach((cb) => cb(this.readOnly));\n    });\n  }\n\n  /**\n   *\n   * Allows you to provide a callback to be executed after the readonly state changes. This method can be chained to append multiple callbacks.\n   *\n   * @param cb Callback function that executes upon readonly state change.\n   *\n   * @returns [[Form]]\n   *\n   * ### Example\n   * ```typescript\n   * const container = document.querySelector('.container');\n   * const inputs = Array.from(document.querySelectorAll('input'));\n   *\n   * sdk.form\n   *  .onReadOnlyChange(setReadOnlyClass)\n   *  .onReadOnlyChange(disableInputs)\n   *\n   * function disableInputs(readOnly)  {\n   *   inputs.forEach(input => {\n   *     input.style.pointerEvents = readOnly ? 'none' : ''\n   *   })\n   * }\n   *\n   * function setReadOnlyClass(readOnly) {\n   *   container.classList[readOnly ? 'add' : 'remove']('read-only')\n   * }\n   * ```\n   */\n  onReadOnlyChange(cb: onChangeHandler): Form {\n    this.onChangeStack.push(cb);\n    return this;\n  }\n\n  /**\n   * Get the current model state of all the fields in the form.\n   *\n   * @type FormModel is the entire parent model that will be a peer to this extension\n   *\n   * ### Example\n   * ```typescript\n   * try {\n   *   const value = await sdk.form.getValue();\n   *\n   *   console.log(value)\n   * } catch (e) {\n   *   // In a context where there is no form model\n   * }\n   * ```\n   */\n  async getValue<FormModel = {}>(): Promise<Body<FormModel>> {\n    try {\n      const value = await this.connection.request<Body<FormModel>>(FORM.GET_FORM_MODEL);\n\n      return value;\n    } catch (e) {\n      throw new Error(ERRORS.NO_MODEL);\n    }\n  }\n}\n","import { ClientConnection } from 'message-event-channel';\n\nimport { FRAME } from '../constants/Events';\nimport { ERRORS_FRAME } from '../constants/Errors';\nexport class Frame {\n  public isAutoResizing: boolean = false;\n  private previousHeight?: number;\n  private observer: MutationObserver = new MutationObserver(() => this.updateHeight());\n  private updateHeightHandler: () => void;\n\n  /**\n   * Use in order to control the re-sizing of the Extension\n   *\n   * @param connection message-event-channel connection\n   * @param win override the default window object\n   */\n  constructor(private connection: ClientConnection, private win: Window = window) {\n    const frameLoaded = new Promise((resolve) => {\n      if (win.document.readyState === 'complete') {\n        resolve(true);\n      }\n      win.addEventListener('load', () => {\n        resolve(true);\n      });\n    });\n\n    this.connection.on(FRAME.HEIGHT_GET, async (_payload: any, resolve: Function) => {\n      await frameLoaded;\n      resolve(this.getHeight());\n    });\n\n    this.updateHeightHandler = this.updateHeight.bind(this);\n  }\n\n  /**\n   * Get the height of the Extension\n   *\n   * Returns the extensions total height\n   *\n   * ### Example\n   * ```typescript\n   * const height = sdk.frame.getHeight()\n   *\n   * // 200\n   * console.log(height)\n   * ```\n   */\n  public getHeight(): number {\n    const { documentElement } = this.win.document;\n\n    if (documentElement) {\n      const { height } = documentElement.getBoundingClientRect();\n\n      return height;\n    }\n\n    return 0;\n  }\n\n  /**\n   * Set the height of the frame to the height of the Extension. Can optionally override the measured height with a defined value.\n   *\n   * @param height - should be used if you want to override the calculated height of your extension\n   *\n   * If no height is passed it will try get the extension height or default to 0\n   *\n   * ### Example\n   *\n   * ```typescript\n   * // sets height to extension height\n   * sdk.frame.setHeight()\n   * // sets height to 200\n   * sdk.frame.setHeight(200)\n   * ```\n   */\n  public setHeight(height?: number) {\n    if (height !== undefined && (typeof height as unknown) !== 'number') {\n      throw new TypeError(ERRORS_FRAME.SET_HEIGHT_NUMBER);\n    }\n\n    const h = height === undefined ? this.getHeight() : height;\n\n    this.previousHeight = height;\n    this.connection.emit(FRAME.HEIGHT_SET, h < 0 ? 0 : h);\n  }\n\n  /**\n   * Starts the auto-resizer\n   *\n   * It creates an event listener on resize and creates a mutation observer that updates\n   * the height when the body height changes you should clean up from this function on unmount\n   * to avoid memory leaks\n   *\n   * If called when already active it does nothing\n   *\n   * ### Example\n   * ```typescript\n   * sdk.frame.startAutoResizer();\n   * ```\n   */\n  public startAutoResizer() {\n    if (this.isAutoResizing) {\n      return;\n    }\n\n    this.isAutoResizing = true;\n\n    this.observer.observe(this.win.document.body, {\n      attributes: true,\n      childList: true,\n      subtree: true,\n      characterData: true,\n    });\n\n    this.win.addEventListener('resize', this.updateHeightHandler);\n  }\n\n  /**\n   * Stops the auto-resizer\n   *\n   * It tears down the event listeners and observers created from startAutoResizer should be\n   * called when you want to mannaully handle the height or when unmounting\n   *\n   * If called without autoResizer being active it does nothing\n   *\n   * ### Example\n   * ```typescript\n   * sdk.frame.stopAutoResizer();\n   * ```\n   */\n  public stopAutoResizer() {\n    if (!this.isAutoResizing) {\n      return;\n    }\n\n    this.isAutoResizing = false;\n    this.observer.disconnect();\n    this.win.removeEventListener('resize', this.updateHeightHandler);\n  }\n\n  private updateHeight() {\n    const height = this.getHeight();\n\n    if (height === this.previousHeight) {\n      return;\n    }\n\n    this.setHeight(height);\n  }\n}\n","import { ClientConnection } from 'message-event-channel';\nimport { MEDIA_LINK } from '../constants/Events';\nexport interface MediaImageLink {\n  _meta: {\n    schema: string;\n  };\n  id: string;\n  name: string;\n  endpoint: string;\n  defaultHost: string;\n}\nexport interface MediaVideoLink {\n  _meta: {\n    schema: string;\n  };\n}\n\nexport interface MediaOptions {\n  max: number | null;\n}\nexport class MediaLink {\n  /**\n   * Media Link - Use to open the media browser.\n   *\n   * @param connection message-event-channel connection\n   */\n  constructor(private connection: ClientConnection) {}\n  /**\n   * This method will trigger an image browser. It returns a promise that will resolve to the chosen Image Link.\n   *\n   * Example of fetching an image from DC\n   * ```typescript\n   * try {\n   *   // open browser and waits for image\n   *   // returns object that should be saved to the model\n   *   const image = await sdk.mediaLink.getImage()\n   *\n   * } catch (e) {\n   *   // no image returned\n   * }\n   * ```\n   *\n   * Example of displaying a image in your custom control\n   *\n   * ```typescript\n   * import { init } from 'dc-extensions-sdk';\n   * import { Image: ImageBuilder } from 'dc-delivery-sdk-js';\n   *\n   * async function start() {\n   *   const sdk = await init();\n   *   const img = document.querySelector('img');\n   *   const button = document.querySelector('button')\n   *\n   *   function onClick() {\n   *     sdk.mediaLink\n   *      .getImage()\n   *      .then(image => {\n   *         setImage(image)\n   *       })\n   *      .catch(err => console.log('not selected'));\n   *   }\n   *\n   *   function setImage(image) {\n   *      img.src = (\n   *         new ImageBuilder(image, { stagingEnvironment: sdk.stagingEnvironment })\n   *         .url()\n   *         .build()\n   *      )\n   *   }\n   *\n   *   button.onclick = onClick;\n   * }\n   *\n   * start()\n   * ```\n   */\n  getImage(): Promise<MediaImageLink> {\n    return this.connection.request(MEDIA_LINK.IMAGE_GET, null, {\n      timeout: false,\n    });\n  }\n  /**\n   * This method will trigger an image browser. It returns a promise that will resolve to the chosen Image Links.\n   *\n   * Example of fetching an image from DC\n   * ```typescript\n   * try {\n   *   // open browser and waits for image\n   *   // returns object that should be saved to the model\n   *   const images = await sdk.mediaLink.getImages({ max: 10 })\n   *\n   * } catch (e) {\n   *   // no image returned\n   * }\n   * ```\n   */\n  getImages({ max }: MediaOptions = { max: null }): Promise<MediaImageLink[]> {\n    return this.connection.request(MEDIA_LINK.IMAGE_GET, { max }, { timeout: false });\n  }\n  /**\n   * This method will trigger a video browser. It returns a promise that will resolve to the chosen Video Link.\n   *\n   * Example of fetching an video from DC\n   * ```typescript\n   * try {\n   *   // open browser and waits for video\n   *   // returns object that should be saved to the model\n   *   const video = await sdk.mediaLink.getVideo()\n   *\n   * } catch (e) {\n   *   // no video returned\n   * }\n   * ```\n   */\n  getVideo(): Promise<MediaVideoLink> {\n    return this.connection.request(MEDIA_LINK.VIDEO_GET, null, {\n      timeout: false,\n    });\n  }\n  /**\n   * This method will trigger a video browser. It returns a promise that will resolve to the chosen Video Links.\n   *\n   * Example of fetching an video from DC\n   * ```typescript\n   * try {\n   *   // open browser and waits for video\n   *   // returns object that should be saved to the model\n   *   const videos = await sdk.mediaLink.getVideos()\n   *\n   * } catch (e) {\n   *   // no video returned\n   * }\n   * ```\n   */\n  getVideos({ max }: MediaOptions = { max: null }): Promise<MediaVideoLink[]> {\n    return this.connection.request(\n      MEDIA_LINK.VIDEO_GET,\n      { max },\n      {\n        timeout: false,\n      }\n    );\n  }\n}\n","import { ContentItem } from '../../components/ContentItem';\nimport { ContentLink } from '../../components/ContentLink';\nimport { ContentReference } from '../../components/ContentReference';\nimport { Field } from '../../components/Field';\nimport { Form } from '../../components/Form';\nimport { Frame } from '../../components/Frame';\nimport { MediaLink } from '../../components/MediaLink';\nimport { LocalesModel } from '../../models/Locales';\nimport { Params } from '../../models/Params';\nimport { Extension, ExtensionOptions } from '../Extension';\nimport { ContentFieldContextObject } from './ContentFieldContextObject';\n\nexport class ContentFieldExtension<\n  FieldType = {},\n  ParamType extends Params = Params\n> extends Extension<ContentFieldContextObject<ParamType>> {\n  /**\n   * Content Item - The model of the Content Item that is being edited.\n   */\n  public contentItem!: ContentItem;\n  /**\n   * Field - Allows you to get and set the value of the field the extension is control of.\n   */\n  public field!: Field<FieldType, ParamType>;\n  /**\n   * Frame - Use to control the height sizing behaviour of your extension.\n   */\n  public frame!: Frame;\n  /**\n   * Params - optional parameters for your extension.\n   */\n  public params!: ParamType;\n  /**\n   * Locales - The locales you currently have available.\n   */\n  public locales!: LocalesModel;\n  /**\n   * Content Link - Use to open a content browser.\n   */\n  public contentLink: ContentLink;\n  /**\n   * Content Reference - Use to open a content browser.\n   */\n  public contentReference: ContentReference;\n  /**\n   * Media Link - Use to open a media browser.\n   */\n  public mediaLink: MediaLink;\n  /**\n   * Form - controls over the form such as readonly change handlers.\n   */\n  public form!: Form;\n  /**\n   * stagingEnvironment - Used for accessing staged assets.\n   */\n  public stagingEnvironment!: string;\n  /**\n   * Visualisation - URL of the visualisation\n   */\n  public visualisation!: string;\n\n  constructor(options: ExtensionOptions) {\n    super(options);\n\n    this.mediaLink = new MediaLink(this.connection);\n    this.contentLink = new ContentLink(this.connection);\n    this.contentReference = new ContentReference(this.connection);\n    this.frame = new Frame(this.connection, options.window);\n  }\n\n  setupContext(context: ContentFieldContextObject<ParamType>): void {\n    const { fieldSchema, params, locales, stagingEnvironment, readOnly, visualisation } = context;\n\n    this.contentItem = new ContentItem(this.connection);\n    this.field = new Field(this.connection, fieldSchema);\n    this.form = new Form(this.connection, readOnly);\n    this.params = params;\n    this.locales = locales;\n    this.visualisation = visualisation;\n    this.stagingEnvironment = stagingEnvironment;\n  }\n}\n","import { LOCATION_HREF } from '../constants/LocationHref';\nimport { APPLICATION_NAVIGATOR } from '../constants/Errors';\ninterface ContentItem {\n  id?: string;\n}\n\ninterface Event {\n  id?: string;\n}\n\ninterface Edition {\n  id?: string;\n  eventId?: string;\n}\n\nexport interface OpenOptions {\n  returnHref: boolean;\n}\n\nexport class ApplicationNavigator {\n  constructor(private readonly locationHref: string, private window: Window) {}\n\n  openEventsCalendar(options: Partial<OpenOptions> = {}): undefined | string {\n    return this.processHref(`${this.getBaseHref()}/planning/events/calendar`, options);\n  }\n\n  openEventsTimeline(options: Partial<OpenOptions> = {}): undefined | string {\n    return this.processHref(`${this.getBaseHref()}/planning/events/timeline`, options);\n  }\n\n  openEventsList(options: Partial<OpenOptions> = {}): undefined | string {\n    return this.processHref(`${this.getBaseHref()}/planning/events/list`, options);\n  }\n\n  openEvent(event: Event, options: Partial<OpenOptions> = {}): undefined | string {\n    return this.processHref(`${this.getBaseHref()}/planning/event/${event.id}`, options);\n  }\n\n  openEdition(edition: Edition, options: Partial<OpenOptions> = {}): undefined | string {\n    return this.processHref(\n      `${this.getBaseHref()}/planning/edition/${edition.eventId}/${edition.id}/`,\n      options\n    );\n  }\n\n  openContentLibrary(options: Partial<OpenOptions> = {}): undefined | string {\n    return this.processHref(`${this.getBaseHref()}/authoring/content-items`, options);\n  }\n\n  openContentItem(id: ContentItem, options: Partial<OpenOptions> = {}): undefined | string {\n    return this.processHref(`${this.getBaseHref()}/authoring/content-item/edit/${id.id}`, options);\n  }\n\n  private processHref(href: string, options: Partial<OpenOptions>): string | undefined {\n    if (options.returnHref) {\n      return href;\n    }\n    this.window.parent.location.href = href;\n  }\n\n  private getBaseHref() {\n    if (this.locationHref.indexOf(LOCATION_HREF.HASH_BANG) === -1) {\n      throw new Error(APPLICATION_NAVIGATOR.MUST_INCLUDE_HASH_BANG);\n    }\n\n    const [baseUrl, hash] = this.locationHref.split(LOCATION_HREF.HASH_BANG);\n    const hubName = hash.split('/')[1];\n    return `${baseUrl}${LOCATION_HREF.HASH_BANG}/${hubName}`;\n  }\n}\n","import { ApplicationNavigator } from '../../components/ApplicationNavigator';\nimport { Params } from '../../models/Params';\nimport { Extension, ExtensionOptions } from '../Extension';\nimport { DashboardContextObject } from './DashboardContextObject';\n\nexport class DashboardExtension<ParamType extends Params = Params> extends Extension<\n  DashboardContextObject<ParamType>\n> {\n  /**\n   * Params - optional parameters for your extension.\n   */\n  public params!: ParamType;\n  /**\n   * Hub Id - Id of the hub instantiating the Dashboard.\n   */\n  public hubId!: string;\n  /**\n   * Location Href - Href of the Dashboards parent container.\n   */\n  public locationHref!: string;\n  /**\n   * Application Navigator - Able to navigate the user to certain Dynamic Content related pages\n   */\n  public applicationNavigator!: ApplicationNavigator;\n\n  constructor(options: ExtensionOptions) {\n    super(options);\n  }\n\n  setupContext(context: DashboardContextObject<ParamType>) {\n    const { hubId, locationHref, params } = context;\n\n    this.hubId = hubId;\n    this.locationHref = locationHref;\n    this.params = params;\n    this.applicationNavigator = new ApplicationNavigator(this.locationHref, this.options.window);\n  }\n}\n","/*! *****************************************************************************\nCopyright (C) Microsoft. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */\nvar Reflect;\n(function (Reflect) {\n    // Metadata Proposal\n    // https://rbuckton.github.io/reflect-metadata/\n    (function (factory) {\n        var root = typeof global === \"object\" ? global :\n            typeof self === \"object\" ? self :\n                typeof this === \"object\" ? this :\n                    Function(\"return this;\")();\n        var exporter = makeExporter(Reflect);\n        if (typeof root.Reflect === \"undefined\") {\n            root.Reflect = Reflect;\n        }\n        else {\n            exporter = makeExporter(root.Reflect, exporter);\n        }\n        factory(exporter);\n        function makeExporter(target, previous) {\n            return function (key, value) {\n                if (typeof target[key] !== \"function\") {\n                    Object.defineProperty(target, key, { configurable: true, writable: true, value: value });\n                }\n                if (previous)\n                    previous(key, value);\n            };\n        }\n    })(function (exporter) {\n        var hasOwn = Object.prototype.hasOwnProperty;\n        // feature test for Symbol support\n        var supportsSymbol = typeof Symbol === \"function\";\n        var toPrimitiveSymbol = supportsSymbol && typeof Symbol.toPrimitive !== \"undefined\" ? Symbol.toPrimitive : \"@@toPrimitive\";\n        var iteratorSymbol = supportsSymbol && typeof Symbol.iterator !== \"undefined\" ? Symbol.iterator : \"@@iterator\";\n        var supportsCreate = typeof Object.create === \"function\"; // feature test for Object.create support\n        var supportsProto = { __proto__: [] } instanceof Array; // feature test for __proto__ support\n        var downLevel = !supportsCreate && !supportsProto;\n        var HashMap = {\n            // create an object in dictionary mode (a.k.a. \"slow\" mode in v8)\n            create: supportsCreate\n                ? function () { return MakeDictionary(Object.create(null)); }\n                : supportsProto\n                    ? function () { return MakeDictionary({ __proto__: null }); }\n                    : function () { return MakeDictionary({}); },\n            has: downLevel\n                ? function (map, key) { return hasOwn.call(map, key); }\n                : function (map, key) { return key in map; },\n            get: downLevel\n                ? function (map, key) { return hasOwn.call(map, key) ? map[key] : undefined; }\n                : function (map, key) { return map[key]; },\n        };\n        // Load global or shim versions of Map, Set, and WeakMap\n        var functionPrototype = Object.getPrototypeOf(Function);\n        var usePolyfill = typeof process === \"object\" && process.env && process.env[\"REFLECT_METADATA_USE_MAP_POLYFILL\"] === \"true\";\n        var _Map = !usePolyfill && typeof Map === \"function\" && typeof Map.prototype.entries === \"function\" ? Map : CreateMapPolyfill();\n        var _Set = !usePolyfill && typeof Set === \"function\" && typeof Set.prototype.entries === \"function\" ? Set : CreateSetPolyfill();\n        var _WeakMap = !usePolyfill && typeof WeakMap === \"function\" ? WeakMap : CreateWeakMapPolyfill();\n        // [[Metadata]] internal slot\n        // https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots\n        var Metadata = new _WeakMap();\n        /**\n         * Applies a set of decorators to a property of a target object.\n         * @param decorators An array of decorators.\n         * @param target The target object.\n         * @param propertyKey (Optional) The property key to decorate.\n         * @param attributes (Optional) The property descriptor for the target key.\n         * @remarks Decorators are applied in reverse order.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Example = Reflect.decorate(decoratorsArray, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.decorate(decoratorsArray, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.decorate(decoratorsArray, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Object.defineProperty(Example, \"staticMethod\",\n         *         Reflect.decorate(decoratorsArray, Example, \"staticMethod\",\n         *             Object.getOwnPropertyDescriptor(Example, \"staticMethod\")));\n         *\n         *     // method (on prototype)\n         *     Object.defineProperty(Example.prototype, \"method\",\n         *         Reflect.decorate(decoratorsArray, Example.prototype, \"method\",\n         *             Object.getOwnPropertyDescriptor(Example.prototype, \"method\")));\n         *\n         */\n        function decorate(decorators, target, propertyKey, attributes) {\n            if (!IsUndefined(propertyKey)) {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsObject(attributes) && !IsUndefined(attributes) && !IsNull(attributes))\n                    throw new TypeError();\n                if (IsNull(attributes))\n                    attributes = undefined;\n                propertyKey = ToPropertyKey(propertyKey);\n                return DecorateProperty(decorators, target, propertyKey, attributes);\n            }\n            else {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsConstructor(target))\n                    throw new TypeError();\n                return DecorateConstructor(decorators, target);\n            }\n        }\n        exporter(\"decorate\", decorate);\n        // 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n        // https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n        /**\n         * A default metadata decorator factory that can be used on a class, class member, or parameter.\n         * @param metadataKey The key for the metadata entry.\n         * @param metadataValue The value for the metadata entry.\n         * @returns A decorator function.\n         * @remarks\n         * If `metadataKey` is already defined for the target and target key, the\n         * metadataValue for that key will be overwritten.\n         * @example\n         *\n         *     // constructor\n         *     @Reflect.metadata(key, value)\n         *     class Example {\n         *     }\n         *\n         *     // property (on constructor, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticProperty;\n         *     }\n         *\n         *     // property (on prototype, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         property;\n         *     }\n         *\n         *     // method (on constructor)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticMethod() { }\n         *     }\n         *\n         *     // method (on prototype)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         method() { }\n         *     }\n         *\n         */\n        function metadata(metadataKey, metadataValue) {\n            function decorator(target, propertyKey) {\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsUndefined(propertyKey) && !IsPropertyKey(propertyKey))\n                    throw new TypeError();\n                OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n            }\n            return decorator;\n        }\n        exporter(\"metadata\", metadata);\n        /**\n         * Define a unique metadata entry on the target.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param metadataValue A value that contains attached metadata.\n         * @param target The target object on which to define metadata.\n         * @param propertyKey (Optional) The property key for the target.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"method\");\n         *\n         *     // decorator factory as metadata-producing annotation.\n         *     function MyAnnotation(options): Decorator {\n         *         return (target, key?) => Reflect.defineMetadata(\"custom:annotation\", options, target, key);\n         *     }\n         *\n         */\n        function defineMetadata(metadataKey, metadataValue, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n        }\n        exporter(\"defineMetadata\", defineMetadata);\n        /**\n         * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasMetadata\", hasMetadata);\n        /**\n         * Gets a value indicating whether the target object has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasOwnMetadata\", hasOwnMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object or its prototype chain.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getMetadata\", getMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getOwnMetadata\", getOwnMetadata);\n        /**\n         * Gets the metadata keys defined on the target object or its prototype chain.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getMetadataKeys\", getMetadataKeys);\n        /**\n         * Gets the unique metadata keys defined on the target object.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryOwnMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getOwnMetadataKeys\", getOwnMetadataKeys);\n        /**\n         * Deletes the metadata entry from the target object with the provided key.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata entry was found and deleted; otherwise, false.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function deleteMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            var metadataMap = GetOrCreateMetadataMap(target, propertyKey, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return false;\n            if (!metadataMap.delete(metadataKey))\n                return false;\n            if (metadataMap.size > 0)\n                return true;\n            var targetMetadata = Metadata.get(target);\n            targetMetadata.delete(propertyKey);\n            if (targetMetadata.size > 0)\n                return true;\n            Metadata.delete(target);\n            return true;\n        }\n        exporter(\"deleteMetadata\", deleteMetadata);\n        function DecorateConstructor(decorators, target) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsConstructor(decorated))\n                        throw new TypeError();\n                    target = decorated;\n                }\n            }\n            return target;\n        }\n        function DecorateProperty(decorators, target, propertyKey, descriptor) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target, propertyKey, descriptor);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsObject(decorated))\n                        throw new TypeError();\n                    descriptor = decorated;\n                }\n            }\n            return descriptor;\n        }\n        function GetOrCreateMetadataMap(O, P, Create) {\n            var targetMetadata = Metadata.get(O);\n            if (IsUndefined(targetMetadata)) {\n                if (!Create)\n                    return undefined;\n                targetMetadata = new _Map();\n                Metadata.set(O, targetMetadata);\n            }\n            var metadataMap = targetMetadata.get(P);\n            if (IsUndefined(metadataMap)) {\n                if (!Create)\n                    return undefined;\n                metadataMap = new _Map();\n                targetMetadata.set(P, metadataMap);\n            }\n            return metadataMap;\n        }\n        // 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\n        function OrdinaryHasMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return true;\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryHasMetadata(MetadataKey, parent, P);\n            return false;\n        }\n        // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\n        function OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return false;\n            return ToBoolean(metadataMap.has(MetadataKey));\n        }\n        // 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\n        function OrdinaryGetMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryGetMetadata(MetadataKey, parent, P);\n            return undefined;\n        }\n        // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\n        function OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return undefined;\n            return metadataMap.get(MetadataKey);\n        }\n        // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\n        function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ true);\n            metadataMap.set(MetadataKey, MetadataValue);\n        }\n        // 3.1.6.1 OrdinaryMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\n        function OrdinaryMetadataKeys(O, P) {\n            var ownKeys = OrdinaryOwnMetadataKeys(O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (parent === null)\n                return ownKeys;\n            var parentKeys = OrdinaryMetadataKeys(parent, P);\n            if (parentKeys.length <= 0)\n                return ownKeys;\n            if (ownKeys.length <= 0)\n                return parentKeys;\n            var set = new _Set();\n            var keys = [];\n            for (var _i = 0, ownKeys_1 = ownKeys; _i < ownKeys_1.length; _i++) {\n                var key = ownKeys_1[_i];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            for (var _a = 0, parentKeys_1 = parentKeys; _a < parentKeys_1.length; _a++) {\n                var key = parentKeys_1[_a];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            return keys;\n        }\n        // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\n        function OrdinaryOwnMetadataKeys(O, P) {\n            var keys = [];\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return keys;\n            var keysObj = metadataMap.keys();\n            var iterator = GetIterator(keysObj);\n            var k = 0;\n            while (true) {\n                var next = IteratorStep(iterator);\n                if (!next) {\n                    keys.length = k;\n                    return keys;\n                }\n                var nextValue = IteratorValue(next);\n                try {\n                    keys[k] = nextValue;\n                }\n                catch (e) {\n                    try {\n                        IteratorClose(iterator);\n                    }\n                    finally {\n                        throw e;\n                    }\n                }\n                k++;\n            }\n        }\n        // 6 ECMAScript Data Typ0es and Values\n        // https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values\n        function Type(x) {\n            if (x === null)\n                return 1 /* Null */;\n            switch (typeof x) {\n                case \"undefined\": return 0 /* Undefined */;\n                case \"boolean\": return 2 /* Boolean */;\n                case \"string\": return 3 /* String */;\n                case \"symbol\": return 4 /* Symbol */;\n                case \"number\": return 5 /* Number */;\n                case \"object\": return x === null ? 1 /* Null */ : 6 /* Object */;\n                default: return 6 /* Object */;\n            }\n        }\n        // 6.1.1 The Undefined Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-undefined-type\n        function IsUndefined(x) {\n            return x === undefined;\n        }\n        // 6.1.2 The Null Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-null-type\n        function IsNull(x) {\n            return x === null;\n        }\n        // 6.1.5 The Symbol Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-symbol-type\n        function IsSymbol(x) {\n            return typeof x === \"symbol\";\n        }\n        // 6.1.7 The Object Type\n        // https://tc39.github.io/ecma262/#sec-object-type\n        function IsObject(x) {\n            return typeof x === \"object\" ? x !== null : typeof x === \"function\";\n        }\n        // 7.1 Type Conversion\n        // https://tc39.github.io/ecma262/#sec-type-conversion\n        // 7.1.1 ToPrimitive(input [, PreferredType])\n        // https://tc39.github.io/ecma262/#sec-toprimitive\n        function ToPrimitive(input, PreferredType) {\n            switch (Type(input)) {\n                case 0 /* Undefined */: return input;\n                case 1 /* Null */: return input;\n                case 2 /* Boolean */: return input;\n                case 3 /* String */: return input;\n                case 4 /* Symbol */: return input;\n                case 5 /* Number */: return input;\n            }\n            var hint = PreferredType === 3 /* String */ ? \"string\" : PreferredType === 5 /* Number */ ? \"number\" : \"default\";\n            var exoticToPrim = GetMethod(input, toPrimitiveSymbol);\n            if (exoticToPrim !== undefined) {\n                var result = exoticToPrim.call(input, hint);\n                if (IsObject(result))\n                    throw new TypeError();\n                return result;\n            }\n            return OrdinaryToPrimitive(input, hint === \"default\" ? \"number\" : hint);\n        }\n        // 7.1.1.1 OrdinaryToPrimitive(O, hint)\n        // https://tc39.github.io/ecma262/#sec-ordinarytoprimitive\n        function OrdinaryToPrimitive(O, hint) {\n            if (hint === \"string\") {\n                var toString_1 = O.toString;\n                if (IsCallable(toString_1)) {\n                    var result = toString_1.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            else {\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var toString_2 = O.toString;\n                if (IsCallable(toString_2)) {\n                    var result = toString_2.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            throw new TypeError();\n        }\n        // 7.1.2 ToBoolean(argument)\n        // https://tc39.github.io/ecma262/2016/#sec-toboolean\n        function ToBoolean(argument) {\n            return !!argument;\n        }\n        // 7.1.12 ToString(argument)\n        // https://tc39.github.io/ecma262/#sec-tostring\n        function ToString(argument) {\n            return \"\" + argument;\n        }\n        // 7.1.14 ToPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-topropertykey\n        function ToPropertyKey(argument) {\n            var key = ToPrimitive(argument, 3 /* String */);\n            if (IsSymbol(key))\n                return key;\n            return ToString(key);\n        }\n        // 7.2 Testing and Comparison Operations\n        // https://tc39.github.io/ecma262/#sec-testing-and-comparison-operations\n        // 7.2.2 IsArray(argument)\n        // https://tc39.github.io/ecma262/#sec-isarray\n        function IsArray(argument) {\n            return Array.isArray\n                ? Array.isArray(argument)\n                : argument instanceof Object\n                    ? argument instanceof Array\n                    : Object.prototype.toString.call(argument) === \"[object Array]\";\n        }\n        // 7.2.3 IsCallable(argument)\n        // https://tc39.github.io/ecma262/#sec-iscallable\n        function IsCallable(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Call]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.4 IsConstructor(argument)\n        // https://tc39.github.io/ecma262/#sec-isconstructor\n        function IsConstructor(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Construct]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.7 IsPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-ispropertykey\n        function IsPropertyKey(argument) {\n            switch (Type(argument)) {\n                case 3 /* String */: return true;\n                case 4 /* Symbol */: return true;\n                default: return false;\n            }\n        }\n        // 7.3 Operations on Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-objects\n        // 7.3.9 GetMethod(V, P)\n        // https://tc39.github.io/ecma262/#sec-getmethod\n        function GetMethod(V, P) {\n            var func = V[P];\n            if (func === undefined || func === null)\n                return undefined;\n            if (!IsCallable(func))\n                throw new TypeError();\n            return func;\n        }\n        // 7.4 Operations on Iterator Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-iterator-objects\n        function GetIterator(obj) {\n            var method = GetMethod(obj, iteratorSymbol);\n            if (!IsCallable(method))\n                throw new TypeError(); // from Call\n            var iterator = method.call(obj);\n            if (!IsObject(iterator))\n                throw new TypeError();\n            return iterator;\n        }\n        // 7.4.4 IteratorValue(iterResult)\n        // https://tc39.github.io/ecma262/2016/#sec-iteratorvalue\n        function IteratorValue(iterResult) {\n            return iterResult.value;\n        }\n        // 7.4.5 IteratorStep(iterator)\n        // https://tc39.github.io/ecma262/#sec-iteratorstep\n        function IteratorStep(iterator) {\n            var result = iterator.next();\n            return result.done ? false : result;\n        }\n        // 7.4.6 IteratorClose(iterator, completion)\n        // https://tc39.github.io/ecma262/#sec-iteratorclose\n        function IteratorClose(iterator) {\n            var f = iterator[\"return\"];\n            if (f)\n                f.call(iterator);\n        }\n        // 9.1 Ordinary Object Internal Methods and Internal Slots\n        // https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots\n        // 9.1.1.1 OrdinaryGetPrototypeOf(O)\n        // https://tc39.github.io/ecma262/#sec-ordinarygetprototypeof\n        function OrdinaryGetPrototypeOf(O) {\n            var proto = Object.getPrototypeOf(O);\n            if (typeof O !== \"function\" || O === functionPrototype)\n                return proto;\n            // TypeScript doesn't set __proto__ in ES5, as it's non-standard.\n            // Try to determine the superclass constructor. Compatible implementations\n            // must either set __proto__ on a subclass constructor to the superclass constructor,\n            // or ensure each class has a valid `constructor` property on its prototype that\n            // points back to the constructor.\n            // If this is not the same as Function.[[Prototype]], then this is definately inherited.\n            // This is the case when in ES6 or when using __proto__ in a compatible browser.\n            if (proto !== functionPrototype)\n                return proto;\n            // If the super prototype is Object.prototype, null, or undefined, then we cannot determine the heritage.\n            var prototype = O.prototype;\n            var prototypeProto = prototype && Object.getPrototypeOf(prototype);\n            if (prototypeProto == null || prototypeProto === Object.prototype)\n                return proto;\n            // If the constructor was not a function, then we cannot determine the heritage.\n            var constructor = prototypeProto.constructor;\n            if (typeof constructor !== \"function\")\n                return proto;\n            // If we have some kind of self-reference, then we cannot determine the heritage.\n            if (constructor === O)\n                return proto;\n            // we have a pretty good guess at the heritage.\n            return constructor;\n        }\n        // naive Map shim\n        function CreateMapPolyfill() {\n            var cacheSentinel = {};\n            var arraySentinel = [];\n            var MapIterator = /** @class */ (function () {\n                function MapIterator(keys, values, selector) {\n                    this._index = 0;\n                    this._keys = keys;\n                    this._values = values;\n                    this._selector = selector;\n                }\n                MapIterator.prototype[\"@@iterator\"] = function () { return this; };\n                MapIterator.prototype[iteratorSymbol] = function () { return this; };\n                MapIterator.prototype.next = function () {\n                    var index = this._index;\n                    if (index >= 0 && index < this._keys.length) {\n                        var result = this._selector(this._keys[index], this._values[index]);\n                        if (index + 1 >= this._keys.length) {\n                            this._index = -1;\n                            this._keys = arraySentinel;\n                            this._values = arraySentinel;\n                        }\n                        else {\n                            this._index++;\n                        }\n                        return { value: result, done: false };\n                    }\n                    return { value: undefined, done: true };\n                };\n                MapIterator.prototype.throw = function (error) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    throw error;\n                };\n                MapIterator.prototype.return = function (value) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    return { value: value, done: true };\n                };\n                return MapIterator;\n            }());\n            return /** @class */ (function () {\n                function Map() {\n                    this._keys = [];\n                    this._values = [];\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                }\n                Object.defineProperty(Map.prototype, \"size\", {\n                    get: function () { return this._keys.length; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Map.prototype.has = function (key) { return this._find(key, /*insert*/ false) >= 0; };\n                Map.prototype.get = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    return index >= 0 ? this._values[index] : undefined;\n                };\n                Map.prototype.set = function (key, value) {\n                    var index = this._find(key, /*insert*/ true);\n                    this._values[index] = value;\n                    return this;\n                };\n                Map.prototype.delete = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    if (index >= 0) {\n                        var size = this._keys.length;\n                        for (var i = index + 1; i < size; i++) {\n                            this._keys[i - 1] = this._keys[i];\n                            this._values[i - 1] = this._values[i];\n                        }\n                        this._keys.length--;\n                        this._values.length--;\n                        if (key === this._cacheKey) {\n                            this._cacheKey = cacheSentinel;\n                            this._cacheIndex = -2;\n                        }\n                        return true;\n                    }\n                    return false;\n                };\n                Map.prototype.clear = function () {\n                    this._keys.length = 0;\n                    this._values.length = 0;\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                };\n                Map.prototype.keys = function () { return new MapIterator(this._keys, this._values, getKey); };\n                Map.prototype.values = function () { return new MapIterator(this._keys, this._values, getValue); };\n                Map.prototype.entries = function () { return new MapIterator(this._keys, this._values, getEntry); };\n                Map.prototype[\"@@iterator\"] = function () { return this.entries(); };\n                Map.prototype[iteratorSymbol] = function () { return this.entries(); };\n                Map.prototype._find = function (key, insert) {\n                    if (this._cacheKey !== key) {\n                        this._cacheIndex = this._keys.indexOf(this._cacheKey = key);\n                    }\n                    if (this._cacheIndex < 0 && insert) {\n                        this._cacheIndex = this._keys.length;\n                        this._keys.push(key);\n                        this._values.push(undefined);\n                    }\n                    return this._cacheIndex;\n                };\n                return Map;\n            }());\n            function getKey(key, _) {\n                return key;\n            }\n            function getValue(_, value) {\n                return value;\n            }\n            function getEntry(key, value) {\n                return [key, value];\n            }\n        }\n        // naive Set shim\n        function CreateSetPolyfill() {\n            return /** @class */ (function () {\n                function Set() {\n                    this._map = new _Map();\n                }\n                Object.defineProperty(Set.prototype, \"size\", {\n                    get: function () { return this._map.size; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Set.prototype.has = function (value) { return this._map.has(value); };\n                Set.prototype.add = function (value) { return this._map.set(value, value), this; };\n                Set.prototype.delete = function (value) { return this._map.delete(value); };\n                Set.prototype.clear = function () { this._map.clear(); };\n                Set.prototype.keys = function () { return this._map.keys(); };\n                Set.prototype.values = function () { return this._map.values(); };\n                Set.prototype.entries = function () { return this._map.entries(); };\n                Set.prototype[\"@@iterator\"] = function () { return this.keys(); };\n                Set.prototype[iteratorSymbol] = function () { return this.keys(); };\n                return Set;\n            }());\n        }\n        // naive WeakMap shim\n        function CreateWeakMapPolyfill() {\n            var UUID_SIZE = 16;\n            var keys = HashMap.create();\n            var rootKey = CreateUniqueKey();\n            return /** @class */ (function () {\n                function WeakMap() {\n                    this._key = CreateUniqueKey();\n                }\n                WeakMap.prototype.has = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.has(table, this._key) : false;\n                };\n                WeakMap.prototype.get = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.get(table, this._key) : undefined;\n                };\n                WeakMap.prototype.set = function (target, value) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ true);\n                    table[this._key] = value;\n                    return this;\n                };\n                WeakMap.prototype.delete = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? delete table[this._key] : false;\n                };\n                WeakMap.prototype.clear = function () {\n                    // NOTE: not a real clear, just makes the previous data unreachable\n                    this._key = CreateUniqueKey();\n                };\n                return WeakMap;\n            }());\n            function CreateUniqueKey() {\n                var key;\n                do\n                    key = \"@@WeakMap@@\" + CreateUUID();\n                while (HashMap.has(keys, key));\n                keys[key] = true;\n                return key;\n            }\n            function GetOrCreateWeakMapTable(target, create) {\n                if (!hasOwn.call(target, rootKey)) {\n                    if (!create)\n                        return undefined;\n                    Object.defineProperty(target, rootKey, { value: HashMap.create() });\n                }\n                return target[rootKey];\n            }\n            function FillRandomBytes(buffer, size) {\n                for (var i = 0; i < size; ++i)\n                    buffer[i] = Math.random() * 0xff | 0;\n                return buffer;\n            }\n            function GenRandomBytes(size) {\n                if (typeof Uint8Array === \"function\") {\n                    if (typeof crypto !== \"undefined\")\n                        return crypto.getRandomValues(new Uint8Array(size));\n                    if (typeof msCrypto !== \"undefined\")\n                        return msCrypto.getRandomValues(new Uint8Array(size));\n                    return FillRandomBytes(new Uint8Array(size), size);\n                }\n                return FillRandomBytes(new Array(size), size);\n            }\n            function CreateUUID() {\n                var data = GenRandomBytes(UUID_SIZE);\n                // mark as random - RFC 4122 § 4.4\n                data[6] = data[6] & 0x4f | 0x40;\n                data[8] = data[8] & 0xbf | 0x80;\n                var result = \"\";\n                for (var offset = 0; offset < UUID_SIZE; ++offset) {\n                    var byte = data[offset];\n                    if (offset === 4 || offset === 6 || offset === 8)\n                        result += \"-\";\n                    if (byte < 16)\n                        result += \"0\";\n                    result += byte.toString(16).toLowerCase();\n                }\n                return result;\n            }\n        }\n        // uses a heuristic used by v8 and chakra to force an object into dictionary mode.\n        function MakeDictionary(obj) {\n            obj.__ = undefined;\n            delete obj.__;\n            return obj;\n        }\n    });\n})(Reflect || (Reflect = {}));\n","/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\t// @ts-ignore We change the type of `obj` to be `O & P`\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Remove a child node from its parent if attached. This is a workaround for\n * IE11 which doesn't support `Element.prototype.remove()`. Using this function\n * is smaller than including a dedicated polyfill.\n * @param {Node} node The node to remove\n */\nexport function removeNode(node) {\n\tlet parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n","import options from './options';\n\n/**\n * Create an virtual node (used for JSX)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * constructor for this virtual node\n * @param {object | null | undefined} [props] The properties of the virtual node\n * @param {Array<import('.').ComponentChildren>} [children] The children of the virtual node\n * @returns {import('./internal').VNode}\n */\nexport function createElement(type, props, children) {\n\tlet normalizedProps = {},\n\t\tkey,\n\t\tref,\n\t\ti;\n\tfor (i in props) {\n\t\tif (i == 'key') key = props[i];\n\t\telse if (i == 'ref') ref = props[i];\n\t\telse normalizedProps[i] = props[i];\n\t}\n\n\tif (arguments.length > 3) {\n\t\tchildren = [children];\n\t\t// https://github.com/preactjs/preact/issues/1916\n\t\tfor (i = 3; i < arguments.length; i++) {\n\t\t\tchildren.push(arguments[i]);\n\t\t}\n\t}\n\tif (children != null) {\n\t\tnormalizedProps.children = children;\n\t}\n\n\t// If a Component VNode, check for and apply defaultProps\n\t// Note: type may be undefined in development, must never error here.\n\tif (typeof type == 'function' && type.defaultProps != null) {\n\t\tfor (i in type.defaultProps) {\n\t\t\tif (normalizedProps[i] === undefined) {\n\t\t\t\tnormalizedProps[i] = type.defaultProps[i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn createVNode(type, normalizedProps, key, ref, null);\n}\n\n/**\n * Create a VNode (used internally by Preact)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * Constructor for this virtual node\n * @param {object | string | number | null} props The properties of this virtual node.\n * If this virtual node represents a text node, this is the text of the node (string or number).\n * @param {string | number | null} key The key for this virtual node, used when\n * diffing it against its children\n * @param {import('./internal').VNode[\"ref\"]} ref The ref property that will\n * receive a reference to its created child\n * @returns {import('./internal').VNode}\n */\nexport function createVNode(type, props, key, ref, original) {\n\t// V8 seems to be better at detecting type shapes if the object is allocated from the same call site\n\t// Do not inline into createElement and coerceToVNode!\n\tconst vnode = {\n\t\ttype,\n\t\tprops,\n\t\tkey,\n\t\tref,\n\t\t_children: null,\n\t\t_parent: null,\n\t\t_depth: 0,\n\t\t_dom: null,\n\t\t// _nextDom must be initialized to undefined b/c it will eventually\n\t\t// be set to dom.nextSibling which can return `null` and it is important\n\t\t// to be able to distinguish between an uninitialized _nextDom and\n\t\t// a _nextDom that has been set to `null`\n\t\t_nextDom: undefined,\n\t\t_component: null,\n\t\t_hydrating: null,\n\t\tconstructor: undefined,\n\t\t_original: original == null ? ++options._vnodeId : original\n\t};\n\n\tif (options.vnode != null) options.vnode(vnode);\n\n\treturn vnode;\n}\n\nexport function createRef() {\n\treturn { current: null };\n}\n\nexport function Fragment(props) {\n\treturn props.children;\n}\n\n/**\n * Check if a the argument is a valid Preact VNode.\n * @param {*} vnode\n * @returns {vnode is import('./internal').VNode}\n */\nexport const isValidElement = vnode =>\n\tvnode != null && vnode.constructor === undefined;\n","import { assign } from './util';\nimport { diff, commitRoot } from './diff/index';\nimport options from './options';\nimport { Fragment } from './create-element';\n\n/**\n * Base Component class. Provides `setState()` and `forceUpdate()`, which\n * trigger rendering\n * @param {object} props The initial component props\n * @param {object} context The initial context from parent components'\n * getChildContext\n */\nexport function Component(props, context) {\n\tthis.props = props;\n\tthis.context = context;\n}\n\n/**\n * Update component state and schedule a re-render.\n * @this {import('./internal').Component}\n * @param {object | ((s: object, p: object) => object)} update A hash of state\n * properties to update with new values or a function that given the current\n * state and props returns a new partial state\n * @param {() => void} [callback] A function to be called once component state is\n * updated\n */\nComponent.prototype.setState = function(update, callback) {\n\t// only clone state when copying to nextState the first time.\n\tlet s;\n\tif (this._nextState != null && this._nextState !== this.state) {\n\t\ts = this._nextState;\n\t} else {\n\t\ts = this._nextState = assign({}, this.state);\n\t}\n\n\tif (typeof update == 'function') {\n\t\t// Some libraries like `immer` mark the current state as readonly,\n\t\t// preventing us from mutating it, so we need to clone it. See #2716\n\t\tupdate = update(assign({}, s), this.props);\n\t}\n\n\tif (update) {\n\t\tassign(s, update);\n\t}\n\n\t// Skip update if updater function returned null\n\tif (update == null) return;\n\n\tif (this._vnode) {\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Immediately perform a synchronous re-render of the component\n * @this {import('./internal').Component}\n * @param {() => void} [callback] A function to be called after component is\n * re-rendered\n */\nComponent.prototype.forceUpdate = function(callback) {\n\tif (this._vnode) {\n\t\t// Set render mode so that we can differentiate where the render request\n\t\t// is coming from. We need this because forceUpdate should never call\n\t\t// shouldComponentUpdate\n\t\tthis._force = true;\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n * Virtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n * @param {object} props Props (eg: JSX attributes) received from parent\n * element/component\n * @param {object} state The component's current state\n * @param {object} context Context object, as returned by the nearest\n * ancestor's `getChildContext()`\n * @returns {import('./index').ComponentChildren | void}\n */\nComponent.prototype.render = Fragment;\n\n/**\n * @param {import('./internal').VNode} vnode\n * @param {number | null} [childIndex]\n */\nexport function getDomSibling(vnode, childIndex) {\n\tif (childIndex == null) {\n\t\t// Use childIndex==null as a signal to resume the search from the vnode's sibling\n\t\treturn vnode._parent\n\t\t\t? getDomSibling(vnode._parent, vnode._parent._children.indexOf(vnode) + 1)\n\t\t\t: null;\n\t}\n\n\tlet sibling;\n\tfor (; childIndex < vnode._children.length; childIndex++) {\n\t\tsibling = vnode._children[childIndex];\n\n\t\tif (sibling != null && sibling._dom != null) {\n\t\t\t// Since updateParentDomPointers keeps _dom pointer correct,\n\t\t\t// we can rely on _dom to tell us if this subtree contains a\n\t\t\t// rendered DOM node, and what the first rendered DOM node is\n\t\t\treturn sibling._dom;\n\t\t}\n\t}\n\n\t// If we get here, we have not found a DOM node in this vnode's children.\n\t// We must resume from this vnode's sibling (in it's parent _children array)\n\t// Only climb up and search the parent if we aren't searching through a DOM\n\t// VNode (meaning we reached the DOM parent of the original vnode that began\n\t// the search)\n\treturn typeof vnode.type == 'function' ? getDomSibling(vnode) : null;\n}\n\n/**\n * Trigger in-place re-rendering of a component.\n * @param {import('./internal').Component} component The component to rerender\n */\nfunction renderComponent(component) {\n\tlet vnode = component._vnode,\n\t\toldDom = vnode._dom,\n\t\tparentDom = component._parentDom;\n\n\tif (parentDom) {\n\t\tlet commitQueue = [];\n\t\tconst oldVNode = assign({}, vnode);\n\t\toldVNode._original = vnode._original + 1;\n\n\t\tdiff(\n\t\t\tparentDom,\n\t\t\tvnode,\n\t\t\toldVNode,\n\t\t\tcomponent._globalContext,\n\t\t\tparentDom.ownerSVGElement !== undefined,\n\t\t\tvnode._hydrating != null ? [oldDom] : null,\n\t\t\tcommitQueue,\n\t\t\toldDom == null ? getDomSibling(vnode) : oldDom,\n\t\t\tvnode._hydrating\n\t\t);\n\t\tcommitRoot(commitQueue, vnode);\n\n\t\tif (vnode._dom != oldDom) {\n\t\t\tupdateParentDomPointers(vnode);\n\t\t}\n\t}\n}\n\n/**\n * @param {import('./internal').VNode} vnode\n */\nfunction updateParentDomPointers(vnode) {\n\tif ((vnode = vnode._parent) != null && vnode._component != null) {\n\t\tvnode._dom = vnode._component.base = null;\n\t\tfor (let i = 0; i < vnode._children.length; i++) {\n\t\t\tlet child = vnode._children[i];\n\t\t\tif (child != null && child._dom != null) {\n\t\t\t\tvnode._dom = vnode._component.base = child._dom;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn updateParentDomPointers(vnode);\n\t}\n}\n\n/**\n * The render queue\n * @type {Array<import('./internal').Component>}\n */\nlet rerenderQueue = [];\n\n/**\n * Asynchronously schedule a callback\n * @type {(cb: () => void) => void}\n */\n/* istanbul ignore next */\n// Note the following line isn't tree-shaken by rollup cuz of rollup/rollup#2566\nconst defer =\n\ttypeof Promise == 'function'\n\t\t? Promise.prototype.then.bind(Promise.resolve())\n\t\t: setTimeout;\n\n/*\n * The value of `Component.debounce` must asynchronously invoke the passed in callback. It is\n * important that contributors to Preact can consistently reason about what calls to `setState`, etc.\n * do, and when their effects will be applied. See the links below for some further reading on designing\n * asynchronous APIs.\n * * [Designing APIs for Asynchrony](https://blog.izs.me/2013/08/designing-apis-for-asynchrony)\n * * [Callbacks synchronous and asynchronous](https://blog.ometer.com/2011/07/24/callbacks-synchronous-and-asynchronous/)\n */\n\nlet prevDebounce;\n\n/**\n * Enqueue a rerender of a component\n * @param {import('./internal').Component} c The component to rerender\n */\nexport function enqueueRender(c) {\n\tif (\n\t\t(!c._dirty &&\n\t\t\t(c._dirty = true) &&\n\t\t\trerenderQueue.push(c) &&\n\t\t\t!process._rerenderCount++) ||\n\t\tprevDebounce !== options.debounceRendering\n\t) {\n\t\tprevDebounce = options.debounceRendering;\n\t\t(prevDebounce || defer)(process);\n\t}\n}\n\n/** Flush the render queue by rerendering all queued components */\nfunction process() {\n\tlet queue;\n\twhile ((process._rerenderCount = rerenderQueue.length)) {\n\t\tqueue = rerenderQueue.sort((a, b) => a._vnode._depth - b._vnode._depth);\n\t\trerenderQueue = [];\n\t\t// Don't update `renderCount` yet. Keep its value non-zero to prevent unnecessary\n\t\t// process() calls from getting scheduled while `queue` is still being consumed.\n\t\tqueue.some(c => {\n\t\t\tif (c._dirty) renderComponent(c);\n\t\t});\n\t}\n}\nprocess._rerenderCount = 0;\n","import { diff, unmount, applyRef } from './index';\nimport { createVNode, Fragment } from '../create-element';\nimport { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { getDomSibling } from '../component';\n\n/**\n * Diff the children of a virtual node\n * @param {import('../internal').PreactElement} parentDom The DOM element whose\n * children are being diffed\n * @param {import('../internal').ComponentChildren[]} renderResult\n * @param {import('../internal').VNode} newParentVNode The new virtual\n * node whose children should be diff'ed against oldParentVNode\n * @param {import('../internal').VNode} oldParentVNode The old virtual\n * node whose children should be diff'ed against newParentVNode\n * @param {object} globalContext The current context object - modified by getChildContext\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').PreactElement} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} isHydrating Whether or not we are in hydration\n */\nexport function diffChildren(\n\tparentDom,\n\trenderResult,\n\tnewParentVNode,\n\toldParentVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet i, j, oldVNode, childVNode, newDom, firstChildDom, refs;\n\n\t// This is a compression of oldParentVNode!=null && oldParentVNode != EMPTY_OBJ && oldParentVNode._children || EMPTY_ARR\n\t// as EMPTY_OBJ._children should be `undefined`.\n\tlet oldChildren = (oldParentVNode && oldParentVNode._children) || EMPTY_ARR;\n\n\tlet oldChildrenLength = oldChildren.length;\n\n\tnewParentVNode._children = [];\n\tfor (i = 0; i < renderResult.length; i++) {\n\t\tchildVNode = renderResult[i];\n\n\t\tif (childVNode == null || typeof childVNode == 'boolean') {\n\t\t\tchildVNode = newParentVNode._children[i] = null;\n\t\t}\n\t\t// If this newVNode is being reused (e.g. <div>{reuse}{reuse}</div>) in the same diff,\n\t\t// or we are rendering a component (e.g. setState) copy the oldVNodes so it can have\n\t\t// it's own DOM & etc. pointers\n\t\telse if (typeof childVNode == 'string' || typeof childVNode == 'number') {\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tnull,\n\t\t\t\tchildVNode,\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\tchildVNode\n\t\t\t);\n\t\t} else if (Array.isArray(childVNode)) {\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tFragment,\n\t\t\t\t{ children: childVNode },\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\tnull\n\t\t\t);\n\t\t} else if (childVNode._depth > 0) {\n\t\t\t// VNode is already in use, clone it. This can happen in the following\n\t\t\t// scenario:\n\t\t\t//   const reuse = <div />\n\t\t\t//   <div>{reuse}<span />{reuse}</div>\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tchildVNode.type,\n\t\t\t\tchildVNode.props,\n\t\t\t\tchildVNode.key,\n\t\t\t\tnull,\n\t\t\t\tchildVNode._original\n\t\t\t);\n\t\t} else {\n\t\t\tchildVNode = newParentVNode._children[i] = childVNode;\n\t\t}\n\n\t\t// Terser removes the `continue` here and wraps the loop body\n\t\t// in a `if (childVNode) { ... } condition\n\t\tif (childVNode == null) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tchildVNode._parent = newParentVNode;\n\t\tchildVNode._depth = newParentVNode._depth + 1;\n\n\t\t// Check if we find a corresponding element in oldChildren.\n\t\t// If found, delete the array item by setting to `undefined`.\n\t\t// We use `undefined`, as `null` is reserved for empty placeholders\n\t\t// (holes).\n\t\toldVNode = oldChildren[i];\n\n\t\tif (\n\t\t\toldVNode === null ||\n\t\t\t(oldVNode &&\n\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\tchildVNode.type === oldVNode.type)\n\t\t) {\n\t\t\toldChildren[i] = undefined;\n\t\t} else {\n\t\t\t// Either oldVNode === undefined or oldChildrenLength > 0,\n\t\t\t// so after this loop oldVNode == null or oldVNode is a valid value.\n\t\t\tfor (j = 0; j < oldChildrenLength; j++) {\n\t\t\t\toldVNode = oldChildren[j];\n\t\t\t\t// If childVNode is unkeyed, we only match similarly unkeyed nodes, otherwise we match by key.\n\t\t\t\t// We always match by type (in either case).\n\t\t\t\tif (\n\t\t\t\t\toldVNode &&\n\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\tchildVNode.type === oldVNode.type\n\t\t\t\t) {\n\t\t\t\t\toldChildren[j] = undefined;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\toldVNode = null;\n\t\t\t}\n\t\t}\n\n\t\toldVNode = oldVNode || EMPTY_OBJ;\n\n\t\t// Morph the old element into the new one, but don't append it to the dom yet\n\t\tdiff(\n\t\t\tparentDom,\n\t\t\tchildVNode,\n\t\t\toldVNode,\n\t\t\tglobalContext,\n\t\t\tisSvg,\n\t\t\texcessDomChildren,\n\t\t\tcommitQueue,\n\t\t\toldDom,\n\t\t\tisHydrating\n\t\t);\n\n\t\tnewDom = childVNode._dom;\n\n\t\tif ((j = childVNode.ref) && oldVNode.ref != j) {\n\t\t\tif (!refs) refs = [];\n\t\t\tif (oldVNode.ref) refs.push(oldVNode.ref, null, childVNode);\n\t\t\trefs.push(j, childVNode._component || newDom, childVNode);\n\t\t}\n\n\t\tif (newDom != null) {\n\t\t\tif (firstChildDom == null) {\n\t\t\t\tfirstChildDom = newDom;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttypeof childVNode.type == 'function' &&\n\t\t\t\tchildVNode._children != null && // Can be null if childVNode suspended\n\t\t\t\tchildVNode._children === oldVNode._children\n\t\t\t) {\n\t\t\t\tchildVNode._nextDom = oldDom = reorderChildren(\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldDom,\n\t\t\t\t\tparentDom\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\toldDom = placeChild(\n\t\t\t\t\tparentDom,\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldVNode,\n\t\t\t\t\toldChildren,\n\t\t\t\t\tnewDom,\n\t\t\t\t\toldDom\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Browsers will infer an option's `value` from `textContent` when\n\t\t\t// no value is present. This essentially bypasses our code to set it\n\t\t\t// later in `diff()`. It works fine in all browsers except for IE11\n\t\t\t// where it breaks setting `select.value`. There it will be always set\n\t\t\t// to an empty string. Re-applying an options value will fix that, so\n\t\t\t// there are probably some internal data structures that aren't\n\t\t\t// updated properly.\n\t\t\t//\n\t\t\t// To fix it we make sure to reset the inferred value, so that our own\n\t\t\t// value check in `diff()` won't be skipped.\n\t\t\tif (!isHydrating && newParentVNode.type === 'option') {\n\t\t\t\t// @ts-ignore We have validated that the type of parentDOM is 'option'\n\t\t\t\t// in the above check\n\t\t\t\tparentDom.value = '';\n\t\t\t} else if (typeof newParentVNode.type == 'function') {\n\t\t\t\t// Because the newParentVNode is Fragment-like, we need to set it's\n\t\t\t\t// _nextDom property to the nextSibling of its last child DOM node.\n\t\t\t\t//\n\t\t\t\t// `oldDom` contains the correct value here because if the last child\n\t\t\t\t// is a Fragment-like, then oldDom has already been set to that child's _nextDom.\n\t\t\t\t// If the last child is a DOM VNode, then oldDom will be set to that DOM\n\t\t\t\t// node's nextSibling.\n\t\t\t\tnewParentVNode._nextDom = oldDom;\n\t\t\t}\n\t\t} else if (\n\t\t\toldDom &&\n\t\t\toldVNode._dom == oldDom &&\n\t\t\toldDom.parentNode != parentDom\n\t\t) {\n\t\t\t// The above condition is to handle null placeholders. See test in placeholder.test.js:\n\t\t\t// `efficiently replace null placeholders in parent rerenders`\n\t\t\toldDom = getDomSibling(oldVNode);\n\t\t}\n\t}\n\n\tnewParentVNode._dom = firstChildDom;\n\n\t// Remove remaining oldChildren if there are any.\n\tfor (i = oldChildrenLength; i--; ) {\n\t\tif (oldChildren[i] != null) {\n\t\t\tif (\n\t\t\t\ttypeof newParentVNode.type == 'function' &&\n\t\t\t\toldChildren[i]._dom != null &&\n\t\t\t\toldChildren[i]._dom == newParentVNode._nextDom\n\t\t\t) {\n\t\t\t\t// If the newParentVNode.__nextDom points to a dom node that is about to\n\t\t\t\t// be unmounted, then get the next sibling of that vnode and set\n\t\t\t\t// _nextDom to it\n\t\t\t\tnewParentVNode._nextDom = getDomSibling(oldParentVNode, i + 1);\n\t\t\t}\n\n\t\t\tunmount(oldChildren[i], oldChildren[i]);\n\t\t}\n\t}\n\n\t// Set refs only after unmount\n\tif (refs) {\n\t\tfor (i = 0; i < refs.length; i++) {\n\t\t\tapplyRef(refs[i], refs[++i], refs[++i]);\n\t\t}\n\t}\n}\n\nfunction reorderChildren(childVNode, oldDom, parentDom) {\n\tfor (let tmp = 0; tmp < childVNode._children.length; tmp++) {\n\t\tlet vnode = childVNode._children[tmp];\n\t\tif (vnode) {\n\t\t\t// We typically enter this code path on sCU bailout, where we copy\n\t\t\t// oldVNode._children to newVNode._children. If that is the case, we need\n\t\t\t// to update the old children's _parent pointer to point to the newVNode\n\t\t\t// (childVNode here).\n\t\t\tvnode._parent = childVNode;\n\n\t\t\tif (typeof vnode.type == 'function') {\n\t\t\t\toldDom = reorderChildren(vnode, oldDom, parentDom);\n\t\t\t} else {\n\t\t\t\toldDom = placeChild(\n\t\t\t\t\tparentDom,\n\t\t\t\t\tvnode,\n\t\t\t\t\tvnode,\n\t\t\t\t\tchildVNode._children,\n\t\t\t\t\tvnode._dom,\n\t\t\t\t\toldDom\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn oldDom;\n}\n\n/**\n * Flatten and loop through the children of a virtual node\n * @param {import('../index').ComponentChildren} children The unflattened\n * children of a virtual node\n * @returns {import('../internal').VNode[]}\n */\nexport function toChildArray(children, out) {\n\tout = out || [];\n\tif (children == null || typeof children == 'boolean') {\n\t} else if (Array.isArray(children)) {\n\t\tchildren.some(child => {\n\t\t\ttoChildArray(child, out);\n\t\t});\n\t} else {\n\t\tout.push(children);\n\t}\n\treturn out;\n}\n\nfunction placeChild(\n\tparentDom,\n\tchildVNode,\n\toldVNode,\n\toldChildren,\n\tnewDom,\n\toldDom\n) {\n\tlet nextDom;\n\tif (childVNode._nextDom !== undefined) {\n\t\t// Only Fragments or components that return Fragment like VNodes will\n\t\t// have a non-undefined _nextDom. Continue the diff from the sibling\n\t\t// of last DOM child of this child VNode\n\t\tnextDom = childVNode._nextDom;\n\n\t\t// Eagerly cleanup _nextDom. We don't need to persist the value because\n\t\t// it is only used by `diffChildren` to determine where to resume the diff after\n\t\t// diffing Components and Fragments. Once we store it the nextDOM local var, we\n\t\t// can clean up the property\n\t\tchildVNode._nextDom = undefined;\n\t} else if (\n\t\toldVNode == null ||\n\t\tnewDom != oldDom ||\n\t\tnewDom.parentNode == null\n\t) {\n\t\touter: if (oldDom == null || oldDom.parentNode !== parentDom) {\n\t\t\tparentDom.appendChild(newDom);\n\t\t\tnextDom = null;\n\t\t} else {\n\t\t\t// `j<oldChildrenLength; j+=2` is an alternative to `j++<oldChildrenLength/2`\n\t\t\tfor (\n\t\t\t\tlet sibDom = oldDom, j = 0;\n\t\t\t\t(sibDom = sibDom.nextSibling) && j < oldChildren.length;\n\t\t\t\tj += 2\n\t\t\t) {\n\t\t\t\tif (sibDom == newDom) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t}\n\t\t\tparentDom.insertBefore(newDom, oldDom);\n\t\t\tnextDom = oldDom;\n\t\t}\n\t}\n\n\t// If we have pre-calculated the nextDOM node, use it. Else calculate it now\n\t// Strictly check for `undefined` here cuz `null` is a valid value of `nextDom`.\n\t// See more detail in create-element.js:createVNode\n\tif (nextDom !== undefined) {\n\t\toldDom = nextDom;\n\t} else {\n\t\toldDom = newDom.nextSibling;\n\t}\n\n\treturn oldDom;\n}\n","import { IS_NON_DIMENSIONAL } from '../constants';\nimport options from '../options';\n\n/**\n * Diff the old and new properties of a VNode and apply changes to the DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to apply\n * changes to\n * @param {object} newProps The new props\n * @param {object} oldProps The old props\n * @param {boolean} isSvg Whether or not this node is an SVG node\n * @param {boolean} hydrate Whether or not we are in hydration mode\n */\nexport function diffProps(dom, newProps, oldProps, isSvg, hydrate) {\n\tlet i;\n\n\tfor (i in oldProps) {\n\t\tif (i !== 'children' && i !== 'key' && !(i in newProps)) {\n\t\t\tsetProperty(dom, i, null, oldProps[i], isSvg);\n\t\t}\n\t}\n\n\tfor (i in newProps) {\n\t\tif (\n\t\t\t(!hydrate || typeof newProps[i] == 'function') &&\n\t\t\ti !== 'children' &&\n\t\t\ti !== 'key' &&\n\t\t\ti !== 'value' &&\n\t\t\ti !== 'checked' &&\n\t\t\toldProps[i] !== newProps[i]\n\t\t) {\n\t\t\tsetProperty(dom, i, newProps[i], oldProps[i], isSvg);\n\t\t}\n\t}\n}\n\nfunction setStyle(style, key, value) {\n\tif (key[0] === '-') {\n\t\tstyle.setProperty(key, value);\n\t} else if (value == null) {\n\t\tstyle[key] = '';\n\t} else if (typeof value != 'number' || IS_NON_DIMENSIONAL.test(key)) {\n\t\tstyle[key] = value;\n\t} else {\n\t\tstyle[key] = value + 'px';\n\t}\n}\n\n/**\n * Set a property value on a DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to modify\n * @param {string} name The name of the property to set\n * @param {*} value The value to set the property to\n * @param {*} oldValue The old value the property had\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node or not\n */\nexport function setProperty(dom, name, value, oldValue, isSvg) {\n\tlet useCapture;\n\n\to: if (name === 'style') {\n\t\tif (typeof value == 'string') {\n\t\t\tdom.style.cssText = value;\n\t\t} else {\n\t\t\tif (typeof oldValue == 'string') {\n\t\t\t\tdom.style.cssText = oldValue = '';\n\t\t\t}\n\n\t\t\tif (oldValue) {\n\t\t\t\tfor (name in oldValue) {\n\t\t\t\t\tif (!(value && name in value)) {\n\t\t\t\t\t\tsetStyle(dom.style, name, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (value) {\n\t\t\t\tfor (name in value) {\n\t\t\t\t\tif (!oldValue || value[name] !== oldValue[name]) {\n\t\t\t\t\t\tsetStyle(dom.style, name, value[name]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t// Benchmark for comparison: https://esbench.com/bench/574c954bdb965b9a00965ac6\n\telse if (name[0] === 'o' && name[1] === 'n') {\n\t\tuseCapture = name !== (name = name.replace(/Capture$/, ''));\n\n\t\t// Infer correct casing for DOM built-in events:\n\t\tif (name.toLowerCase() in dom) name = name.toLowerCase().slice(2);\n\t\telse name = name.slice(2);\n\n\t\tif (!dom._listeners) dom._listeners = {};\n\t\tdom._listeners[name + useCapture] = value;\n\n\t\tif (value) {\n\t\t\tif (!oldValue) {\n\t\t\t\tconst handler = useCapture ? eventProxyCapture : eventProxy;\n\t\t\t\tdom.addEventListener(name, handler, useCapture);\n\t\t\t}\n\t\t} else {\n\t\t\tconst handler = useCapture ? eventProxyCapture : eventProxy;\n\t\t\tdom.removeEventListener(name, handler, useCapture);\n\t\t}\n\t} else if (name !== 'dangerouslySetInnerHTML') {\n\t\tif (isSvg) {\n\t\t\t// Normalize incorrect prop usage for SVG:\n\t\t\t// - xlink:href / xlinkHref --> href (xlink:href was removed from SVG and isn't needed)\n\t\t\t// - className --> class\n\t\t\tname = name.replace(/xlink[H:h]/, 'h').replace(/sName$/, 's');\n\t\t} else if (\n\t\t\tname !== 'href' &&\n\t\t\tname !== 'list' &&\n\t\t\tname !== 'form' &&\n\t\t\tname !== 'download' &&\n\t\t\tname in dom\n\t\t) {\n\t\t\ttry {\n\t\t\t\tdom[name] = value == null ? '' : value;\n\t\t\t\t// labelled break is 1b smaller here than a return statement (sorry)\n\t\t\t\tbreak o;\n\t\t\t} catch (e) {}\n\t\t}\n\n\t\t// ARIA-attributes have a different notion of boolean values.\n\t\t// The value `false` is different from the attribute not\n\t\t// existing on the DOM, so we can't remove it. For non-boolean\n\t\t// ARIA-attributes we could treat false as a removal, but the\n\t\t// amount of exceptions would cost us too many bytes. On top of\n\t\t// that other VDOM frameworks also always stringify `false`.\n\n\t\tif (typeof value === 'function') {\n\t\t\t// never serialize functions as attribute values\n\t\t} else if (\n\t\t\tvalue != null &&\n\t\t\t(value !== false || (name[0] === 'a' && name[1] === 'r'))\n\t\t) {\n\t\t\tdom.setAttribute(name, value);\n\t\t} else {\n\t\t\tdom.removeAttribute(name);\n\t\t}\n\t}\n}\n\n/**\n * Proxy an event to hooked event handlers\n * @param {Event} e The event object from the browser\n * @private\n */\nfunction eventProxy(e) {\n\tthis._listeners[e.type + false](options.event ? options.event(e) : e);\n}\n\nfunction eventProxyCapture(e) {\n\tthis._listeners[e.type + true](options.event ? options.event(e) : e);\n}\n","import { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { Component } from '../component';\nimport { Fragment } from '../create-element';\nimport { diffChildren } from './children';\nimport { diffProps, setProperty } from './props';\nimport { assign, removeNode } from '../util';\nimport options from '../options';\n\n/**\n * Diff two virtual nodes and apply proper changes to the DOM\n * @param {import('../internal').PreactElement} parentDom The parent of the DOM element\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object. Modified by getChildContext\n * @param {boolean} isSvg Whether or not this element is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').PreactElement} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} [isHydrating] Whether or not we are in hydration\n */\nexport function diff(\n\tparentDom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet tmp,\n\t\tnewType = newVNode.type;\n\n\t// When passing through createElement it assigns the object\n\t// constructor as undefined. This to prevent JSON-injection.\n\tif (newVNode.constructor !== undefined) return null;\n\n\t// If the previous diff bailed out, resume creating/hydrating.\n\tif (oldVNode._hydrating != null) {\n\t\tisHydrating = oldVNode._hydrating;\n\t\toldDom = newVNode._dom = oldVNode._dom;\n\t\t// if we resume, we want the tree to be \"unlocked\"\n\t\tnewVNode._hydrating = null;\n\t\texcessDomChildren = [oldDom];\n\t}\n\n\tif ((tmp = options._diff)) tmp(newVNode);\n\n\ttry {\n\t\touter: if (typeof newType == 'function') {\n\t\t\tlet c, isNew, oldProps, oldState, snapshot, clearProcessingException;\n\t\t\tlet newProps = newVNode.props;\n\n\t\t\t// Necessary for createContext api. Setting this property will pass\n\t\t\t// the context value as `this.context` just for this component.\n\t\t\ttmp = newType.contextType;\n\t\t\tlet provider = tmp && globalContext[tmp._id];\n\t\t\tlet componentContext = tmp\n\t\t\t\t? provider\n\t\t\t\t\t? provider.props.value\n\t\t\t\t\t: tmp._defaultValue\n\t\t\t\t: globalContext;\n\n\t\t\t// Get component and set it to `c`\n\t\t\tif (oldVNode._component) {\n\t\t\t\tc = newVNode._component = oldVNode._component;\n\t\t\t\tclearProcessingException = c._processingException = c._pendingError;\n\t\t\t} else {\n\t\t\t\t// Instantiate the new component\n\t\t\t\tif ('prototype' in newType && newType.prototype.render) {\n\t\t\t\t\t// @ts-ignore The check above verifies that newType is suppose to be constructed\n\t\t\t\t\tnewVNode._component = c = new newType(newProps, componentContext); // eslint-disable-line new-cap\n\t\t\t\t} else {\n\t\t\t\t\t// @ts-ignore Trust me, Component implements the interface we want\n\t\t\t\t\tnewVNode._component = c = new Component(newProps, componentContext);\n\t\t\t\t\tc.constructor = newType;\n\t\t\t\t\tc.render = doRender;\n\t\t\t\t}\n\t\t\t\tif (provider) provider.sub(c);\n\n\t\t\t\tc.props = newProps;\n\t\t\t\tif (!c.state) c.state = {};\n\t\t\t\tc.context = componentContext;\n\t\t\t\tc._globalContext = globalContext;\n\t\t\t\tisNew = c._dirty = true;\n\t\t\t\tc._renderCallbacks = [];\n\t\t\t}\n\n\t\t\t// Invoke getDerivedStateFromProps\n\t\t\tif (c._nextState == null) {\n\t\t\t\tc._nextState = c.state;\n\t\t\t}\n\t\t\tif (newType.getDerivedStateFromProps != null) {\n\t\t\t\tif (c._nextState == c.state) {\n\t\t\t\t\tc._nextState = assign({}, c._nextState);\n\t\t\t\t}\n\n\t\t\t\tassign(\n\t\t\t\t\tc._nextState,\n\t\t\t\t\tnewType.getDerivedStateFromProps(newProps, c._nextState)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\toldProps = c.props;\n\t\t\toldState = c.state;\n\n\t\t\t// Invoke pre-render lifecycle methods\n\t\t\tif (isNew) {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tc.componentWillMount != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillMount();\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidMount != null) {\n\t\t\t\t\tc._renderCallbacks.push(c.componentDidMount);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tnewProps !== oldProps &&\n\t\t\t\t\tc.componentWillReceiveProps != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillReceiveProps(newProps, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t(!c._force &&\n\t\t\t\t\t\tc.shouldComponentUpdate != null &&\n\t\t\t\t\t\tc.shouldComponentUpdate(\n\t\t\t\t\t\t\tnewProps,\n\t\t\t\t\t\t\tc._nextState,\n\t\t\t\t\t\t\tcomponentContext\n\t\t\t\t\t\t) === false) ||\n\t\t\t\t\tnewVNode._original === oldVNode._original\n\t\t\t\t) {\n\t\t\t\t\tc.props = newProps;\n\t\t\t\t\tc.state = c._nextState;\n\t\t\t\t\t// More info about this here: https://gist.github.com/JoviDeCroock/bec5f2ce93544d2e6070ef8e0036e4e8\n\t\t\t\t\tif (newVNode._original !== oldVNode._original) c._dirty = false;\n\t\t\t\t\tc._vnode = newVNode;\n\t\t\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t\t\t\tnewVNode._children = oldVNode._children;\n\t\t\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\t\t\tcommitQueue.push(c);\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\n\t\t\t\tif (c.componentWillUpdate != null) {\n\t\t\t\t\tc.componentWillUpdate(newProps, c._nextState, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidUpdate != null) {\n\t\t\t\t\tc._renderCallbacks.push(() => {\n\t\t\t\t\t\tc.componentDidUpdate(oldProps, oldState, snapshot);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tc.context = componentContext;\n\t\t\tc.props = newProps;\n\t\t\tc.state = c._nextState;\n\n\t\t\tif ((tmp = options._render)) tmp(newVNode);\n\n\t\t\tc._dirty = false;\n\t\t\tc._vnode = newVNode;\n\t\t\tc._parentDom = parentDom;\n\n\t\t\ttmp = c.render(c.props, c.state, c.context);\n\n\t\t\t// Handle setState called in render, see #2553\n\t\t\tc.state = c._nextState;\n\n\t\t\tif (c.getChildContext != null) {\n\t\t\t\tglobalContext = assign(assign({}, globalContext), c.getChildContext());\n\t\t\t}\n\n\t\t\tif (!isNew && c.getSnapshotBeforeUpdate != null) {\n\t\t\t\tsnapshot = c.getSnapshotBeforeUpdate(oldProps, oldState);\n\t\t\t}\n\n\t\t\tlet isTopLevelFragment =\n\t\t\t\ttmp != null && tmp.type === Fragment && tmp.key == null;\n\t\t\tlet renderResult = isTopLevelFragment ? tmp.props.children : tmp;\n\n\t\t\tdiffChildren(\n\t\t\t\tparentDom,\n\t\t\t\tArray.isArray(renderResult) ? renderResult : [renderResult],\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\toldDom,\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\tc.base = newVNode._dom;\n\n\t\t\t// We successfully rendered this VNode, unset any stored hydration/bailout state:\n\t\t\tnewVNode._hydrating = null;\n\n\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\tcommitQueue.push(c);\n\t\t\t}\n\n\t\t\tif (clearProcessingException) {\n\t\t\t\tc._pendingError = c._processingException = null;\n\t\t\t}\n\n\t\t\tc._force = false;\n\t\t} else if (\n\t\t\texcessDomChildren == null &&\n\t\t\tnewVNode._original === oldVNode._original\n\t\t) {\n\t\t\tnewVNode._children = oldVNode._children;\n\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t} else {\n\t\t\tnewVNode._dom = diffElementNodes(\n\t\t\t\toldVNode._dom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\tif ((tmp = options.diffed)) tmp(newVNode);\n\t} catch (e) {\n\t\tnewVNode._original = null;\n\t\t// if hydrating or creating initial tree, bailout preserves DOM:\n\t\tif (isHydrating || excessDomChildren != null) {\n\t\t\tnewVNode._dom = oldDom;\n\t\t\tnewVNode._hydrating = !!isHydrating;\n\t\t\texcessDomChildren[excessDomChildren.indexOf(oldDom)] = null;\n\t\t\t// ^ could possibly be simplified to:\n\t\t\t// excessDomChildren.length = 0;\n\t\t}\n\t\toptions._catchError(e, newVNode, oldVNode);\n\t}\n}\n\n/**\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').VNode} root\n */\nexport function commitRoot(commitQueue, root) {\n\tif (options._commit) options._commit(root, commitQueue);\n\n\tcommitQueue.some(c => {\n\t\ttry {\n\t\t\t// @ts-ignore Reuse the commitQueue variable here so the type changes\n\t\t\tcommitQueue = c._renderCallbacks;\n\t\t\tc._renderCallbacks = [];\n\t\t\tcommitQueue.some(cb => {\n\t\t\t\t// @ts-ignore See above ts-ignore on commitQueue\n\t\t\t\tcb.call(c);\n\t\t\t});\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t});\n}\n\n/**\n * Diff two virtual nodes representing DOM element\n * @param {import('../internal').PreactElement} dom The DOM element representing\n * the virtual nodes being diffed\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {*} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {boolean} isHydrating Whether or not we are in hydration\n * @returns {import('../internal').PreactElement}\n */\nfunction diffElementNodes(\n\tdom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\tisHydrating\n) {\n\tlet oldProps = oldVNode.props;\n\tlet newProps = newVNode.props;\n\tlet nodeType = newVNode.type;\n\tlet i = 0;\n\n\t// Tracks entering and exiting SVG namespace when descending through the tree.\n\tif (nodeType === 'svg') isSvg = true;\n\n\tif (excessDomChildren != null) {\n\t\tfor (; i < excessDomChildren.length; i++) {\n\t\t\tconst child = excessDomChildren[i];\n\n\t\t\t// if newVNode matches an element in excessDomChildren or the `dom`\n\t\t\t// argument matches an element in excessDomChildren, remove it from\n\t\t\t// excessDomChildren so it isn't later removed in diffChildren\n\t\t\tif (\n\t\t\t\tchild &&\n\t\t\t\t(child === dom ||\n\t\t\t\t\t(nodeType ? child.localName == nodeType : child.nodeType == 3))\n\t\t\t) {\n\t\t\t\tdom = child;\n\t\t\t\texcessDomChildren[i] = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (dom == null) {\n\t\tif (nodeType === null) {\n\t\t\t// @ts-ignore createTextNode returns Text, we expect PreactElement\n\t\t\treturn document.createTextNode(newProps);\n\t\t}\n\n\t\tif (isSvg) {\n\t\t\tdom = document.createElementNS(\n\t\t\t\t'http://www.w3.org/2000/svg',\n\t\t\t\t// @ts-ignore We know `newVNode.type` is a string\n\t\t\t\tnodeType\n\t\t\t);\n\t\t} else {\n\t\t\tdom = document.createElement(\n\t\t\t\t// @ts-ignore We know `newVNode.type` is a string\n\t\t\t\tnodeType,\n\t\t\t\tnewProps.is && newProps\n\t\t\t);\n\t\t}\n\n\t\t// we created a new parent, so none of the previously attached children can be reused:\n\t\texcessDomChildren = null;\n\t\t// we are creating a new node, so we can assume this is a new subtree (in case we are hydrating), this deopts the hydrate\n\t\tisHydrating = false;\n\t}\n\n\tif (nodeType === null) {\n\t\t// During hydration, we still have to split merged text from SSR'd HTML.\n\t\tif (oldProps !== newProps && (!isHydrating || dom.data !== newProps)) {\n\t\t\tdom.data = newProps;\n\t\t}\n\t} else {\n\t\t// If excessDomChildren was not null, repopulate it with the current element's children:\n\t\texcessDomChildren =\n\t\t\texcessDomChildren && EMPTY_ARR.slice.call(dom.childNodes);\n\n\t\toldProps = oldVNode.props || EMPTY_OBJ;\n\n\t\tlet oldHtml = oldProps.dangerouslySetInnerHTML;\n\t\tlet newHtml = newProps.dangerouslySetInnerHTML;\n\n\t\t// During hydration, props are not diffed at all (including dangerouslySetInnerHTML)\n\t\t// @TODO we should warn in debug mode when props don't match here.\n\t\tif (!isHydrating) {\n\t\t\t// But, if we are in a situation where we are using existing DOM (e.g. replaceNode)\n\t\t\t// we should read the existing DOM attributes to diff them\n\t\t\tif (excessDomChildren != null) {\n\t\t\t\toldProps = {};\n\t\t\t\tfor (let i = 0; i < dom.attributes.length; i++) {\n\t\t\t\t\toldProps[dom.attributes[i].name] = dom.attributes[i].value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (newHtml || oldHtml) {\n\t\t\t\t// Avoid re-applying the same '__html' if it did not changed between re-render\n\t\t\t\tif (\n\t\t\t\t\t!newHtml ||\n\t\t\t\t\t((!oldHtml || newHtml.__html != oldHtml.__html) &&\n\t\t\t\t\t\tnewHtml.__html !== dom.innerHTML)\n\t\t\t\t) {\n\t\t\t\t\tdom.innerHTML = (newHtml && newHtml.__html) || '';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdiffProps(dom, newProps, oldProps, isSvg, isHydrating);\n\n\t\t// If the new vnode didn't have dangerouslySetInnerHTML, diff its children\n\t\tif (newHtml) {\n\t\t\tnewVNode._children = [];\n\t\t} else {\n\t\t\ti = newVNode.props.children;\n\t\t\tdiffChildren(\n\t\t\t\tdom,\n\t\t\t\tArray.isArray(i) ? i : [i],\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg && nodeType !== 'foreignObject',\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tdom.firstChild,\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\t// Remove children that are not part of any vnode.\n\t\t\tif (excessDomChildren != null) {\n\t\t\t\tfor (i = excessDomChildren.length; i--; ) {\n\t\t\t\t\tif (excessDomChildren[i] != null) removeNode(excessDomChildren[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// (as above, don't diff props during hydration)\n\t\tif (!isHydrating) {\n\t\t\tif (\n\t\t\t\t'value' in newProps &&\n\t\t\t\t(i = newProps.value) !== undefined &&\n\t\t\t\t// #2756 For the <progress>-element the initial value is 0,\n\t\t\t\t// despite the attribute not being present. When the attribute\n\t\t\t\t// is missing the progress bar is treated as indeterminate.\n\t\t\t\t// To fix that we'll always update it when it is 0 for progress elements\n\t\t\t\t(i !== dom.value || (nodeType === 'progress' && !i))\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'value', i, oldProps.value, false);\n\t\t\t}\n\t\t\tif (\n\t\t\t\t'checked' in newProps &&\n\t\t\t\t(i = newProps.checked) !== undefined &&\n\t\t\t\ti !== dom.checked\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'checked', i, oldProps.checked, false);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n/**\n * Invoke or update a ref, depending on whether it is a function or object ref.\n * @param {object|function} ref\n * @param {any} value\n * @param {import('../internal').VNode} vnode\n */\nexport function applyRef(ref, value, vnode) {\n\ttry {\n\t\tif (typeof ref == 'function') ref(value);\n\t\telse ref.current = value;\n\t} catch (e) {\n\t\toptions._catchError(e, vnode);\n\t}\n}\n\n/**\n * Unmount a virtual node from the tree and apply DOM changes\n * @param {import('../internal').VNode} vnode The virtual node to unmount\n * @param {import('../internal').VNode} parentVNode The parent of the VNode that\n * initiated the unmount\n * @param {boolean} [skipRemove] Flag that indicates that a parent node of the\n * current element is already detached from the DOM.\n */\nexport function unmount(vnode, parentVNode, skipRemove) {\n\tlet r;\n\tif (options.unmount) options.unmount(vnode);\n\n\tif ((r = vnode.ref)) {\n\t\tif (!r.current || r.current === vnode._dom) applyRef(r, null, parentVNode);\n\t}\n\n\tlet dom;\n\tif (!skipRemove && typeof vnode.type != 'function') {\n\t\tskipRemove = (dom = vnode._dom) != null;\n\t}\n\n\t// Must be set to `undefined` to properly clean up `_nextDom`\n\t// for which `null` is a valid value. See comment in `create-element.js`\n\tvnode._dom = vnode._nextDom = undefined;\n\n\tif ((r = vnode._component) != null) {\n\t\tif (r.componentWillUnmount) {\n\t\t\ttry {\n\t\t\t\tr.componentWillUnmount();\n\t\t\t} catch (e) {\n\t\t\t\toptions._catchError(e, parentVNode);\n\t\t\t}\n\t\t}\n\n\t\tr.base = r._parentDom = null;\n\t}\n\n\tif ((r = vnode._children)) {\n\t\tfor (let i = 0; i < r.length; i++) {\n\t\t\tif (r[i]) unmount(r[i], parentVNode, skipRemove);\n\t\t}\n\t}\n\n\tif (dom != null) removeNode(dom);\n}\n\n/** The `.render()` method for a PFC backing instance. */\nfunction doRender(props, state, context) {\n\treturn this.constructor(props, context);\n}\n","import { EMPTY_OBJ, EMPTY_ARR } from './constants';\nimport { commitRoot, diff } from './diff/index';\nimport { createElement, Fragment } from './create-element';\nimport options from './options';\n\n/**\n * Render a Preact virtual node into a DOM element\n * @param {import('./internal').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * render into\n * @param {import('./internal').PreactElement | object} [replaceNode] Optional: Attempt to re-use an\n * existing DOM tree rooted at `replaceNode`\n */\nexport function render(vnode, parentDom, replaceNode) {\n\tif (options._root) options._root(vnode, parentDom);\n\n\t// We abuse the `replaceNode` parameter in `hydrate()` to signal if we are in\n\t// hydration mode or not by passing the `hydrate` function instead of a DOM\n\t// element..\n\tlet isHydrating = typeof replaceNode === 'function';\n\n\t// To be able to support calling `render()` multiple times on the same\n\t// DOM node, we need to obtain a reference to the previous tree. We do\n\t// this by assigning a new `_children` property to DOM nodes which points\n\t// to the last rendered tree. By default this property is not present, which\n\t// means that we are mounting a new tree for the first time.\n\tlet oldVNode = isHydrating\n\t\t? null\n\t\t: (replaceNode && replaceNode._children) || parentDom._children;\n\n\tvnode = (\n\t\t(!isHydrating && replaceNode) ||\n\t\tparentDom\n\t)._children = createElement(Fragment, null, [vnode]);\n\n\t// List of effects that need to be called after diffing.\n\tlet commitQueue = [];\n\tdiff(\n\t\tparentDom,\n\t\t// Determine the new vnode tree and store it on the DOM element on\n\t\t// our custom `_children` property.\n\t\tvnode,\n\t\toldVNode || EMPTY_OBJ,\n\t\tEMPTY_OBJ,\n\t\tparentDom.ownerSVGElement !== undefined,\n\t\t!isHydrating && replaceNode\n\t\t\t? [replaceNode]\n\t\t\t: oldVNode\n\t\t\t? null\n\t\t\t: parentDom.firstChild\n\t\t\t? EMPTY_ARR.slice.call(parentDom.childNodes)\n\t\t\t: null,\n\t\tcommitQueue,\n\t\t!isHydrating && replaceNode\n\t\t\t? replaceNode\n\t\t\t: oldVNode\n\t\t\t? oldVNode._dom\n\t\t\t: parentDom.firstChild,\n\t\tisHydrating\n\t);\n\n\t// Flush all queued effects\n\tcommitRoot(commitQueue, vnode);\n}\n\n/**\n * Update an existing DOM element with data from a Preact virtual node\n * @param {import('./internal').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * update\n */\nexport function hydrate(vnode, parentDom) {\n\trender(vnode, parentDom, hydrate);\n}\n","import { assign } from './util';\nimport { createVNode } from './create-element';\n\n/**\n * Clones the given VNode, optionally adding attributes/props and replacing its children.\n * @param {import('./internal').VNode} vnode The virtual DOM element to clone\n * @param {object} props Attributes/props to add when cloning\n * @param {Array<import('./internal').ComponentChildren>} rest Any additional arguments will be used as replacement children.\n * @returns {import('./internal').VNode}\n */\nexport function cloneElement(vnode, props, children) {\n\tlet normalizedProps = assign({}, vnode.props),\n\t\tkey,\n\t\tref,\n\t\ti;\n\tfor (i in props) {\n\t\tif (i == 'key') key = props[i];\n\t\telse if (i == 'ref') ref = props[i];\n\t\telse normalizedProps[i] = props[i];\n\t}\n\n\tif (arguments.length > 3) {\n\t\tchildren = [children];\n\t\tfor (i = 3; i < arguments.length; i++) {\n\t\t\tchildren.push(arguments[i]);\n\t\t}\n\t}\n\tif (children != null) {\n\t\tnormalizedProps.children = children;\n\t}\n\n\treturn createVNode(\n\t\tvnode.type,\n\t\tnormalizedProps,\n\t\tkey || vnode.key,\n\t\tref || vnode.ref,\n\t\tnull\n\t);\n}\n","import { enqueueRender } from './component';\n\nexport let i = 0;\n\nexport function createContext(defaultValue, contextId) {\n\tcontextId = '__cC' + i++;\n\n\tconst context = {\n\t\t_id: contextId,\n\t\t_defaultValue: defaultValue,\n\t\t/** @type {import('./internal').FunctionComponent} */\n\t\tConsumer(props, contextValue) {\n\t\t\t// return props.children(\n\t\t\t// \tcontext[contextId] ? context[contextId].props.value : defaultValue\n\t\t\t// );\n\t\t\treturn props.children(contextValue);\n\t\t},\n\t\t/** @type {import('./internal').FunctionComponent} */\n\t\tProvider(props) {\n\t\t\tif (!this.getChildContext) {\n\t\t\t\tlet subs = [];\n\t\t\t\tlet ctx = {};\n\t\t\t\tctx[contextId] = this;\n\n\t\t\t\tthis.getChildContext = () => ctx;\n\n\t\t\t\tthis.shouldComponentUpdate = function(_props) {\n\t\t\t\t\tif (this.props.value !== _props.value) {\n\t\t\t\t\t\t// I think the forced value propagation here was only needed when `options.debounceRendering` was being bypassed:\n\t\t\t\t\t\t// https://github.com/preactjs/preact/commit/4d339fb803bea09e9f198abf38ca1bf8ea4b7771#diff-54682ce380935a717e41b8bfc54737f6R358\n\t\t\t\t\t\t// In those cases though, even with the value corrected, we're double-rendering all nodes.\n\t\t\t\t\t\t// It might be better to just tell folks not to use force-sync mode.\n\t\t\t\t\t\t// Currently, using `useContext()` in a class component will overwrite its `this.context` value.\n\t\t\t\t\t\t// subs.some(c => {\n\t\t\t\t\t\t// \tc.context = _props.value;\n\t\t\t\t\t\t// \tenqueueRender(c);\n\t\t\t\t\t\t// });\n\n\t\t\t\t\t\t// subs.some(c => {\n\t\t\t\t\t\t// \tc.context[contextId] = _props.value;\n\t\t\t\t\t\t// \tenqueueRender(c);\n\t\t\t\t\t\t// });\n\t\t\t\t\t\tsubs.some(enqueueRender);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis.sub = c => {\n\t\t\t\t\tsubs.push(c);\n\t\t\t\t\tlet old = c.componentWillUnmount;\n\t\t\t\t\tc.componentWillUnmount = () => {\n\t\t\t\t\t\tsubs.splice(subs.indexOf(c), 1);\n\t\t\t\t\t\tif (old) old.call(c);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn props.children;\n\t\t}\n\t};\n\n\t// Devtools needs access to the context object when it\n\t// encounters a Provider. This is necessary to support\n\t// setting `displayName` on the context object instead\n\t// of on the component itself. See:\n\t// https://reactjs.org/docs/context.html#contextdisplayname\n\n\treturn (context.Provider._contextRef = context.Consumer.contextType = context);\n}\n","export const EMPTY_OBJ = {};\nexport const EMPTY_ARR = [];\nexport const IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;\n","import { _catchError } from './diff/catch-error';\n\n/**\n * The `option` object can potentially contain callback functions\n * that are called during various stages of our renderer. This is the\n * foundation on which all our addons like `preact/debug`, `preact/compat`,\n * and `preact/hooks` are based on. See the `Options` type in `internal.d.ts`\n * for a full list of available option hooks (most editors/IDEs allow you to\n * ctrl+click or cmd+click on mac the type definition below).\n * @type {import('./internal').Options}\n */\nconst options = {\n\t_catchError,\n\t_vnodeId: 0\n};\n\nexport default options;\n","/**\n * Find the closest error boundary to a thrown error and call it\n * @param {object} error The thrown value\n * @param {import('../internal').VNode} vnode The vnode that threw\n * the error that was caught (except for unmounting when this parameter\n * is the highest parent that was being unmounted)\n */\nexport function _catchError(error, vnode) {\n\t/** @type {import('../internal').Component} */\n\tlet component, ctor, handled;\n\n\tfor (; (vnode = vnode._parent); ) {\n\t\tif ((component = vnode._component) && !component._processingException) {\n\t\t\ttry {\n\t\t\t\tctor = component.constructor;\n\n\t\t\t\tif (ctor && ctor.getDerivedStateFromError != null) {\n\t\t\t\t\tcomponent.setState(ctor.getDerivedStateFromError(error));\n\t\t\t\t\thandled = component._dirty;\n\t\t\t\t}\n\n\t\t\t\tif (component.componentDidCatch != null) {\n\t\t\t\t\tcomponent.componentDidCatch(error);\n\t\t\t\t\thandled = component._dirty;\n\t\t\t\t}\n\n\t\t\t\t// This is an error boundary. Mark it as having bailed out, and whether it was mid-hydration.\n\t\t\t\tif (handled) {\n\t\t\t\t\treturn (component._pendingError = component);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\terror = e;\n\t\t\t}\n\t\t}\n\t}\n\n\tthrow error;\n}\n","/* global __webpack_public_path__ */\n\nimport * as Preact from 'preact';\nconst { h, render, hydrate } = Preact;\n\nconst interopDefault = m => (m && m.default ? m.default : m);\n\nconst normalizeURL = url => (url[url.length - 1] === '/' ? url : url + '/');\n\nif (process.env.NODE_ENV === 'development') {\n\t// enable preact devtools\n\trequire('preact/debug');\n\n\t// only add a debug sw if webpack service worker is not requested.\n\tif (process.env.ADD_SW === undefined && 'serviceWorker' in navigator) {\n\t\t// eslint-disable-next-line no-undef\n\t\tnavigator.serviceWorker.register(__webpack_public_path__ + 'sw-debug.js');\n\t} else if (process.env.ADD_SW && 'serviceWorker' in navigator) {\n\t\t// eslint-disable-next-line no-undef\n\t\tnavigator.serviceWorker.register(\n\t\t\t__webpack_public_path__ + (process.env.ES_BUILD ? 'sw-esm.js' : 'sw.js')\n\t\t);\n\t}\n} else if (process.env.ADD_SW && 'serviceWorker' in navigator) {\n\t// eslint-disable-next-line no-undef\n\tnavigator.serviceWorker.register(\n\t\t__webpack_public_path__ + (process.env.ES_BUILD ? 'sw-esm.js' : 'sw.js')\n\t);\n}\n\nlet app = interopDefault(require('preact-cli-entrypoint'));\n\nif (typeof app === 'function') {\n\tlet root =\n\t\tdocument.getElementById('preact_root') || document.body.firstElementChild;\n\n\tlet init = () => {\n\t\tlet app = interopDefault(require('preact-cli-entrypoint'));\n\t\tlet preRenderData = {};\n\t\tconst inlineDataElement = document.querySelector(\n\t\t\t'[type=\"__PREACT_CLI_DATA__\"]'\n\t\t);\n\t\tif (inlineDataElement) {\n\t\t\tpreRenderData =\n\t\t\t\tJSON.parse(decodeURI(inlineDataElement.innerHTML)).preRenderData ||\n\t\t\t\tpreRenderData;\n\t\t}\n\t\t/* An object named CLI_DATA is passed as a prop,\n\t\t * this keeps us future proof if in case we decide,\n\t\t * to send other data like at some point in time.\n\t\t */\n\t\tconst CLI_DATA = { preRenderData };\n\t\tconst currentURL = preRenderData.url ? normalizeURL(preRenderData.url) : '';\n\t\tconst canHydrate =\n\t\t\tprocess.env.PRERENDER &&\n\t\t\tprocess.env.NODE_ENV === 'production' &&\n\t\t\thydrate &&\n\t\t\tcurrentURL === normalizeURL(location.pathname);\n\t\tconst doRender = canHydrate ? hydrate : render;\n\t\troot = doRender(h(app, { CLI_DATA }), document.body, root);\n\t};\n\n\tif (module.hot) module.hot.accept('preact-cli-entrypoint', init);\n\n\tinit();\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","var idCounter = 0;\nfunction id() {\n    return idCounter++;\n}\nexport { id };\n","import * as ERROR_MSGS from \"../constants/error_msgs\";\nexport function isStackOverflowExeption(error) {\n    return (error instanceof RangeError ||\n        error.message === ERROR_MSGS.STACK_OVERFLOW);\n}\n","export var DUPLICATED_INJECTABLE_DECORATOR = \"Cannot apply @injectable decorator multiple times.\";\nexport var DUPLICATED_METADATA = \"Metadata key was used more than once in a parameter:\";\nexport var NULL_ARGUMENT = \"NULL argument\";\nexport var KEY_NOT_FOUND = \"Key Not Found\";\nexport var AMBIGUOUS_MATCH = \"Ambiguous match found for serviceIdentifier:\";\nexport var CANNOT_UNBIND = \"Could not unbind serviceIdentifier:\";\nexport var NOT_REGISTERED = \"No matching bindings found for serviceIdentifier:\";\nexport var MISSING_INJECTABLE_ANNOTATION = \"Missing required @injectable annotation in:\";\nexport var MISSING_INJECT_ANNOTATION = \"Missing required @inject or @multiInject annotation in:\";\nexport var UNDEFINED_INJECT_ANNOTATION = function (name) {\n    return \"@inject called with undefined this could mean that the class \" + name + \" has \" +\n        \"a circular dependency problem. You can use a LazyServiceIdentifer to  \" +\n        \"overcome this limitation.\";\n};\nexport var CIRCULAR_DEPENDENCY = \"Circular dependency found:\";\nexport var NOT_IMPLEMENTED = \"Sorry, this feature is not fully implemented yet.\";\nexport var INVALID_BINDING_TYPE = \"Invalid binding type:\";\nexport var NO_MORE_SNAPSHOTS_AVAILABLE = \"No snapshot available to restore.\";\nexport var INVALID_MIDDLEWARE_RETURN = \"Invalid return type in middleware. Middleware must return!\";\nexport var INVALID_FUNCTION_BINDING = \"Value provided to function binding must be a function!\";\nexport var INVALID_TO_SELF_VALUE = \"The toSelf function can only be applied when a constructor is \" +\n    \"used as service identifier\";\nexport var INVALID_DECORATOR_OPERATION = \"The @inject @multiInject @tagged and @named decorators \" +\n    \"must be applied to the parameters of a class constructor or a class property.\";\nexport var ARGUMENTS_LENGTH_MISMATCH = function () {\n    var values = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n    }\n    return \"The number of constructor arguments in the derived class \" +\n        (values[0] + \" must be >= than the number of constructor arguments of its base class.\");\n};\nexport var CONTAINER_OPTIONS_MUST_BE_AN_OBJECT = \"Invalid Container constructor argument. Container options \" +\n    \"must be an object.\";\nexport var CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE = \"Invalid Container option. Default scope must \" +\n    \"be a string ('singleton' or 'transient').\";\nexport var CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE = \"Invalid Container option. Auto bind injectable must \" +\n    \"be a boolean\";\nexport var CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK = \"Invalid Container option. Skip base check must \" +\n    \"be a boolean\";\nexport var MULTIPLE_POST_CONSTRUCT_METHODS = \"Cannot apply @postConstruct decorator multiple times in the same class\";\nexport var POST_CONSTRUCT_ERROR = function () {\n    var values = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n    }\n    return \"@postConstruct error in class \" + values[0] + \": \" + values[1];\n};\nexport var CIRCULAR_DEPENDENCY_IN_FACTORY = function () {\n    var values = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n    }\n    return \"It looks like there is a circular dependency \" +\n        (\"in one of the '\" + values[0] + \"' bindings. Please investigate bindings with\") +\n        (\"service identifier '\" + values[1] + \"'.\");\n};\nexport var STACK_OVERFLOW = \"Maximum call stack size exceeded\";\n","import * as ERROR_MSGS from \"../constants/error_msgs\";\nfunction getServiceIdentifierAsString(serviceIdentifier) {\n    if (typeof serviceIdentifier === \"function\") {\n        var _serviceIdentifier = serviceIdentifier;\n        return _serviceIdentifier.name;\n    }\n    else if (typeof serviceIdentifier === \"symbol\") {\n        return serviceIdentifier.toString();\n    }\n    else {\n        var _serviceIdentifier = serviceIdentifier;\n        return _serviceIdentifier;\n    }\n}\nfunction listRegisteredBindingsForServiceIdentifier(container, serviceIdentifier, getBindings) {\n    var registeredBindingsList = \"\";\n    var registeredBindings = getBindings(container, serviceIdentifier);\n    if (registeredBindings.length !== 0) {\n        registeredBindingsList = \"\\nRegistered bindings:\";\n        registeredBindings.forEach(function (binding) {\n            var name = \"Object\";\n            if (binding.implementationType !== null) {\n                name = getFunctionName(binding.implementationType);\n            }\n            registeredBindingsList = registeredBindingsList + \"\\n \" + name;\n            if (binding.constraint.metaData) {\n                registeredBindingsList = registeredBindingsList + \" - \" + binding.constraint.metaData;\n            }\n        });\n    }\n    return registeredBindingsList;\n}\nfunction alreadyDependencyChain(request, serviceIdentifier) {\n    if (request.parentRequest === null) {\n        return false;\n    }\n    else if (request.parentRequest.serviceIdentifier === serviceIdentifier) {\n        return true;\n    }\n    else {\n        return alreadyDependencyChain(request.parentRequest, serviceIdentifier);\n    }\n}\nfunction dependencyChainToString(request) {\n    function _createStringArr(req, result) {\n        if (result === void 0) { result = []; }\n        var serviceIdentifier = getServiceIdentifierAsString(req.serviceIdentifier);\n        result.push(serviceIdentifier);\n        if (req.parentRequest !== null) {\n            return _createStringArr(req.parentRequest, result);\n        }\n        return result;\n    }\n    var stringArr = _createStringArr(request);\n    return stringArr.reverse().join(\" --> \");\n}\nfunction circularDependencyToException(request) {\n    request.childRequests.forEach(function (childRequest) {\n        if (alreadyDependencyChain(childRequest, childRequest.serviceIdentifier)) {\n            var services = dependencyChainToString(childRequest);\n            throw new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY + \" \" + services);\n        }\n        else {\n            circularDependencyToException(childRequest);\n        }\n    });\n}\nfunction listMetadataForTarget(serviceIdentifierString, target) {\n    if (target.isTagged() || target.isNamed()) {\n        var m_1 = \"\";\n        var namedTag = target.getNamedTag();\n        var otherTags = target.getCustomTags();\n        if (namedTag !== null) {\n            m_1 += namedTag.toString() + \"\\n\";\n        }\n        if (otherTags !== null) {\n            otherTags.forEach(function (tag) {\n                m_1 += tag.toString() + \"\\n\";\n            });\n        }\n        return \" \" + serviceIdentifierString + \"\\n \" + serviceIdentifierString + \" - \" + m_1;\n    }\n    else {\n        return \" \" + serviceIdentifierString;\n    }\n}\nfunction getFunctionName(v) {\n    if (v.name) {\n        return v.name;\n    }\n    else {\n        var name_1 = v.toString();\n        var match = name_1.match(/^function\\s*([^\\s(]+)/);\n        return match ? match[1] : \"Anonymous function: \" + name_1;\n    }\n}\nexport { getFunctionName, getServiceIdentifierAsString, listRegisteredBindingsForServiceIdentifier, listMetadataForTarget, circularDependencyToException };\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { LazyServiceIdentifer } from \"../annotation/inject\";\nimport * as ERROR_MSGS from \"../constants/error_msgs\";\nimport { TargetTypeEnum } from \"../constants/literal_types\";\nimport * as METADATA_KEY from \"../constants/metadata_keys\";\nimport { getFunctionName } from \"../utils/serialization\";\nimport { Target } from \"./target\";\nfunction getDependencies(metadataReader, func) {\n    var constructorName = getFunctionName(func);\n    var targets = getTargets(metadataReader, constructorName, func, false);\n    return targets;\n}\nfunction getTargets(metadataReader, constructorName, func, isBaseClass) {\n    var metadata = metadataReader.getConstructorMetadata(func);\n    var serviceIdentifiers = metadata.compilerGeneratedMetadata;\n    if (serviceIdentifiers === undefined) {\n        var msg = ERROR_MSGS.MISSING_INJECTABLE_ANNOTATION + \" \" + constructorName + \".\";\n        throw new Error(msg);\n    }\n    var constructorArgsMetadata = metadata.userGeneratedMetadata;\n    var keys = Object.keys(constructorArgsMetadata);\n    var hasUserDeclaredUnknownInjections = (func.length === 0 && keys.length > 0);\n    var iterations = (hasUserDeclaredUnknownInjections) ? keys.length : func.length;\n    var constructorTargets = getConstructorArgsAsTargets(isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata, iterations);\n    var propertyTargets = getClassPropsAsTargets(metadataReader, func);\n    var targets = __spreadArrays(constructorTargets, propertyTargets);\n    return targets;\n}\nfunction getConstructorArgsAsTarget(index, isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata) {\n    var targetMetadata = constructorArgsMetadata[index.toString()] || [];\n    var metadata = formatTargetMetadata(targetMetadata);\n    var isManaged = metadata.unmanaged !== true;\n    var serviceIdentifier = serviceIdentifiers[index];\n    var injectIdentifier = (metadata.inject || metadata.multiInject);\n    serviceIdentifier = (injectIdentifier) ? (injectIdentifier) : serviceIdentifier;\n    if (serviceIdentifier instanceof LazyServiceIdentifer) {\n        serviceIdentifier = serviceIdentifier.unwrap();\n    }\n    if (isManaged) {\n        var isObject = serviceIdentifier === Object;\n        var isFunction = serviceIdentifier === Function;\n        var isUndefined = serviceIdentifier === undefined;\n        var isUnknownType = (isObject || isFunction || isUndefined);\n        if (!isBaseClass && isUnknownType) {\n            var msg = ERROR_MSGS.MISSING_INJECT_ANNOTATION + \" argument \" + index + \" in class \" + constructorName + \".\";\n            throw new Error(msg);\n        }\n        var target = new Target(TargetTypeEnum.ConstructorArgument, metadata.targetName, serviceIdentifier);\n        target.metadata = targetMetadata;\n        return target;\n    }\n    return null;\n}\nfunction getConstructorArgsAsTargets(isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata, iterations) {\n    var targets = [];\n    for (var i = 0; i < iterations; i++) {\n        var index = i;\n        var target = getConstructorArgsAsTarget(index, isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata);\n        if (target !== null) {\n            targets.push(target);\n        }\n    }\n    return targets;\n}\nfunction getClassPropsAsTargets(metadataReader, constructorFunc) {\n    var classPropsMetadata = metadataReader.getPropertiesMetadata(constructorFunc);\n    var targets = [];\n    var keys = Object.keys(classPropsMetadata);\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n        var key = keys_1[_i];\n        var targetMetadata = classPropsMetadata[key];\n        var metadata = formatTargetMetadata(classPropsMetadata[key]);\n        var targetName = metadata.targetName || key;\n        var serviceIdentifier = (metadata.inject || metadata.multiInject);\n        var target = new Target(TargetTypeEnum.ClassProperty, targetName, serviceIdentifier);\n        target.metadata = targetMetadata;\n        targets.push(target);\n    }\n    var baseConstructor = Object.getPrototypeOf(constructorFunc.prototype).constructor;\n    if (baseConstructor !== Object) {\n        var baseTargets = getClassPropsAsTargets(metadataReader, baseConstructor);\n        targets = __spreadArrays(targets, baseTargets);\n    }\n    return targets;\n}\nfunction getBaseClassDependencyCount(metadataReader, func) {\n    var baseConstructor = Object.getPrototypeOf(func.prototype).constructor;\n    if (baseConstructor !== Object) {\n        var baseConstructorName = getFunctionName(baseConstructor);\n        var targets = getTargets(metadataReader, baseConstructorName, baseConstructor, true);\n        var metadata = targets.map(function (t) {\n            return t.metadata.filter(function (m) {\n                return m.key === METADATA_KEY.UNMANAGED_TAG;\n            });\n        });\n        var unmanagedCount = [].concat.apply([], metadata).length;\n        var dependencyCount = targets.length - unmanagedCount;\n        if (dependencyCount > 0) {\n            return dependencyCount;\n        }\n        else {\n            return getBaseClassDependencyCount(metadataReader, baseConstructor);\n        }\n    }\n    else {\n        return 0;\n    }\n}\nfunction formatTargetMetadata(targetMetadata) {\n    var targetMetadataMap = {};\n    targetMetadata.forEach(function (m) {\n        targetMetadataMap[m.key.toString()] = m.value;\n    });\n    return {\n        inject: targetMetadataMap[METADATA_KEY.INJECT_TAG],\n        multiInject: targetMetadataMap[METADATA_KEY.MULTI_INJECT_TAG],\n        targetName: targetMetadataMap[METADATA_KEY.NAME_TAG],\n        unmanaged: targetMetadataMap[METADATA_KEY.UNMANAGED_TAG]\n    };\n}\nexport { getDependencies, getBaseClassDependencyCount, getFunctionName };\n","import { BindingCount } from \"../bindings/binding_count\";\nimport * as ERROR_MSGS from \"../constants/error_msgs\";\nimport { BindingTypeEnum, TargetTypeEnum } from \"../constants/literal_types\";\nimport * as METADATA_KEY from \"../constants/metadata_keys\";\nimport { isStackOverflowExeption } from \"../utils/exceptions\";\nimport { circularDependencyToException, getServiceIdentifierAsString, listMetadataForTarget, listRegisteredBindingsForServiceIdentifier } from \"../utils/serialization\";\nimport { Context } from \"./context\";\nimport { Metadata } from \"./metadata\";\nimport { Plan } from \"./plan\";\nimport { getBaseClassDependencyCount, getDependencies, getFunctionName } from \"./reflection_utils\";\nimport { Request } from \"./request\";\nimport { Target } from \"./target\";\nfunction getBindingDictionary(cntnr) {\n    return cntnr._bindingDictionary;\n}\nfunction _createTarget(isMultiInject, targetType, serviceIdentifier, name, key, value) {\n    var metadataKey = isMultiInject ? METADATA_KEY.MULTI_INJECT_TAG : METADATA_KEY.INJECT_TAG;\n    var injectMetadata = new Metadata(metadataKey, serviceIdentifier);\n    var target = new Target(targetType, name, serviceIdentifier, injectMetadata);\n    if (key !== undefined) {\n        var tagMetadata = new Metadata(key, value);\n        target.metadata.push(tagMetadata);\n    }\n    return target;\n}\nfunction _getActiveBindings(metadataReader, avoidConstraints, context, parentRequest, target) {\n    var bindings = getBindings(context.container, target.serviceIdentifier);\n    var activeBindings = [];\n    if (bindings.length === BindingCount.NoBindingsAvailable &&\n        context.container.options.autoBindInjectable &&\n        typeof target.serviceIdentifier === \"function\" &&\n        metadataReader.getConstructorMetadata(target.serviceIdentifier).compilerGeneratedMetadata) {\n        context.container.bind(target.serviceIdentifier).toSelf();\n        bindings = getBindings(context.container, target.serviceIdentifier);\n    }\n    if (!avoidConstraints) {\n        activeBindings = bindings.filter(function (binding) {\n            var request = new Request(binding.serviceIdentifier, context, parentRequest, binding, target);\n            return binding.constraint(request);\n        });\n    }\n    else {\n        activeBindings = bindings;\n    }\n    _validateActiveBindingCount(target.serviceIdentifier, activeBindings, target, context.container);\n    return activeBindings;\n}\nfunction _validateActiveBindingCount(serviceIdentifier, bindings, target, container) {\n    switch (bindings.length) {\n        case BindingCount.NoBindingsAvailable:\n            if (target.isOptional()) {\n                return bindings;\n            }\n            else {\n                var serviceIdentifierString = getServiceIdentifierAsString(serviceIdentifier);\n                var msg = ERROR_MSGS.NOT_REGISTERED;\n                msg += listMetadataForTarget(serviceIdentifierString, target);\n                msg += listRegisteredBindingsForServiceIdentifier(container, serviceIdentifierString, getBindings);\n                throw new Error(msg);\n            }\n        case BindingCount.OnlyOneBindingAvailable:\n            if (!target.isArray()) {\n                return bindings;\n            }\n        case BindingCount.MultipleBindingsAvailable:\n        default:\n            if (!target.isArray()) {\n                var serviceIdentifierString = getServiceIdentifierAsString(serviceIdentifier);\n                var msg = ERROR_MSGS.AMBIGUOUS_MATCH + \" \" + serviceIdentifierString;\n                msg += listRegisteredBindingsForServiceIdentifier(container, serviceIdentifierString, getBindings);\n                throw new Error(msg);\n            }\n            else {\n                return bindings;\n            }\n    }\n}\nfunction _createSubRequests(metadataReader, avoidConstraints, serviceIdentifier, context, parentRequest, target) {\n    var activeBindings;\n    var childRequest;\n    if (parentRequest === null) {\n        activeBindings = _getActiveBindings(metadataReader, avoidConstraints, context, null, target);\n        childRequest = new Request(serviceIdentifier, context, null, activeBindings, target);\n        var thePlan = new Plan(context, childRequest);\n        context.addPlan(thePlan);\n    }\n    else {\n        activeBindings = _getActiveBindings(metadataReader, avoidConstraints, context, parentRequest, target);\n        childRequest = parentRequest.addChildRequest(target.serviceIdentifier, activeBindings, target);\n    }\n    activeBindings.forEach(function (binding) {\n        var subChildRequest = null;\n        if (target.isArray()) {\n            subChildRequest = childRequest.addChildRequest(binding.serviceIdentifier, binding, target);\n        }\n        else {\n            if (binding.cache) {\n                return;\n            }\n            subChildRequest = childRequest;\n        }\n        if (binding.type === BindingTypeEnum.Instance && binding.implementationType !== null) {\n            var dependencies = getDependencies(metadataReader, binding.implementationType);\n            if (!context.container.options.skipBaseClassChecks) {\n                var baseClassDependencyCount = getBaseClassDependencyCount(metadataReader, binding.implementationType);\n                if (dependencies.length < baseClassDependencyCount) {\n                    var error = ERROR_MSGS.ARGUMENTS_LENGTH_MISMATCH(getFunctionName(binding.implementationType));\n                    throw new Error(error);\n                }\n            }\n            dependencies.forEach(function (dependency) {\n                _createSubRequests(metadataReader, false, dependency.serviceIdentifier, context, subChildRequest, dependency);\n            });\n        }\n    });\n}\nfunction getBindings(container, serviceIdentifier) {\n    var bindings = [];\n    var bindingDictionary = getBindingDictionary(container);\n    if (bindingDictionary.hasKey(serviceIdentifier)) {\n        bindings = bindingDictionary.get(serviceIdentifier);\n    }\n    else if (container.parent !== null) {\n        bindings = getBindings(container.parent, serviceIdentifier);\n    }\n    return bindings;\n}\nfunction plan(metadataReader, container, isMultiInject, targetType, serviceIdentifier, key, value, avoidConstraints) {\n    if (avoidConstraints === void 0) { avoidConstraints = false; }\n    var context = new Context(container);\n    var target = _createTarget(isMultiInject, targetType, serviceIdentifier, \"\", key, value);\n    try {\n        _createSubRequests(metadataReader, avoidConstraints, serviceIdentifier, context, null, target);\n        return context;\n    }\n    catch (error) {\n        if (isStackOverflowExeption(error)) {\n            if (context.plan) {\n                circularDependencyToException(context.plan.rootRequest);\n            }\n        }\n        throw error;\n    }\n}\nfunction createMockRequest(container, serviceIdentifier, key, value) {\n    var target = new Target(TargetTypeEnum.Variable, \"\", serviceIdentifier, new Metadata(key, value));\n    var context = new Context(container);\n    var request = new Request(serviceIdentifier, context, null, [], target);\n    return request;\n}\nexport { plan, createMockRequest, getBindingDictionary };\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { POST_CONSTRUCT_ERROR } from \"../constants/error_msgs\";\nimport { TargetTypeEnum } from \"../constants/literal_types\";\nimport * as METADATA_KEY from \"../constants/metadata_keys\";\nfunction _injectProperties(instance, childRequests, resolveRequest) {\n    var propertyInjectionsRequests = childRequests.filter(function (childRequest) {\n        return (childRequest.target !== null &&\n            childRequest.target.type === TargetTypeEnum.ClassProperty);\n    });\n    var propertyInjections = propertyInjectionsRequests.map(resolveRequest);\n    propertyInjectionsRequests.forEach(function (r, index) {\n        var propertyName = \"\";\n        propertyName = r.target.name.value();\n        var injection = propertyInjections[index];\n        instance[propertyName] = injection;\n    });\n    return instance;\n}\nfunction _createInstance(Func, injections) {\n    return new (Func.bind.apply(Func, __spreadArrays([void 0], injections)))();\n}\nfunction _postConstruct(constr, result) {\n    if (Reflect.hasMetadata(METADATA_KEY.POST_CONSTRUCT, constr)) {\n        var data = Reflect.getMetadata(METADATA_KEY.POST_CONSTRUCT, constr);\n        try {\n            result[data.value]();\n        }\n        catch (e) {\n            throw new Error(POST_CONSTRUCT_ERROR(constr.name, e.message));\n        }\n    }\n}\nfunction resolveInstance(constr, childRequests, resolveRequest) {\n    var result = null;\n    if (childRequests.length > 0) {\n        var constructorInjectionsRequests = childRequests.filter(function (childRequest) {\n            return (childRequest.target !== null && childRequest.target.type === TargetTypeEnum.ConstructorArgument);\n        });\n        var constructorInjections = constructorInjectionsRequests.map(resolveRequest);\n        result = _createInstance(constr, constructorInjections);\n        result = _injectProperties(result, childRequests, resolveRequest);\n    }\n    else {\n        result = new constr();\n    }\n    _postConstruct(constr, result);\n    return result;\n}\nexport { resolveInstance };\n","import * as ERROR_MSGS from \"../constants/error_msgs\";\nimport { BindingScopeEnum, BindingTypeEnum } from \"../constants/literal_types\";\nimport { isStackOverflowExeption } from \"../utils/exceptions\";\nimport { getServiceIdentifierAsString } from \"../utils/serialization\";\nimport { resolveInstance } from \"./instantiation\";\nvar invokeFactory = function (factoryType, serviceIdentifier, fn) {\n    try {\n        return fn();\n    }\n    catch (error) {\n        if (isStackOverflowExeption(error)) {\n            throw new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY_IN_FACTORY(factoryType, serviceIdentifier.toString()));\n        }\n        else {\n            throw error;\n        }\n    }\n};\nvar _resolveRequest = function (requestScope) {\n    return function (request) {\n        request.parentContext.setCurrentRequest(request);\n        var bindings = request.bindings;\n        var childRequests = request.childRequests;\n        var targetIsAnArray = request.target && request.target.isArray();\n        var targetParentIsNotAnArray = !request.parentRequest ||\n            !request.parentRequest.target ||\n            !request.target ||\n            !request.parentRequest.target.matchesArray(request.target.serviceIdentifier);\n        if (targetIsAnArray && targetParentIsNotAnArray) {\n            return childRequests.map(function (childRequest) {\n                var _f = _resolveRequest(requestScope);\n                return _f(childRequest);\n            });\n        }\n        else {\n            var result = null;\n            if (request.target.isOptional() && bindings.length === 0) {\n                return undefined;\n            }\n            var binding_1 = bindings[0];\n            var isSingleton = binding_1.scope === BindingScopeEnum.Singleton;\n            var isRequestSingleton = binding_1.scope === BindingScopeEnum.Request;\n            if (isSingleton && binding_1.activated) {\n                return binding_1.cache;\n            }\n            if (isRequestSingleton &&\n                requestScope !== null &&\n                requestScope.has(binding_1.id)) {\n                return requestScope.get(binding_1.id);\n            }\n            if (binding_1.type === BindingTypeEnum.ConstantValue) {\n                result = binding_1.cache;\n            }\n            else if (binding_1.type === BindingTypeEnum.Function) {\n                result = binding_1.cache;\n            }\n            else if (binding_1.type === BindingTypeEnum.Constructor) {\n                result = binding_1.implementationType;\n            }\n            else if (binding_1.type === BindingTypeEnum.DynamicValue && binding_1.dynamicValue !== null) {\n                result = invokeFactory(\"toDynamicValue\", binding_1.serviceIdentifier, function () { return binding_1.dynamicValue(request.parentContext); });\n            }\n            else if (binding_1.type === BindingTypeEnum.Factory && binding_1.factory !== null) {\n                result = invokeFactory(\"toFactory\", binding_1.serviceIdentifier, function () { return binding_1.factory(request.parentContext); });\n            }\n            else if (binding_1.type === BindingTypeEnum.Provider && binding_1.provider !== null) {\n                result = invokeFactory(\"toProvider\", binding_1.serviceIdentifier, function () { return binding_1.provider(request.parentContext); });\n            }\n            else if (binding_1.type === BindingTypeEnum.Instance && binding_1.implementationType !== null) {\n                result = resolveInstance(binding_1.implementationType, childRequests, _resolveRequest(requestScope));\n            }\n            else {\n                var serviceIdentifier = getServiceIdentifierAsString(request.serviceIdentifier);\n                throw new Error(ERROR_MSGS.INVALID_BINDING_TYPE + \" \" + serviceIdentifier);\n            }\n            if (typeof binding_1.onActivation === \"function\") {\n                result = binding_1.onActivation(request.parentContext, result);\n            }\n            if (isSingleton) {\n                binding_1.cache = result;\n                binding_1.activated = true;\n            }\n            if (isRequestSingleton &&\n                requestScope !== null &&\n                !requestScope.has(binding_1.id)) {\n                requestScope.set(binding_1.id, result);\n            }\n            return result;\n        }\n    };\n};\nfunction resolve(context) {\n    var _f = _resolveRequest(context.plan.rootRequest.requestScope);\n    return _f(context.plan.rootRequest);\n}\nexport { resolve };\n","var INJECTION = Symbol.for(\"INJECTION\");\nfunction _proxyGetter(proto, key, resolve, doCache) {\n    function getter() {\n        if (doCache && !Reflect.hasMetadata(INJECTION, this, key)) {\n            Reflect.defineMetadata(INJECTION, resolve(), this, key);\n        }\n        if (Reflect.hasMetadata(INJECTION, this, key)) {\n            return Reflect.getMetadata(INJECTION, this, key);\n        }\n        else {\n            return resolve();\n        }\n    }\n    function setter(newVal) {\n        Reflect.defineMetadata(INJECTION, newVal, this, key);\n    }\n    Object.defineProperty(proto, key, {\n        configurable: true,\n        enumerable: true,\n        get: getter,\n        set: setter\n    });\n}\nfunction makePropertyInjectDecorator(container, doCache) {\n    return function (serviceIdentifier) {\n        return function (proto, key) {\n            var resolve = function () {\n                return container.get(serviceIdentifier);\n            };\n            _proxyGetter(proto, key, resolve, doCache);\n        };\n    };\n}\nfunction makePropertyInjectNamedDecorator(container, doCache) {\n    return function (serviceIdentifier, named) {\n        return function (proto, key) {\n            var resolve = function () {\n                return container.getNamed(serviceIdentifier, named);\n            };\n            _proxyGetter(proto, key, resolve, doCache);\n        };\n    };\n}\nfunction makePropertyInjectTaggedDecorator(container, doCache) {\n    return function (serviceIdentifier, key, value) {\n        return function (proto, propertyName) {\n            var resolve = function () {\n                return container.getTagged(serviceIdentifier, key, value);\n            };\n            _proxyGetter(proto, propertyName, resolve, doCache);\n        };\n    };\n}\nfunction makePropertyMultiInjectDecorator(container, doCache) {\n    return function (serviceIdentifier) {\n        return function (proto, key) {\n            var resolve = function () {\n                return container.getAll(serviceIdentifier);\n            };\n            _proxyGetter(proto, key, resolve, doCache);\n        };\n    };\n}\nexport { makePropertyInjectDecorator, makePropertyMultiInjectDecorator, makePropertyInjectTaggedDecorator, makePropertyInjectNamedDecorator };\n","export var NAMED_TAG = \"named\";\nexport var NAME_TAG = \"name\";\nexport var UNMANAGED_TAG = \"unmanaged\";\nexport var OPTIONAL_TAG = \"optional\";\nexport var INJECT_TAG = \"inject\";\nexport var MULTI_INJECT_TAG = \"multi_inject\";\nexport var TAGGED = \"inversify:tagged\";\nexport var TAGGED_PROP = \"inversify:tagged_props\";\nexport var PARAM_TYPES = \"inversify:paramtypes\";\nexport var DESIGN_PARAM_TYPES = \"design:paramtypes\";\nexport var POST_CONSTRUCT = \"post_construct\";\n","var BindingScopeEnum = {\n    Request: \"Request\",\n    Singleton: \"Singleton\",\n    Transient: \"Transient\"\n};\nvar BindingTypeEnum = {\n    ConstantValue: \"ConstantValue\",\n    Constructor: \"Constructor\",\n    DynamicValue: \"DynamicValue\",\n    Factory: \"Factory\",\n    Function: \"Function\",\n    Instance: \"Instance\",\n    Invalid: \"Invalid\",\n    Provider: \"Provider\"\n};\nvar TargetTypeEnum = {\n    ClassProperty: \"ClassProperty\",\n    ConstructorArgument: \"ConstructorArgument\",\n    Variable: \"Variable\"\n};\nexport { BindingScopeEnum, BindingTypeEnum, TargetTypeEnum };\n","import { BindingTypeEnum } from \"../constants/literal_types\";\nimport { id } from \"../utils/id\";\nvar Binding = (function () {\n    function Binding(serviceIdentifier, scope) {\n        this.id = id();\n        this.activated = false;\n        this.serviceIdentifier = serviceIdentifier;\n        this.scope = scope;\n        this.type = BindingTypeEnum.Invalid;\n        this.constraint = function (request) { return true; };\n        this.implementationType = null;\n        this.cache = null;\n        this.factory = null;\n        this.provider = null;\n        this.onActivation = null;\n        this.dynamicValue = null;\n    }\n    Binding.prototype.clone = function () {\n        var clone = new Binding(this.serviceIdentifier, this.scope);\n        clone.activated = false;\n        clone.implementationType = this.implementationType;\n        clone.dynamicValue = this.dynamicValue;\n        clone.scope = this.scope;\n        clone.type = this.type;\n        clone.factory = this.factory;\n        clone.provider = this.provider;\n        clone.constraint = this.constraint;\n        clone.onActivation = this.onActivation;\n        clone.cache = this.cache;\n        return clone;\n    };\n    return Binding;\n}());\nexport { Binding };\n","import * as METADATA_KEY from \"../constants/metadata_keys\";\nvar MetadataReader = (function () {\n    function MetadataReader() {\n    }\n    MetadataReader.prototype.getConstructorMetadata = function (constructorFunc) {\n        var compilerGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.PARAM_TYPES, constructorFunc);\n        var userGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.TAGGED, constructorFunc);\n        return {\n            compilerGeneratedMetadata: compilerGeneratedMetadata,\n            userGeneratedMetadata: userGeneratedMetadata || {}\n        };\n    };\n    MetadataReader.prototype.getPropertiesMetadata = function (constructorFunc) {\n        var userGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.TAGGED_PROP, constructorFunc) || [];\n        return userGeneratedMetadata;\n    };\n    return MetadataReader;\n}());\nexport { MetadataReader };\n","var BindingCount = {\n    MultipleBindingsAvailable: 2,\n    NoBindingsAvailable: 0,\n    OnlyOneBindingAvailable: 1\n};\nexport { BindingCount };\n","import { id } from \"../utils/id\";\nvar Context = (function () {\n    function Context(container) {\n        this.id = id();\n        this.container = container;\n    }\n    Context.prototype.addPlan = function (plan) {\n        this.plan = plan;\n    };\n    Context.prototype.setCurrentRequest = function (currentRequest) {\n        this.currentRequest = currentRequest;\n    };\n    return Context;\n}());\nexport { Context };\n","import * as METADATA_KEY from \"../constants/metadata_keys\";\nvar Metadata = (function () {\n    function Metadata(key, value) {\n        this.key = key;\n        this.value = value;\n    }\n    Metadata.prototype.toString = function () {\n        if (this.key === METADATA_KEY.NAMED_TAG) {\n            return \"named: \" + this.value.toString() + \" \";\n        }\n        else {\n            return \"tagged: { key:\" + this.key.toString() + \", value: \" + this.value + \" }\";\n        }\n    };\n    return Metadata;\n}());\nexport { Metadata };\n","var Plan = (function () {\n    function Plan(parentContext, rootRequest) {\n        this.parentContext = parentContext;\n        this.rootRequest = rootRequest;\n    }\n    return Plan;\n}());\nexport { Plan };\n","import { UNDEFINED_INJECT_ANNOTATION } from \"../constants/error_msgs\";\nimport * as METADATA_KEY from \"../constants/metadata_keys\";\nimport { Metadata } from \"../planning/metadata\";\nimport { tagParameter, tagProperty } from \"./decorator_utils\";\nvar LazyServiceIdentifer = (function () {\n    function LazyServiceIdentifer(cb) {\n        this._cb = cb;\n    }\n    LazyServiceIdentifer.prototype.unwrap = function () {\n        return this._cb();\n    };\n    return LazyServiceIdentifer;\n}());\nexport { LazyServiceIdentifer };\nfunction inject(serviceIdentifier) {\n    return function (target, targetKey, index) {\n        if (serviceIdentifier === undefined) {\n            throw new Error(UNDEFINED_INJECT_ANNOTATION(target.name));\n        }\n        var metadata = new Metadata(METADATA_KEY.INJECT_TAG, serviceIdentifier);\n        if (typeof index === \"number\") {\n            tagParameter(target, targetKey, index, metadata);\n        }\n        else {\n            tagProperty(target, targetKey, metadata);\n        }\n    };\n}\nexport { inject };\n","var QueryableString = (function () {\n    function QueryableString(str) {\n        this.str = str;\n    }\n    QueryableString.prototype.startsWith = function (searchString) {\n        return this.str.indexOf(searchString) === 0;\n    };\n    QueryableString.prototype.endsWith = function (searchString) {\n        var reverseString = \"\";\n        var reverseSearchString = searchString.split(\"\").reverse().join(\"\");\n        reverseString = this.str.split(\"\").reverse().join(\"\");\n        return this.startsWith.call({ str: reverseString }, reverseSearchString);\n    };\n    QueryableString.prototype.contains = function (searchString) {\n        return (this.str.indexOf(searchString) !== -1);\n    };\n    QueryableString.prototype.equals = function (compareString) {\n        return this.str === compareString;\n    };\n    QueryableString.prototype.value = function () {\n        return this.str;\n    };\n    return QueryableString;\n}());\nexport { QueryableString };\n","import * as METADATA_KEY from \"../constants/metadata_keys\";\nimport { id } from \"../utils/id\";\nimport { Metadata } from \"./metadata\";\nimport { QueryableString } from \"./queryable_string\";\nvar Target = (function () {\n    function Target(type, name, serviceIdentifier, namedOrTagged) {\n        this.id = id();\n        this.type = type;\n        this.serviceIdentifier = serviceIdentifier;\n        this.name = new QueryableString(name || \"\");\n        this.metadata = new Array();\n        var metadataItem = null;\n        if (typeof namedOrTagged === \"string\") {\n            metadataItem = new Metadata(METADATA_KEY.NAMED_TAG, namedOrTagged);\n        }\n        else if (namedOrTagged instanceof Metadata) {\n            metadataItem = namedOrTagged;\n        }\n        if (metadataItem !== null) {\n            this.metadata.push(metadataItem);\n        }\n    }\n    Target.prototype.hasTag = function (key) {\n        for (var _i = 0, _a = this.metadata; _i < _a.length; _i++) {\n            var m = _a[_i];\n            if (m.key === key) {\n                return true;\n            }\n        }\n        return false;\n    };\n    Target.prototype.isArray = function () {\n        return this.hasTag(METADATA_KEY.MULTI_INJECT_TAG);\n    };\n    Target.prototype.matchesArray = function (name) {\n        return this.matchesTag(METADATA_KEY.MULTI_INJECT_TAG)(name);\n    };\n    Target.prototype.isNamed = function () {\n        return this.hasTag(METADATA_KEY.NAMED_TAG);\n    };\n    Target.prototype.isTagged = function () {\n        return this.metadata.some(function (m) {\n            return (m.key !== METADATA_KEY.INJECT_TAG) &&\n                (m.key !== METADATA_KEY.MULTI_INJECT_TAG) &&\n                (m.key !== METADATA_KEY.NAME_TAG) &&\n                (m.key !== METADATA_KEY.UNMANAGED_TAG) &&\n                (m.key !== METADATA_KEY.NAMED_TAG);\n        });\n    };\n    Target.prototype.isOptional = function () {\n        return this.matchesTag(METADATA_KEY.OPTIONAL_TAG)(true);\n    };\n    Target.prototype.getNamedTag = function () {\n        if (this.isNamed()) {\n            return this.metadata.filter(function (m) { return m.key === METADATA_KEY.NAMED_TAG; })[0];\n        }\n        return null;\n    };\n    Target.prototype.getCustomTags = function () {\n        if (this.isTagged()) {\n            return this.metadata.filter(function (m) {\n                return (m.key !== METADATA_KEY.INJECT_TAG) &&\n                    (m.key !== METADATA_KEY.MULTI_INJECT_TAG) &&\n                    (m.key !== METADATA_KEY.NAME_TAG) &&\n                    (m.key !== METADATA_KEY.UNMANAGED_TAG) &&\n                    (m.key !== METADATA_KEY.NAMED_TAG);\n            });\n        }\n        return null;\n    };\n    Target.prototype.matchesNamedTag = function (name) {\n        return this.matchesTag(METADATA_KEY.NAMED_TAG)(name);\n    };\n    Target.prototype.matchesTag = function (key) {\n        var _this = this;\n        return function (value) {\n            for (var _i = 0, _a = _this.metadata; _i < _a.length; _i++) {\n                var m = _a[_i];\n                if (m.key === key && m.value === value) {\n                    return true;\n                }\n            }\n            return false;\n        };\n    };\n    return Target;\n}());\nexport { Target };\n","import { id } from \"../utils/id\";\nvar Request = (function () {\n    function Request(serviceIdentifier, parentContext, parentRequest, bindings, target) {\n        this.id = id();\n        this.serviceIdentifier = serviceIdentifier;\n        this.parentContext = parentContext;\n        this.parentRequest = parentRequest;\n        this.target = target;\n        this.childRequests = [];\n        this.bindings = (Array.isArray(bindings) ? bindings : [bindings]);\n        this.requestScope = parentRequest === null\n            ? new Map()\n            : null;\n    }\n    Request.prototype.addChildRequest = function (serviceIdentifier, bindings, target) {\n        var child = new Request(serviceIdentifier, this.parentContext, this, bindings, target);\n        this.childRequests.push(child);\n        return child;\n    };\n    return Request;\n}());\nexport { Request };\n","import * as METADATA_KEY from \"../constants/metadata_keys\";\nimport { Metadata } from \"../planning/metadata\";\nvar traverseAncerstors = function (request, constraint) {\n    var parent = request.parentRequest;\n    if (parent !== null) {\n        return constraint(parent) ? true : traverseAncerstors(parent, constraint);\n    }\n    else {\n        return false;\n    }\n};\nvar taggedConstraint = function (key) { return function (value) {\n    var constraint = function (request) {\n        return request !== null && request.target !== null && request.target.matchesTag(key)(value);\n    };\n    constraint.metaData = new Metadata(key, value);\n    return constraint;\n}; };\nvar namedConstraint = taggedConstraint(METADATA_KEY.NAMED_TAG);\nvar typeConstraint = function (type) { return function (request) {\n    var binding = null;\n    if (request !== null) {\n        binding = request.bindings[0];\n        if (typeof type === \"string\") {\n            var serviceIdentifier = binding.serviceIdentifier;\n            return serviceIdentifier === type;\n        }\n        else {\n            var constructor = request.bindings[0].implementationType;\n            return type === constructor;\n        }\n    }\n    return false;\n}; };\nexport { traverseAncerstors, taggedConstraint, namedConstraint, typeConstraint };\n","import { BindingOnSyntax } from \"./binding_on_syntax\";\nimport { namedConstraint, taggedConstraint, traverseAncerstors, typeConstraint } from \"./constraint_helpers\";\nvar BindingWhenSyntax = (function () {\n    function BindingWhenSyntax(binding) {\n        this._binding = binding;\n    }\n    BindingWhenSyntax.prototype.when = function (constraint) {\n        this._binding.constraint = constraint;\n        return new BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenTargetNamed = function (name) {\n        this._binding.constraint = namedConstraint(name);\n        return new BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenTargetIsDefault = function () {\n        this._binding.constraint = function (request) {\n            var targetIsDefault = (request.target !== null) &&\n                (!request.target.isNamed()) &&\n                (!request.target.isTagged());\n            return targetIsDefault;\n        };\n        return new BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenTargetTagged = function (tag, value) {\n        this._binding.constraint = taggedConstraint(tag)(value);\n        return new BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenInjectedInto = function (parent) {\n        this._binding.constraint = function (request) {\n            return typeConstraint(parent)(request.parentRequest);\n        };\n        return new BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenParentNamed = function (name) {\n        this._binding.constraint = function (request) {\n            return namedConstraint(name)(request.parentRequest);\n        };\n        return new BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenParentTagged = function (tag, value) {\n        this._binding.constraint = function (request) {\n            return taggedConstraint(tag)(value)(request.parentRequest);\n        };\n        return new BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\n        this._binding.constraint = function (request) {\n            return traverseAncerstors(request, typeConstraint(ancestor));\n        };\n        return new BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenNoAncestorIs = function (ancestor) {\n        this._binding.constraint = function (request) {\n            return !traverseAncerstors(request, typeConstraint(ancestor));\n        };\n        return new BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenAnyAncestorNamed = function (name) {\n        this._binding.constraint = function (request) {\n            return traverseAncerstors(request, namedConstraint(name));\n        };\n        return new BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenNoAncestorNamed = function (name) {\n        this._binding.constraint = function (request) {\n            return !traverseAncerstors(request, namedConstraint(name));\n        };\n        return new BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\n        this._binding.constraint = function (request) {\n            return traverseAncerstors(request, taggedConstraint(tag)(value));\n        };\n        return new BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\n        this._binding.constraint = function (request) {\n            return !traverseAncerstors(request, taggedConstraint(tag)(value));\n        };\n        return new BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\n        this._binding.constraint = function (request) {\n            return traverseAncerstors(request, constraint);\n        };\n        return new BindingOnSyntax(this._binding);\n    };\n    BindingWhenSyntax.prototype.whenNoAncestorMatches = function (constraint) {\n        this._binding.constraint = function (request) {\n            return !traverseAncerstors(request, constraint);\n        };\n        return new BindingOnSyntax(this._binding);\n    };\n    return BindingWhenSyntax;\n}());\nexport { BindingWhenSyntax };\n","import { BindingWhenSyntax } from \"./binding_when_syntax\";\nvar BindingOnSyntax = (function () {\n    function BindingOnSyntax(binding) {\n        this._binding = binding;\n    }\n    BindingOnSyntax.prototype.onActivation = function (handler) {\n        this._binding.onActivation = handler;\n        return new BindingWhenSyntax(this._binding);\n    };\n    return BindingOnSyntax;\n}());\nexport { BindingOnSyntax };\n","import { BindingOnSyntax } from \"./binding_on_syntax\";\nimport { BindingWhenSyntax } from \"./binding_when_syntax\";\nvar BindingWhenOnSyntax = (function () {\n    function BindingWhenOnSyntax(binding) {\n        this._binding = binding;\n        this._bindingWhenSyntax = new BindingWhenSyntax(this._binding);\n        this._bindingOnSyntax = new BindingOnSyntax(this._binding);\n    }\n    BindingWhenOnSyntax.prototype.when = function (constraint) {\n        return this._bindingWhenSyntax.when(constraint);\n    };\n    BindingWhenOnSyntax.prototype.whenTargetNamed = function (name) {\n        return this._bindingWhenSyntax.whenTargetNamed(name);\n    };\n    BindingWhenOnSyntax.prototype.whenTargetIsDefault = function () {\n        return this._bindingWhenSyntax.whenTargetIsDefault();\n    };\n    BindingWhenOnSyntax.prototype.whenTargetTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenTargetTagged(tag, value);\n    };\n    BindingWhenOnSyntax.prototype.whenInjectedInto = function (parent) {\n        return this._bindingWhenSyntax.whenInjectedInto(parent);\n    };\n    BindingWhenOnSyntax.prototype.whenParentNamed = function (name) {\n        return this._bindingWhenSyntax.whenParentNamed(name);\n    };\n    BindingWhenOnSyntax.prototype.whenParentTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenParentTagged(tag, value);\n    };\n    BindingWhenOnSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\n        return this._bindingWhenSyntax.whenAnyAncestorIs(ancestor);\n    };\n    BindingWhenOnSyntax.prototype.whenNoAncestorIs = function (ancestor) {\n        return this._bindingWhenSyntax.whenNoAncestorIs(ancestor);\n    };\n    BindingWhenOnSyntax.prototype.whenAnyAncestorNamed = function (name) {\n        return this._bindingWhenSyntax.whenAnyAncestorNamed(name);\n    };\n    BindingWhenOnSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenAnyAncestorTagged(tag, value);\n    };\n    BindingWhenOnSyntax.prototype.whenNoAncestorNamed = function (name) {\n        return this._bindingWhenSyntax.whenNoAncestorNamed(name);\n    };\n    BindingWhenOnSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenNoAncestorTagged(tag, value);\n    };\n    BindingWhenOnSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\n        return this._bindingWhenSyntax.whenAnyAncestorMatches(constraint);\n    };\n    BindingWhenOnSyntax.prototype.whenNoAncestorMatches = function (constraint) {\n        return this._bindingWhenSyntax.whenNoAncestorMatches(constraint);\n    };\n    BindingWhenOnSyntax.prototype.onActivation = function (handler) {\n        return this._bindingOnSyntax.onActivation(handler);\n    };\n    return BindingWhenOnSyntax;\n}());\nexport { BindingWhenOnSyntax };\n","import { BindingScopeEnum } from \"../constants/literal_types\";\nimport { BindingWhenOnSyntax } from \"./binding_when_on_syntax\";\nvar BindingInSyntax = (function () {\n    function BindingInSyntax(binding) {\n        this._binding = binding;\n    }\n    BindingInSyntax.prototype.inRequestScope = function () {\n        this._binding.scope = BindingScopeEnum.Request;\n        return new BindingWhenOnSyntax(this._binding);\n    };\n    BindingInSyntax.prototype.inSingletonScope = function () {\n        this._binding.scope = BindingScopeEnum.Singleton;\n        return new BindingWhenOnSyntax(this._binding);\n    };\n    BindingInSyntax.prototype.inTransientScope = function () {\n        this._binding.scope = BindingScopeEnum.Transient;\n        return new BindingWhenOnSyntax(this._binding);\n    };\n    return BindingInSyntax;\n}());\nexport { BindingInSyntax };\n","import { BindingInSyntax } from \"./binding_in_syntax\";\nimport { BindingOnSyntax } from \"./binding_on_syntax\";\nimport { BindingWhenSyntax } from \"./binding_when_syntax\";\nvar BindingInWhenOnSyntax = (function () {\n    function BindingInWhenOnSyntax(binding) {\n        this._binding = binding;\n        this._bindingWhenSyntax = new BindingWhenSyntax(this._binding);\n        this._bindingOnSyntax = new BindingOnSyntax(this._binding);\n        this._bindingInSyntax = new BindingInSyntax(binding);\n    }\n    BindingInWhenOnSyntax.prototype.inRequestScope = function () {\n        return this._bindingInSyntax.inRequestScope();\n    };\n    BindingInWhenOnSyntax.prototype.inSingletonScope = function () {\n        return this._bindingInSyntax.inSingletonScope();\n    };\n    BindingInWhenOnSyntax.prototype.inTransientScope = function () {\n        return this._bindingInSyntax.inTransientScope();\n    };\n    BindingInWhenOnSyntax.prototype.when = function (constraint) {\n        return this._bindingWhenSyntax.when(constraint);\n    };\n    BindingInWhenOnSyntax.prototype.whenTargetNamed = function (name) {\n        return this._bindingWhenSyntax.whenTargetNamed(name);\n    };\n    BindingInWhenOnSyntax.prototype.whenTargetIsDefault = function () {\n        return this._bindingWhenSyntax.whenTargetIsDefault();\n    };\n    BindingInWhenOnSyntax.prototype.whenTargetTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenTargetTagged(tag, value);\n    };\n    BindingInWhenOnSyntax.prototype.whenInjectedInto = function (parent) {\n        return this._bindingWhenSyntax.whenInjectedInto(parent);\n    };\n    BindingInWhenOnSyntax.prototype.whenParentNamed = function (name) {\n        return this._bindingWhenSyntax.whenParentNamed(name);\n    };\n    BindingInWhenOnSyntax.prototype.whenParentTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenParentTagged(tag, value);\n    };\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\n        return this._bindingWhenSyntax.whenAnyAncestorIs(ancestor);\n    };\n    BindingInWhenOnSyntax.prototype.whenNoAncestorIs = function (ancestor) {\n        return this._bindingWhenSyntax.whenNoAncestorIs(ancestor);\n    };\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorNamed = function (name) {\n        return this._bindingWhenSyntax.whenAnyAncestorNamed(name);\n    };\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenAnyAncestorTagged(tag, value);\n    };\n    BindingInWhenOnSyntax.prototype.whenNoAncestorNamed = function (name) {\n        return this._bindingWhenSyntax.whenNoAncestorNamed(name);\n    };\n    BindingInWhenOnSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\n        return this._bindingWhenSyntax.whenNoAncestorTagged(tag, value);\n    };\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\n        return this._bindingWhenSyntax.whenAnyAncestorMatches(constraint);\n    };\n    BindingInWhenOnSyntax.prototype.whenNoAncestorMatches = function (constraint) {\n        return this._bindingWhenSyntax.whenNoAncestorMatches(constraint);\n    };\n    BindingInWhenOnSyntax.prototype.onActivation = function (handler) {\n        return this._bindingOnSyntax.onActivation(handler);\n    };\n    return BindingInWhenOnSyntax;\n}());\nexport { BindingInWhenOnSyntax };\n","import * as ERROR_MSGS from \"../constants/error_msgs\";\nimport { BindingTypeEnum } from \"../constants/literal_types\";\nimport { BindingInWhenOnSyntax } from \"./binding_in_when_on_syntax\";\nimport { BindingWhenOnSyntax } from \"./binding_when_on_syntax\";\nvar BindingToSyntax = (function () {\n    function BindingToSyntax(binding) {\n        this._binding = binding;\n    }\n    BindingToSyntax.prototype.to = function (constructor) {\n        this._binding.type = BindingTypeEnum.Instance;\n        this._binding.implementationType = constructor;\n        return new BindingInWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toSelf = function () {\n        if (typeof this._binding.serviceIdentifier !== \"function\") {\n            throw new Error(\"\" + ERROR_MSGS.INVALID_TO_SELF_VALUE);\n        }\n        var self = this._binding.serviceIdentifier;\n        return this.to(self);\n    };\n    BindingToSyntax.prototype.toConstantValue = function (value) {\n        this._binding.type = BindingTypeEnum.ConstantValue;\n        this._binding.cache = value;\n        this._binding.dynamicValue = null;\n        this._binding.implementationType = null;\n        return new BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toDynamicValue = function (func) {\n        this._binding.type = BindingTypeEnum.DynamicValue;\n        this._binding.cache = null;\n        this._binding.dynamicValue = func;\n        this._binding.implementationType = null;\n        return new BindingInWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toConstructor = function (constructor) {\n        this._binding.type = BindingTypeEnum.Constructor;\n        this._binding.implementationType = constructor;\n        return new BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toFactory = function (factory) {\n        this._binding.type = BindingTypeEnum.Factory;\n        this._binding.factory = factory;\n        return new BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toFunction = function (func) {\n        if (typeof func !== \"function\") {\n            throw new Error(ERROR_MSGS.INVALID_FUNCTION_BINDING);\n        }\n        var bindingWhenOnSyntax = this.toConstantValue(func);\n        this._binding.type = BindingTypeEnum.Function;\n        return bindingWhenOnSyntax;\n    };\n    BindingToSyntax.prototype.toAutoFactory = function (serviceIdentifier) {\n        this._binding.type = BindingTypeEnum.Factory;\n        this._binding.factory = function (context) {\n            var autofactory = function () { return context.container.get(serviceIdentifier); };\n            return autofactory;\n        };\n        return new BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toProvider = function (provider) {\n        this._binding.type = BindingTypeEnum.Provider;\n        this._binding.provider = provider;\n        return new BindingWhenOnSyntax(this._binding);\n    };\n    BindingToSyntax.prototype.toService = function (service) {\n        this.toDynamicValue(function (context) { return context.container.get(service); });\n    };\n    return BindingToSyntax;\n}());\nexport { BindingToSyntax };\n","var ContainerSnapshot = (function () {\n    function ContainerSnapshot() {\n    }\n    ContainerSnapshot.of = function (bindings, middleware) {\n        var snapshot = new ContainerSnapshot();\n        snapshot.bindings = bindings;\n        snapshot.middleware = middleware;\n        return snapshot;\n    };\n    return ContainerSnapshot;\n}());\nexport { ContainerSnapshot };\n","import * as ERROR_MSGS from \"../constants/error_msgs\";\nvar Lookup = (function () {\n    function Lookup() {\n        this._map = new Map();\n    }\n    Lookup.prototype.getMap = function () {\n        return this._map;\n    };\n    Lookup.prototype.add = function (serviceIdentifier, value) {\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        if (value === null || value === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        var entry = this._map.get(serviceIdentifier);\n        if (entry !== undefined) {\n            entry.push(value);\n            this._map.set(serviceIdentifier, entry);\n        }\n        else {\n            this._map.set(serviceIdentifier, [value]);\n        }\n    };\n    Lookup.prototype.get = function (serviceIdentifier) {\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        var entry = this._map.get(serviceIdentifier);\n        if (entry !== undefined) {\n            return entry;\n        }\n        else {\n            throw new Error(ERROR_MSGS.KEY_NOT_FOUND);\n        }\n    };\n    Lookup.prototype.remove = function (serviceIdentifier) {\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        if (!this._map.delete(serviceIdentifier)) {\n            throw new Error(ERROR_MSGS.KEY_NOT_FOUND);\n        }\n    };\n    Lookup.prototype.removeByCondition = function (condition) {\n        var _this = this;\n        this._map.forEach(function (entries, key) {\n            var updatedEntries = entries.filter(function (entry) { return !condition(entry); });\n            if (updatedEntries.length > 0) {\n                _this._map.set(key, updatedEntries);\n            }\n            else {\n                _this._map.delete(key);\n            }\n        });\n    };\n    Lookup.prototype.hasKey = function (serviceIdentifier) {\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\n        }\n        return this._map.has(serviceIdentifier);\n    };\n    Lookup.prototype.clone = function () {\n        var copy = new Lookup();\n        this._map.forEach(function (value, key) {\n            value.forEach(function (b) { return copy.add(key, b.clone()); });\n        });\n        return copy;\n    };\n    Lookup.prototype.traverse = function (func) {\n        this._map.forEach(function (value, key) {\n            func(key, value);\n        });\n    };\n    return Lookup;\n}());\nexport { Lookup };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { Binding } from \"../bindings/binding\";\nimport * as ERROR_MSGS from \"../constants/error_msgs\";\nimport { BindingScopeEnum, TargetTypeEnum } from \"../constants/literal_types\";\nimport * as METADATA_KEY from \"../constants/metadata_keys\";\nimport { MetadataReader } from \"../planning/metadata_reader\";\nimport { createMockRequest, getBindingDictionary, plan } from \"../planning/planner\";\nimport { resolve } from \"../resolution/resolver\";\nimport { BindingToSyntax } from \"../syntax/binding_to_syntax\";\nimport { id } from \"../utils/id\";\nimport { getServiceIdentifierAsString } from \"../utils/serialization\";\nimport { ContainerSnapshot } from \"./container_snapshot\";\nimport { Lookup } from \"./lookup\";\nvar Container = (function () {\n    function Container(containerOptions) {\n        var options = containerOptions || {};\n        if (typeof options !== \"object\") {\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);\n        }\n        if (options.defaultScope === undefined) {\n            options.defaultScope = BindingScopeEnum.Transient;\n        }\n        else if (options.defaultScope !== BindingScopeEnum.Singleton &&\n            options.defaultScope !== BindingScopeEnum.Transient &&\n            options.defaultScope !== BindingScopeEnum.Request) {\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);\n        }\n        if (options.autoBindInjectable === undefined) {\n            options.autoBindInjectable = false;\n        }\n        else if (typeof options.autoBindInjectable !== \"boolean\") {\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);\n        }\n        if (options.skipBaseClassChecks === undefined) {\n            options.skipBaseClassChecks = false;\n        }\n        else if (typeof options.skipBaseClassChecks !== \"boolean\") {\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);\n        }\n        this.options = {\n            autoBindInjectable: options.autoBindInjectable,\n            defaultScope: options.defaultScope,\n            skipBaseClassChecks: options.skipBaseClassChecks\n        };\n        this.id = id();\n        this._bindingDictionary = new Lookup();\n        this._snapshots = [];\n        this._middleware = null;\n        this.parent = null;\n        this._metadataReader = new MetadataReader();\n    }\n    Container.merge = function (container1, container2) {\n        var container = new Container();\n        var bindingDictionary = getBindingDictionary(container);\n        var bindingDictionary1 = getBindingDictionary(container1);\n        var bindingDictionary2 = getBindingDictionary(container2);\n        function copyDictionary(origin, destination) {\n            origin.traverse(function (key, value) {\n                value.forEach(function (binding) {\n                    destination.add(binding.serviceIdentifier, binding.clone());\n                });\n            });\n        }\n        copyDictionary(bindingDictionary1, bindingDictionary);\n        copyDictionary(bindingDictionary2, bindingDictionary);\n        return container;\n    };\n    Container.prototype.load = function () {\n        var modules = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            modules[_i] = arguments[_i];\n        }\n        var getHelpers = this._getContainerModuleHelpersFactory();\n        for (var _a = 0, modules_1 = modules; _a < modules_1.length; _a++) {\n            var currentModule = modules_1[_a];\n            var containerModuleHelpers = getHelpers(currentModule.id);\n            currentModule.registry(containerModuleHelpers.bindFunction, containerModuleHelpers.unbindFunction, containerModuleHelpers.isboundFunction, containerModuleHelpers.rebindFunction);\n        }\n    };\n    Container.prototype.loadAsync = function () {\n        var modules = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            modules[_i] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var getHelpers, _a, modules_2, currentModule, containerModuleHelpers;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        getHelpers = this._getContainerModuleHelpersFactory();\n                        _a = 0, modules_2 = modules;\n                        _b.label = 1;\n                    case 1:\n                        if (!(_a < modules_2.length)) return [3, 4];\n                        currentModule = modules_2[_a];\n                        containerModuleHelpers = getHelpers(currentModule.id);\n                        return [4, currentModule.registry(containerModuleHelpers.bindFunction, containerModuleHelpers.unbindFunction, containerModuleHelpers.isboundFunction, containerModuleHelpers.rebindFunction)];\n                    case 2:\n                        _b.sent();\n                        _b.label = 3;\n                    case 3:\n                        _a++;\n                        return [3, 1];\n                    case 4: return [2];\n                }\n            });\n        });\n    };\n    Container.prototype.unload = function () {\n        var _this = this;\n        var modules = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            modules[_i] = arguments[_i];\n        }\n        var conditionFactory = function (expected) { return function (item) {\n            return item.moduleId === expected;\n        }; };\n        modules.forEach(function (module) {\n            var condition = conditionFactory(module.id);\n            _this._bindingDictionary.removeByCondition(condition);\n        });\n    };\n    Container.prototype.bind = function (serviceIdentifier) {\n        var scope = this.options.defaultScope || BindingScopeEnum.Transient;\n        var binding = new Binding(serviceIdentifier, scope);\n        this._bindingDictionary.add(serviceIdentifier, binding);\n        return new BindingToSyntax(binding);\n    };\n    Container.prototype.rebind = function (serviceIdentifier) {\n        this.unbind(serviceIdentifier);\n        return this.bind(serviceIdentifier);\n    };\n    Container.prototype.unbind = function (serviceIdentifier) {\n        try {\n            this._bindingDictionary.remove(serviceIdentifier);\n        }\n        catch (e) {\n            throw new Error(ERROR_MSGS.CANNOT_UNBIND + \" \" + getServiceIdentifierAsString(serviceIdentifier));\n        }\n    };\n    Container.prototype.unbindAll = function () {\n        this._bindingDictionary = new Lookup();\n    };\n    Container.prototype.isBound = function (serviceIdentifier) {\n        var bound = this._bindingDictionary.hasKey(serviceIdentifier);\n        if (!bound && this.parent) {\n            bound = this.parent.isBound(serviceIdentifier);\n        }\n        return bound;\n    };\n    Container.prototype.isBoundNamed = function (serviceIdentifier, named) {\n        return this.isBoundTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\n    };\n    Container.prototype.isBoundTagged = function (serviceIdentifier, key, value) {\n        var bound = false;\n        if (this._bindingDictionary.hasKey(serviceIdentifier)) {\n            var bindings = this._bindingDictionary.get(serviceIdentifier);\n            var request_1 = createMockRequest(this, serviceIdentifier, key, value);\n            bound = bindings.some(function (b) { return b.constraint(request_1); });\n        }\n        if (!bound && this.parent) {\n            bound = this.parent.isBoundTagged(serviceIdentifier, key, value);\n        }\n        return bound;\n    };\n    Container.prototype.snapshot = function () {\n        this._snapshots.push(ContainerSnapshot.of(this._bindingDictionary.clone(), this._middleware));\n    };\n    Container.prototype.restore = function () {\n        var snapshot = this._snapshots.pop();\n        if (snapshot === undefined) {\n            throw new Error(ERROR_MSGS.NO_MORE_SNAPSHOTS_AVAILABLE);\n        }\n        this._bindingDictionary = snapshot.bindings;\n        this._middleware = snapshot.middleware;\n    };\n    Container.prototype.createChild = function (containerOptions) {\n        var child = new Container(containerOptions || this.options);\n        child.parent = this;\n        return child;\n    };\n    Container.prototype.applyMiddleware = function () {\n        var middlewares = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            middlewares[_i] = arguments[_i];\n        }\n        var initial = (this._middleware) ? this._middleware : this._planAndResolve();\n        this._middleware = middlewares.reduce(function (prev, curr) { return curr(prev); }, initial);\n    };\n    Container.prototype.applyCustomMetadataReader = function (metadataReader) {\n        this._metadataReader = metadataReader;\n    };\n    Container.prototype.get = function (serviceIdentifier) {\n        return this._get(false, false, TargetTypeEnum.Variable, serviceIdentifier);\n    };\n    Container.prototype.getTagged = function (serviceIdentifier, key, value) {\n        return this._get(false, false, TargetTypeEnum.Variable, serviceIdentifier, key, value);\n    };\n    Container.prototype.getNamed = function (serviceIdentifier, named) {\n        return this.getTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\n    };\n    Container.prototype.getAll = function (serviceIdentifier) {\n        return this._get(true, true, TargetTypeEnum.Variable, serviceIdentifier);\n    };\n    Container.prototype.getAllTagged = function (serviceIdentifier, key, value) {\n        return this._get(false, true, TargetTypeEnum.Variable, serviceIdentifier, key, value);\n    };\n    Container.prototype.getAllNamed = function (serviceIdentifier, named) {\n        return this.getAllTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\n    };\n    Container.prototype.resolve = function (constructorFunction) {\n        var tempContainer = this.createChild();\n        tempContainer.bind(constructorFunction).toSelf();\n        return tempContainer.get(constructorFunction);\n    };\n    Container.prototype._getContainerModuleHelpersFactory = function () {\n        var _this = this;\n        var setModuleId = function (bindingToSyntax, moduleId) {\n            bindingToSyntax._binding.moduleId = moduleId;\n        };\n        var getBindFunction = function (moduleId) {\n            return function (serviceIdentifier) {\n                var _bind = _this.bind.bind(_this);\n                var bindingToSyntax = _bind(serviceIdentifier);\n                setModuleId(bindingToSyntax, moduleId);\n                return bindingToSyntax;\n            };\n        };\n        var getUnbindFunction = function (moduleId) {\n            return function (serviceIdentifier) {\n                var _unbind = _this.unbind.bind(_this);\n                _unbind(serviceIdentifier);\n            };\n        };\n        var getIsboundFunction = function (moduleId) {\n            return function (serviceIdentifier) {\n                var _isBound = _this.isBound.bind(_this);\n                return _isBound(serviceIdentifier);\n            };\n        };\n        var getRebindFunction = function (moduleId) {\n            return function (serviceIdentifier) {\n                var _rebind = _this.rebind.bind(_this);\n                var bindingToSyntax = _rebind(serviceIdentifier);\n                setModuleId(bindingToSyntax, moduleId);\n                return bindingToSyntax;\n            };\n        };\n        return function (mId) { return ({\n            bindFunction: getBindFunction(mId),\n            isboundFunction: getIsboundFunction(mId),\n            rebindFunction: getRebindFunction(mId),\n            unbindFunction: getUnbindFunction(mId)\n        }); };\n    };\n    Container.prototype._get = function (avoidConstraints, isMultiInject, targetType, serviceIdentifier, key, value) {\n        var result = null;\n        var defaultArgs = {\n            avoidConstraints: avoidConstraints,\n            contextInterceptor: function (context) { return context; },\n            isMultiInject: isMultiInject,\n            key: key,\n            serviceIdentifier: serviceIdentifier,\n            targetType: targetType,\n            value: value\n        };\n        if (this._middleware) {\n            result = this._middleware(defaultArgs);\n            if (result === undefined || result === null) {\n                throw new Error(ERROR_MSGS.INVALID_MIDDLEWARE_RETURN);\n            }\n        }\n        else {\n            result = this._planAndResolve()(defaultArgs);\n        }\n        return result;\n    };\n    Container.prototype._planAndResolve = function () {\n        var _this = this;\n        return function (args) {\n            var context = plan(_this._metadataReader, _this, args.isMultiInject, args.targetType, args.serviceIdentifier, args.key, args.value, args.avoidConstraints);\n            context = args.contextInterceptor(context);\n            var result = resolve(context);\n            return result;\n        };\n    };\n    return Container;\n}());\nexport { Container };\n","import { makePropertyInjectDecorator, makePropertyMultiInjectDecorator, makePropertyInjectTaggedDecorator, makePropertyInjectNamedDecorator } from \"./decorators\";\nfunction getDecorators(container, doCache) {\n    if (doCache === void 0) { doCache = true; }\n    var lazyInject = makePropertyInjectDecorator(container, doCache);\n    var lazyInjectNamed = makePropertyInjectNamedDecorator(container, doCache);\n    var lazyInjectTagged = makePropertyInjectTaggedDecorator(container, doCache);\n    var lazyMultiInject = makePropertyMultiInjectDecorator(container, doCache);\n    return {\n        lazyInject: lazyInject,\n        lazyInjectNamed: lazyInjectNamed,\n        lazyInjectTagged: lazyInjectTagged,\n        lazyMultiInject: lazyMultiInject\n    };\n}\nexport default getDecorators;\n","import { injectable } from 'inversify'; \n\n@injectable()\nexport default class StorageService {\n    _inMemoryStorage: { [key: string]: any } = {};\n    store(key: string, value: any) {\n        this.getLocalStorage().setItem(key, JSON.stringify(value))\n    }\n\n    getAsJSON(key: string) {\n        const storedData = this.getLocalStorage().getItem(key);\n        return storedData ? JSON.parse(storedData) : null;\n    }\n\n     getLocalStorage() {\n        if (globalThis['localStorage']) {\n            return localStorage;\n        }\n        return this.getInMemoryStorage();\n    }\n\n     getInMemoryStorage() {\n        return {\n            setItem: (key: string, value: any) => {\n                this._inMemoryStorage[key] = value;\n            },\n            getItem: (key: string) => {\n                return this._inMemoryStorage[key];\n            }\n        };\n    }\n}","import * as ERRORS_MSGS from \"../constants/error_msgs\";\nimport * as METADATA_KEY from \"../constants/metadata_keys\";\nfunction injectable() {\n    return function (target) {\n        if (Reflect.hasOwnMetadata(METADATA_KEY.PARAM_TYPES, target)) {\n            throw new Error(ERRORS_MSGS.DUPLICATED_INJECTABLE_DECORATOR);\n        }\n        var types = Reflect.getMetadata(METADATA_KEY.DESIGN_PARAM_TYPES, target) || [];\n        Reflect.defineMetadata(METADATA_KEY.PARAM_TYPES, types, target);\n        return target;\n    };\n}\nexport { injectable };\n","import { Container, interfaces } from 'inversify';\nimport getDecorators from 'inversify-inject-decorators'; \nimport StorageService from '../data/storage.service';\n\nimport { init } from 'dc-extensions-sdk';\nimport type { ContentFieldExtension } from 'dc-extensions-sdk';\n\n// define the input field model\ninterface FieldModel {\n    title: string;\n    type: string;\n    control: string;\n    format: string;\n    minLength: number;\n    maxLength: number;\n  }\n  \n  // define the installation config parameters\n  interface Parameters {\n    instance: {};\n    installation: {\n      configParam: string;\n    };\n  }\n\n// Must have https://www.npmjs.com/package/babel-plugin-transform-typescript-metadata\n// setup the container...\nexport const container = new Container({ autoBindInjectable: true });\n\ncontainer.bind('StorageService').to(StorageService).inSingletonScope();\n\ncontainer.bind('AmplienceSDK').toDynamicValue((context: interfaces.Context) => {\n    return init<ContentFieldExtension<FieldModel, Parameters>>();  \n});\n\ncontainer.bind('AmplienceSDKProvider').toProvider<ContentFieldExtension<FieldModel, Parameters>>((context: interfaces.Context) => {\n    console.log(\"Amplience SDK Provider factory was called\");\n    return () => {\n        return init<ContentFieldExtension<FieldModel, Parameters>>();  \n    }    \n});\n\n\n\n// Additional function to make property decorators compatible with babel.\nlet { lazyInject: originalLazyInject } = getDecorators(container); \nfunction fixPropertyDecorator<T extends Function>(decorator: T): T {\n    return ((...args: any[]) => (\n        target: any,\n        propertyName: any,\n        ...decoratorArgs: any[]\n    ) => {\n        decorator(...args)(target, propertyName, ...decoratorArgs);\n        return Object.getOwnPropertyDescriptor(target, propertyName);\n    }) as any;\n}\n\nexport const lazyInject = fixPropertyDecorator(originalLazyInject);","import { FunctionalComponent, h } from 'preact';\nimport { Route, Router } from 'preact-router';\n\nimport Home from '../routes/home';\nimport Profile from '../routes/profile';\nimport NotFoundPage from '../routes/notfound';\nimport Header from './header';\nimport { lazyInject } from '../di/services.container';\nimport { Component } from 'preact';\nimport StorageService from '../data/storage.service';\n\nexport interface Props {\n  value: string,\n  optionalValue?: string\n}\n\nexport interface State {\n  useOptional: boolean\n}\n\nexport default class App extends Component<Props, State> {\n\n    @lazyInject('StorageService') storageService?: StorageService;\n\n    @lazyInject('AmplienceSDKProvider') amplienceSDKProvider?: Promise<any>;\n    @lazyInject('AmplienceSDK') amplienceSDK?: Promise<any>;\n\n  constructor() {\n    super();\n    this.state = {\n      useOptional: false\n    };\n  }\n\n  componentWillMount() {\n      if (this.storageService) {\n      }\n      if (this.amplienceSDK) {\n        console.log(\"amplience SDK promise has been injected though\", \"@lazyInject('AmplienceSDK') amplienceSDK?: Promise<any>;\");\n        try {          \n          this.amplienceSDK.then((sdk: any) => {\n            console.log(\"amplience SDK has been initialized through injected promise.\");\n            console.log(\"random field value example\", sdk.field.getValue().then((result: any) => console.log(result)));\n          }).catch(error => console.log(error));\n        } catch(exception) {\n          console.log(exception);\n        }\n                \n      }\n  }\n\n  render({ value, optionalValue }: Props, { useOptional }: State) {\n    return (\n      <div id=\"output\"></div>\n    );\n  }\n\n}","import './style/index.css';\nimport 'reflect-metadata';\nimport App from './components/app';\n\nexport default App;\n"],"sourceRoot":""}